---
complexity_score: 10.5
converted_at: '2025-08-13T06:58:37.949945Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 2
images_saved: 3
original_path: 178_22104-LZA7016014_1Uen.AT.html
pictures_extracted: 2
processing_method: docling_multimodal
quality_score: 9.0
source_file: 178_22104-LZA7016014_1Uen.AT.html
source_zip: en_lzn7931040_r50f.zip
tables_extracted: 7
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 1893
---

# 

End-User Bitrate Shaping

Contents

![Image](../images/178_22104-LZA7016014_1Uen.AT/additional_3_CP.png)

![Image](../images/178_22104-LZA7016014_1Uen.AT/additional_3_CP.png)

- Overview
- Dependencies
- Feature Operation
- Network Impact
- Parameters
- Performance
- Activate
- Deactivate

# 1 End-User Bitrate Shaping Overview

The End-User Bitrate Shaping feature conforms the traffic stream of a specific profile

by delaying packets.

| Feature Name           | End-User Bitrate Shaping                                           |
|------------------------|--------------------------------------------------------------------|
| Feature Identity       | FAJ 121 1745                                                       |
| Value Package Name     | Differentiated Mobile Broadband                                    |
| Value Package Identity | FAJ 801 0409                                                       |
| Node Type              | Baseband Radio Node                                                |
| Access Type            | LTE                                                                |
| Licensing              | License-controlled feature. One license is required for each node. |

Summary

The process of delaying packets in a traffic stream to cause it to conform to a defined

traffic profile is called rate shaping. The End-User Bitrate Shaping feature introduces the

rate shaping algorithm in the eNodeB. The aim is to limit the bit rate in uplink. This

limitation does not apply in downlink.

The End-User Bitrate Shaping feature acts as a QoS enabler and allows for a tiered

subscription model. The End-User Bitrate Shaping feature also limits the throughput for

users exceeding the data volume limit in their subscription.

Additional Information

For more information about this feature and related topics, see the following

documentation:

- Admission Control
- Manage Quality of Service
- Scheduler

For information on the preferred state and parameter settings

of this feature, see RAN Parameter Recommendations Lists.

# 2 Dependencies of End-User Bitrate Shaping

The End-User Bitrate

Shaping feature affects Scheduler and does not require any specific hardware

equipment.

Feature Dependencies

| Feature                                                                         | Relationship   | Description                                                                                                                                                  |
|---------------------------------------------------------------------------------|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Dynamic QoS                                         Modification (FAJ 121 1749) | Related        | The End-User Bitrate Shaping feature takes the uplink AMBR             for the non-GBR bearer and the uplink MBR for each GBR bearer as input.               |
| Scheduler (FAJ 121 1447)                                                        | Affected       | The End-User Bitrate Shaping feature is placed in the scheduler                                     and informs it if a given packet transmission can occur. |

Hardware

No specific hardware requirements.

Limitations

No known limitations.

Network Requirements

No specific network requirements.

# 3 Feature Operation of End-User Bitrate Shaping

The End-User Bitrate Shaping feature in the eNodeB supports the functionality of the

Scheduler feature. End-User Bitrate Shaping adds the

possibility to enforce a rate by regulating the amount of traffic to be sent over the

air interface.

The mechanism entails delaying incoming packets using a Token Bucket algorithm that

operates in the uplink.

The End-User Bitrate Shaping feature takes the uplink Aggregated Maximum Bitrate (AMBR)

for the non-GBR bearer and the uplink MBR for each GBR bearer as input. Therefore, in

the uplink it is possible to shape the traffic to the sum of the maximum aggregated

bit-rate for a specific UE and the MBR for each GBR bearer of that UE. The UE-AMBR and

the MBRs associated with each bearer are received over the S1AP interface from the MME

and X2AP interface from the eNodeB. The granularity of the rate controlled by the MME is

8 kbps.

The functions of the End-User Bitrate Shaping feature are included in the Scheduler feature.

Figure 1   Functional Description of the End-User Bitrate Shaping Feature for the

Uplink

The End-User Rate Shaping feature implements a Token Bucket algorithm. The basis for this

algorithm is that tokens, representing the data volume, are injected at a constant token

rate.

The uplink UE-AMBR parameter is signaled to the End-User Bitrate

Shaping feature from the MME through the interface S1AP by the following messages:

- E-RAB SETUP REQUEST
- E-RAB MODIFY REQUEST
- E-RAB RELEASE COMMAND
- INITIAL CONTEXT SETUP REQUEST
- UE CONTEXT MODIFICATION REQUEST
- PATCH SWITCH REQUEST ACKNOWLEDGE
- HANDOVER REQUEST

The uplink UE-AMBR parameter is signaled on the X2AP interface by the

following message:

- HANDOVER REQUEST

The uplink MBR parameter for each GBR bearer is signaled from MME

through S1AP by the following messages:

- E-RAB SETUP REQUEST
- E-RAB MODIFY REQUEST
- INITIAL CONTEXT SETUP REQUEST
- HANDOVER REQUEST

The uplink MBR parameter for each GBR bearer is signaled on the X2AP

by the following message:

- HANDOVER REQUEST

More information related to the signaling messages can be found in 3GPP TS

36.413 and 3GPP TS36.423.

The tokens accumulate in a bucket, and the maximum of allowed tokens is defined by the

bucket size. The bucket size depends on the token rate and the bucket time. The tokens

are consumed by the data packets, and if the number of tokens in the bucket is positive,

the packet is transmitted. Each transmission reduces the number of tokens that amounts

to the size of the transmitted packet. Such mechanism can create a token debt resulting

in a negative number of tokens in the bucket. In this case, the transmission is delayed.

The maximum allowed delay is 25 ms.

In the uplink, the Token Bucket algorithm influences both the GBR and non-GBR

bearers.

Figure 2   Token Bucket Algorithm

The End-User Bitrate Shaping supports the possibility to modify any radio bearer

associated to a given UE, according to the E-RAB MODIFY REQUEST command signaled from

the MME.

# 4 Network Impact of End-User Bitrate Shaping

The End-User Bitrate Shaping feature affects packet delay and the UE

throughput.

Capacity and Performance

The feature impacts the application throughput for UEs trying to send at a higher

rate than the token rate. The average application throughput for the UE is limited

to the token rate.

# 5 Parameters of End-User Bitrate Shaping

The End-User Bitrate Shaping

feature introduces two new parameters.

Table 1   Parameters

| Parameter                       | Type       | Description          |
|---------------------------------|------------|----------------------|
| EUtranCellFDD.rateShapingActive | Introduced | See MOM description. |
| EUtranCellTDD.rateShapingActive | Introduced | See MOM description. |

# 6 Performance of End-User Bitrate Shaping

The End-User Bitrate Shaping feature introduces two pm

counters.

KPIs

The table lists the main Key Performance Indicators (KPIs) associated with the

feature, and the expected impact.

| KPI               | Description                                                                                                                                               |
|-------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|
| Uplink Throughput | Speed at which packets are transferred once the first packet has                                     been scheduled on the air interface.                 |
| Delay             | Time it takes to schedule the first packet on the air interface,                                     determined from the time it was received in the RBS. |

Counters

- EUtranCellTDD::pmRateShapeTimeUl
- EUtranCellFDD::pmRateShapeTimeUl

Events

| Event                       | Event Parameter                       | Description                                                                                                                                                                   |
|-----------------------------|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| INTERNAL_PER_UE_TRAFFIC_REP | EVENT_PARAM_PER_UE_RATE_SHAPE_TIME_UL | Time where the UE has uplink data in a buffer and rate shaping                                     functionality prohibits transmission in the uplink.  Measured on UE level. |

# 7 Activate End-User Bitrate Shaping

To use the feature, it must be activated following the usual feature activation

procedure.

Prerequisites

- The license key is installed in the node.
- CCTR is active for at least one week before this procedure to collect enough troubleshooting data.

Steps

1. Set the FeatureState.featureState attribute to ACTIVATED in the FeatureState=CXC4011057 MO instance.

After This Task

Keep CCTR active for at least one week after this procedure for continued collection of troubleshooting data.

# 8 Deactivate End-User Bitrate Shaping

If the feature is no longer needed, it can be deactivated following the usual

feature deactivation procedure. It must also be deactivated before the activation of any

conflicting feature.

Prerequisites

CCTR is active for at least one week before this procedure to collect enough troubleshooting data.

Steps

1. Set the FeatureState.featureState attribute to DEACTIVATED in the FeatureState=CXC4011057 MO instance.

After This Task

Keep CCTR active for at least one week after this procedure for continued collection of troubleshooting data.