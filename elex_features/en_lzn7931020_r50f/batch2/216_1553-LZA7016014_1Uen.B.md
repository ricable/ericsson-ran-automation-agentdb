---
complexity_score: 30.0
converted_at: '2025-08-13T06:59:11.562996Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 3
images_saved: 3
original_path: 216_1553-LZA7016014_1Uen.B.html
pictures_extracted: 3
processing_method: docling_multimodal
quality_score: 9.0
source_file: 216_1553-LZA7016014_1Uen.B.html
source_zip: en_lzn7931020_r50f.zip
tables_extracted: 45
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 1244
---

# 

Manage User Access

Baseband Radio Node

Contents

![Image](../images/216_1553-LZA7016014_1Uen.B/additional_3_CP.png)

![Image](../images/216_1553-LZA7016014_1Uen.B/additional_3_CP.png)

- Description
    - User Access Overview
    - User Management Overview
    - O&amp;M User
    - Maintenance User
- Procedures
    - Configure O&amp;M Node Access
    - Configure LDAP
    - Configure O&amp;M Access Point
    - Configure Protocol and Interface
    - Configure User Management
    - Configure Session Timers
    - Prepare User Credentials and Trusted Certificate for TLS Client Logon

# 1 Description

This document describes user access concepts that are relevant when accessing the node.

This document provides an overview of the following topics:

- User access
- User management

This document is closely related to the following document:

- Manage Security

## 1.1 User Access Overview

Access to the O&amp;M services is possible by using Transport Network (TN) and Local

Maintenance Terminal (LMT) ports. For more

information

on TN and LMT ports, see Manage Security.

O&amp;M access through the TN and LMT ports supports the following:

- Access through O&amp;M interfaces: NETCONF, CLI, HTTPS, SFTP, and FTPES
- Access with node access applications, for example, EMGUI and EMCLI
- TLS or SSH protection
- Logon with all user types, including maintenance users and O&amp;M users

In order to access the O&amp;M services through a TN port, an

OamAccessPoint

MO instance

must be configured.

Table 1   TLS and SSH Connections with Baseband Radio Node as a Server

| Protocol   | Client Authentication                                                                                               | Required Connectivity and Security Data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|------------|---------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| TLS        | Certificate-based client authentication                                                                             | Maintenance users added in the node or O&M users                                             added in LDAP server (LDAP connectivity is required if                                             O&M users are added)     A trusted certificate and the O&M node credentials in                                             the node     User credentials in the client     A trusted certificate in the client to                                             validate                                             the O&M node                                             certificate     |
| TLS        | Username and password-based client authentication (special case for                                 EMGUI port 443) | Maintenance users added in the node or O&M users                                             added in LDAP server (LDAP connectivity is required if                                             O&M users are added)     The O&M node credentials in the node     Username and password for TLS client user on the client                                             side     A trusted certificate in the client to                                             validate                                             the O&M node                                             certificate |
| SSH        | Username and password-based client authentication                                                                   | Maintenance users added in the node or O&M users                                             added in LDAP server (LDAP connectivity is required if                                             O&M users are added)     Username and password for SSH client user on the client                                             side     If mutual authentication is needed, SSH server public                                             keys can be downloaded from the node                                                                                                                |

TLS with certificates is recommended. When using TLS with certificates, the SSH ports can

be closed by configuration. Ensure that the SSH ports are not used by any users or

applications (for example, in ENM) before closing.

If the operator does not want certain users to use SSH, no password is given for those

users. The node can still validate users for TLS access by user credentials.

SSH server host keys are generated during initial rollout and after every successful

upgrade. The SSH server host keys can be renewed with

the

action

ServerKey.renewKey().

The ServerKey

MO

instance exists for each SSH server host public key. The

ServerKey MO instances correspond to the public keys created with

different ciphers.

For more information on

configuring

cipher suites and elliptic curves for TLS and SSH, see Manage Security.

Emergency Access can be used when O&amp;M access to the node is unavailable. For more

information on Emergency Access, see Manage Security.

Related Information

Configure O&amp;M Access Point

### 1.1.1 Network Configuration Protocol

NETCONF is an XML-based configuration protocol.

Both TLS and SSH are supported for protection. NETCONF over TLS is recommended and is

defined in RFC 5539.

All actions using NETCONF are logged in the audit trail log. For more information on the

audit trail log, see Audit Trail Log.

For more information on NETCONF, see

Ericsson NETCONF

Interface.

For details on how to configure NETCONF, see Configure NETCONF.

### 1.1.2 Ericsson Command Line Interface

Ericsson CLI is a text-based management interface.

Both SSH and TLS are supported for protection. It is recommended to use Ericsson CLI over

TLS.

All actions using Ericsson CLI are logged in the audit trail log. For more information on

the audit trail log, see Audit Trail Log.

For more information on Ericsson CLI, see Ericsson CLI.

For details on how to configure CLI, see Configure CLI.

### 1.1.3 Hypertext Transfer Protocol Secure

The Hypertext Transfer Protocol Secure (HTTPS) service allows secure communication over

TLS with the web applications of the system.

Examples of these web applications are the

following:

- Autointegration Web GUI
- Emergency Access
- EMGUI

Logon to EMGUI is supported through user credentials as well as username and password.

Certificate-based client authentication is recommended.

All actions using HTTPS are logged in the security and audit trail log. For more

information on the security log and audit trail log, see Security Log and Audit Trail Log.

For details on how to configure HTTPS, see Configure HTTPS.

### 1.1.4 File Transfer

File transfer is supported through Secure File Transfer Protocol (SFTP) over SSH as well

as Explicit File Transfer Protocol Secure (FTPES) over TLS.

Logon to SFTP is supported through username and password, and logon to FTPES is supported

through user credentials.

For O&amp;M users or customized maintenance users, at least one of the following roles

need to be assigned to the user to get SFTP access:

- SystemReadOnly
- SystemAdministrator

All actions using SFTP or FTPES are logged in the security log. For more information on

the security log, see Security Log.

For details on how to configure file server, see Configure File Server.

## 1.2 User Management Overview

### 1.2.1 User Types

There are several types of users for O&amp;M access. An O&amp;M user, sometimes

referred to as an LDAP user, is a general user with access rights configured in the LDAP server.

A maintenance user is a user that is locally configured in the node. Maintenance users can be of

either type full access or customized.

Table 2   O&amp;M User and Maintenance User

| User Type                    | Configuration and Authentication                                                                                                                                                                                         | Access Rights (Authorization)                                                                                                                                                                          | Usage Scenario                                                                                                                                                                                                                                                                                                               | Additional Information                                                                                                                                                                                                                                                                                                                                                                              |
|------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| O&M User                     | Configured centrally in the LDAP server.  For certificate-based logon, authentication is done in the node.   For username and password-based logon, authentication is done centrally in the LDAP                 server. | Access rights are defined by the roles (per target if TBAC is used) assigned to the                 user in the LDAP database. Rules for the different roles are enforced in the                 node. | It is recommended to use this user type in most of O&M use cases for a node in                 operation.                                                                                                                                                                                                                    | There is a special O&M user associated with the                 Users_Application_Security_Administrator role. This user is used for managing                 maintenance users in the node. The usage of this user should be carefully                 restricted. It should only be used by security administrators that are authorized to                 manage maintenance user configuration. |
| Customized Maintenance User  | Configured and authenticated locally, using the MaintenanceUser MO.                                                                                                                                                      | Access rights are defined by the roles assigned to the user in the local user                 database. Rules for the different roles are enforced in the node.                                        | This user type can be used for any maintenance operation requiring local account                 configuration and just a limited access to the node. For example, this user type can                 be used in the case of network-wide LDAP protocol failure due to                 misconfiguration.                     |                                                                                                                                                                                                                                                                                                                                                                                                     |
| Full Access Maintenance User | Configured and authenticated locally, using the MaintenanceUser MO.                                                                                                                                                      | A full access maintenance user receives full access rights to the entire MOM in the                 node.                                                                                              | This special user should only be used as a last resort when both the O&M user                 and the customized maintenance user are not accessible. The certificate-based                 credentials or the username and password of this user should be kept secretly, only                 unveiled as the last resort. | Adding a full access maintenance user at node integration is recommended, and it is                 required if no O&M user                 is                 configured.                                                                                                                                                                                                                          |

Maintenance user authentication can be limited with the

MaintenanceUserSecurity.restrictMaintenanceUser attribute in the

following ways:

- If the MaintenanceUserSecurity.restrictMaintenanceUser attribute is set to false, the node first attempts maintenance user authentication. If maintenance user authentication fails, O&amp;M user authentication is attempted.
- If the MaintenanceUserSecurity.restrictMaintenanceUser attribute is set to true, the node first attempts O&amp;M user authentication. Only if the connection to the LDAP server fails, maintenance user authentication is attempted.

### 1.2.2 User Roles

The role is a set of authorization rules that define permissions to access system resources

and perform certain operations.

The rules permissions are shown as follows:

| Rules Permissions        | Description                                                                                                |
|--------------------------|------------------------------------------------------------------------------------------------------------|
| Read                     | The user can read MOs and can get attribute values.                                                        |
| Read and write           | The user can create and delete MOs and set and get attribute values.                                       |
| Read and execute         | The user can read MOs, get attribute values, and execute any actions.                                      |
| Read, write, and execute | The user can create and delete MOs, set and get attribute values, and execute any                 actions. |
| No Access                | The user has no read, write or execute rights to the MO, attribute, or action.                             |

#### 1.2.2.1 Predefined Roles

The following predefined roles are available:

- Default system roles SystemReadOnly SystemAdministrator SystemSecurityAdministrator Users\_Application\_Security\_Administrator Diagnostic\_Application\_Troubleshooter Advanced\_Application\_Troubleshooter
- Default eNodeB application roles ENodeB\_Application\_Administrator ENodeB\_Application\_SecurityAdministrator ENodeB\_Application\_User
- Default gNodeB application roles GNodeB\_Application\_Administrator GNodeB\_Application\_SecurityAdministrator GNodeB\_Application\_User
- Default NodeB application roles NodeB\_Application\_Administrator NodeB\_Application\_User
- Default support application roles: Support\_Application\_Administrator Support\_Application\_User
- Default transport application roles: Transport\_Application\_Administrator Transport\_Application\_SecurityAdministrator

For more information on permission levels for each role, see Lists and Delta Lists.

#### 1.2.2.2 Custom Roles

Custom roles are configured with custom rules, which define the access rights to system

resources.

Related Information

Configure User Management

#### 1.2.2.3 Roles Only for Ericsson Troubleshooting

In order to enable Ericsson assistance during a serious incident, one of the following

Ericsson Support Command Interface (ESCI) roles must be set for an O&amp;M user or a

customized maintenance user according to its privilege to access the ESCI:

- BasebandSupportBasic
- BasebandSupportAdvanced
- BasebandSupportExpert

### 1.2.3 Rules

Rules define permissions to access to system resources and perform certain operations. Each

user acquires the authorization rules through the role

or

roles the user

has.

Custom rules are defined under

the

UserManagement MO. For more

information

on how to create custom rules, see Create Custom

Rule.

### 1.2.4 Targets

Target is the logical identifier of a node or a group of nodes in the network.

A

target

distinguishes the particular node from others in the network and

enables

the grouping of nodes based on their logical function

or other

criteria,

such as geographical location.

For more information,

see the

ENM Identity and Access Management System Administrator Guide in the

Ericsson

Network Manager

CPI

library.

The

UserManagement.targetType attribute

is

used

to configure target types used in LDAP-based user management

configuration.

Related Information

Configure LDAP

## 1.3 O&amp;M User

Centralized

user management requires a central LDAP server where O&amp;M users are configured and

assigned with specific roles. The roles can be assigned with targets. If the ENM LDAP

server is used, the

description of LDAP server configuration can be found in the document

User Management

in

the

ENM Online

Help CPI

library.

The O&amp;M user configuration in the LDAP server is done according to the following approaches:

| Role-Based Access Control (RBAC)   |    | RBAC uses roles and authorization rules concepts. Each role has a set of                             authorization rules that define permissions to access system resources                             and perform operations. Each O&M user acquires the authorization                             rules through the role or roles the O&M user has.   |
|------------------------------------|----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                    |    |                                                                                                                                                                                                                                                                                                                                                          |
| Target-Based Access Control (TBAC) |    | TBAC is based on the target concept. This controls which nodes an O&M                             user has access to and which roles the O&M user has for each target                             when accessing a node. Each node stores a list of targets                                                                                              |

The node uses LDAP server for authentication of username and password and for collection

of roles,

and targets

if TBAC is

used,

to the node. The authorization enforcement of roles, RBAC, and targets, TBAC, is done in

the node.

### 1.3.1 Authentication

The

authentication

process validates an O&amp;M user using one of the

following

ways:

- Certificate-based credentials - locally verified in the node by trusted certificates.
- Username and password - verified by the LDAP server.

For more information on trusted certificates, see Manage Trusted Certificates.

Related Information

Prepare User Credentials and Trusted Certificate for TLS Client Logon

### 1.3.2 Authorization

The

authorization

is performed based on the defined roles and rights of a user.

When a role is assigned to a user

or a role alias,

it can be assigned with a target.

This

means that the role

is applicable

to

the user

only

when accessing a node that matches the target criteria.

A

role alias is a set of roles. When an O&amp;M user is assigned with a role

alias,

the

user is implicitly assigned

with

all roles

contained

within that alias.

The response to an LDAP request from the node contains the roles associated with the user,

and targets if

TBAC is used. For

username and password-based logon, the response also contains the authentication result.

Depending on the authorized roles, the user has access to functions and data in the node.

## 1.4 Maintenance User

There are two types of maintenance users:

- A full access maintenance user, which gets full access to the supported O&amp;M services.
- A customized maintenance user, where the roles for accessing the supported O&amp;M services are configurable.

For more

information

on the roles, see User Roles.

There are two alternative client logon methods:

- Certificate-based credentials - verified locally in the node by trusted certificates.
- Username and password - verified locally in the node.

For more information on trusted certificates, see Manage Trusted Certificates. For more information on how to

prepare certificate-based credentials, see Prepare User

Credentials and Trusted Certificates for TLS Client Logon.

LDAP connectivity is not required for the maintenance user logon. A maintenance user can be

logged in for the

following cases:

- If MaintenanceUserSecurity.restrictMaintenanceUser attribute is set to false.
- When LDAP connectivity is not available if MaintenanceUserSecurity.restrictMaintenanceUser attribute is set to true.

For

more

information

on the MaintenanceUserSecurity.restrictMaintenanceUser

attribute, see User Management

Overview.

A maintenance user can be configured for a TLS client logon, or an SSH client logon, or

both. A trusted certificate and user credentials are needed in the client for a TLS

client logon. Username and password are needed for an SSH client logon. TLS client logon

is recommended in order to have a more secure logon.

Maintenance user authentication is done locally in the

node as

follows:

- For the authentication based on username and password, it is done with a password hash, that is a salted SHA256 multiple rounds hash.
- For certificate-based logon, the authentication is done with a trusted certificate installed in the node.

If the logon is successful, the maintenance user receives the following information

associated with the last successful logon:

- Date and time
- Peer IP address
- Number of failed logon attempts with username and password since last successful logon

### 1.4.1 Initial Configuration of Maintenance Users

At least one full access maintenance user must be added at node integration in the Site

Basic file if no O&amp;M user

is

configured. However, the first maintenance user can be added after node integration if

an O&amp;M user with the Users\_Application\_Security\_Administrator role exits.

The maintenance user password requirements are not enforced during node

integration. This can result in nodes being deployed with weak passwords if maintenance

users for SSH client logon are

configured.

For security reasons, it is recommended to change the password of the

maintenance user after the integration of the node is ready.

### 1.4.2 Configuration of Maintenance Users for Nodes in Operation

After node integration,

maintenance

users can either be managed by a full access maintenance user or by an O&amp;M user with

the Users\_Application\_Security\_Administrator role. This is controlled by the

MaintenanceUserSecurity.remoteManagement attribute :

- If the attribute is set to true, only an O&amp;M user with the Users\_Application\_Security\_Administrator role can change, add, or remove maintenance users, including removing the last maintenance user. Note: The action of removing the last maintenance user should only be done right before adding a new maintenance user.
- If the attribute is set to false, only a full access maintenance user can change, add, or remove maintenance users, but the last full access maintenance user cannot be removed.

The maintenance users can be configured with different privilege levels. This is

controlled by the MaintenanceUser.userType and the

MaintenanceUser.roles attributes:

- If the MaintenanceUser.userType attribute is set to MAINTENANCE\_USER, the maintenance user is a full access maintenance user and has full access to the complete O&amp;M services. In this case, the MaintenanceUser.roles attribute is not used and must remain empty.
- If the MaintenanceUser.userType attribute is set to CUSTOMIZED\_USER, the maintenance user is a customized maintenance user and has access to roles contained in the MaintenanceUser.roles attribute. The MaintenanceUser.roles attribute can be updated, and it takes effect in the next logon.

Related Information

Add Maintenance User for TLS Client Logon

Add Maintenance User for SSH Client Logon

#### 1.4.2.1 Remote Management of Maintenance Users

The following types of O&amp;M users with the Users\_Application\_Security\_Administrator

role are available:

- One O&amp;M user system-defined in the ENM LDAP server, which is exclusively used by ENM application Network Privileged Access Management (NPAM).
- O&amp;M users manually configured in a connected LDAP server, which are used by human users.

ENM NPAM allows the creation and the handling of the maintenance users of the node from

ENM. ENM NPAM communicates with the node through NETCONF over TLS.

ENM NPAM supports the following activities:

- Manage one full access maintenance user with username and password-based authentication for each node.
- It is optional to create a second full access maintenance user with certificate-based authentication specific for the Citizens Broadband Radio Service (CBRS) functionality in ENM.
- The following multiple methods of password rotation for maintenance users: Manual Automated File-based bulk import For each method, the network scope can be set to an entire network, a subnetwork, a group of nodes, or a single node.

If ENM NPAM takes over the maintenance user management of the node, a new maintenance

user with auto-generated credentials in the node is created by default, and any

pre-existing maintenance users are removed.

It is recommended to use ENM NPAM to manage maintenance users when there is only one full

access maintenance user with username and password-based authentication in the node, and

periodic password update is required.

When ENM NPAM is enabled, it is recommended not to use any other node access application

or script acting with the Users\_Application\_Security\_Administrator role to manage

maintenance users to avoid potential conflicts.

For more information on ENM NPAM, see ENM Network Security Configuration System

Administrator Guide in the Ericsson Network Manager CPI

library.

### 1.4.3 Maintenance User Password Requirements

The password must contain at least 12 characters including as follows:

- At least three lowercase characters (a-z)
- At least three uppercase characters (A-Z)
- At least two numeric cases (0-9)
- At least one special character

All printable ASCII characters are accepted, except for the following characters:

- space (ASCII decimal value 32)
- \ (ASCII decimal value 92)
- / (ASCII decimal value 47)
- " (ASCII decimal value 34)

The password must

be enclosed in quotation marks if any of the , ; | ! ? = [ ]

characters are used. For example, the following passwords are allowed

only with quotation marks:

- "12abcDEF345'*-\_.:,;|!"
- "12abcDEF811$@%&amp;()=?+*'`^~\_-.:,;&lt;&gt;|{[]}!"

The maintenance user password has no limitation regarding the maximum number of

characters.

The password must not contain the username or the reverse of the related username.

The

MaintenanceUser.lastPasswordChange

attribute shows

the time of last

password

change.

### 1.4.4 Brute-force Protection Mechanism

When logging in as a maintenance user using username and password, the user must be aware

of the brute-force protection mechanism which consists of five configurable

parameters.

If the MaintenanceUserSecurity.loginDelayPolicy attribute is set to

RANDOM and the maintenance user fails to log in, the

next

logon attempt is delayed by a random time (2-5

seconds).

If the MaintenanceUserSecurity.loginDelayPolicy attribute is set to

FIXED or INCREASING and the maintenance user fails

to log in, the next logon attempt is delayed by a configurable

fixed

amount of

time, or the logon

delay is doubled with each successive logon failure respectively.

Only the session

where

the rejected logon

is issued is affected by the

delay.

If a configured number of consecutive failed logon attempts occur in

a

configured amount of time, the maintenance user is locked out. The

lockout lasts for the configured amount of time, after which

the

lockout is automatically removed. At this point, a new logon attempt

can be performed. It is also possible to remove the existing lockout by an action.

Related Information

Change Maintenance User Logon Security Parameters

Unlock a Locked Maintenance User

# 2 Procedures

This chapter describes how to configure the Operation and Maintenance (O&amp;M) node

access.

## 2.1 Configure O&amp;M Node Access

Several of the following configurations can be performed during integration

by

using the Site Basic file. See Manage Configuration Files for more information.

Before configuring the O&amp;M node access, understand and apply the following safety

measures:

- Activate the BrmFailsafeBackup function before configuring for O&amp;M node access. This prevents a potential O&amp;M connectivity loss. For more information on activating the BrmFailsafeBackup function, see Manage Software.

Steps

1. Configure O&amp;M Node Credentials. See Enroll Node Credentials.
2. Configure Trusted Certificates. See Manage Trusted Certificates.
3. Add the Trusted Certificates to Trust Category. See Create a Trust Category.
4. Configure LDAP. See Configure LDAP.
5. Configure the O&amp;M Access Point. See Configure O&amp;M Access Point.
6. Configure Transport Layer Security (TLS) for NETCONF over TLS. See Configure NETCONF over TLS.
7. Configure Transport Layer Security (TLS) for CLI over TLS. See Configure CLI over TLS.
8. Configure User Management. See Configure User Management.

Results

O&amp;M node access is

configured and

the node is ready for O&amp;M

access.

## 2.2 Configure LDAP

Central user management is based on LDAP and requires an LDAP server. Configuration must be

done in the node as well as in the LDAP server. If the ENM LDAP server is used, the

description of

the

LDAP server configuration can be found in the document User

Management

in the

ENM Online

Help CPI

library.

The LDAP-based user management configuration serves three purposes:

- User authentication for username and password-based logon
- Role-Based Access Control (RBAC)
- Target-Based Access Control (TBAC)

For information on ports and protocols, see Node Hardening Guidelines.

Activate the BrmFailsafeBackup function before configuring LDAP. This

prevents a potential O&amp;M connectivity loss.

For more information on activating the BrmFailsafeBackup function, see

Manage Software.

### 2.2.1 Configure LDAP Connection

Prerequisites

- A user with role SystemSecurityAdministrator or a full access maintenance user is available to perform LdapAuthenticationMethod MO configuration.
- NodeCredential MO instance for O&amp;M is configured.
- TrustCategory MO instance is configured, which contains trusted certificates used to authenticate LDAP server.

Steps

1. Set the LdapAuthenticationMethod.administrativeState attribute to UNLOCKED. Note: The LdapAuthenticationMethod.administrativeState attribute has no impact on LDAP authentication, but it is recommended to set it to UNLOCKED to reflect the underlying state.
2. Configure the following attributes with values obtained from ENM. For more details on how to obtain those values, see the ENM Online Help CPI library: Ldap.baseDn Ldap.bindDn Ldap.bindPassword Ldap.fallbackLdapIpAddress Note: It is recommended to use redundant LDAP servers. However, this attribute can be omitted if no fallback LDAP server exists. Ldap.ldapIpAddress Note: Ensure that the IP address versions of the Ldap.fallbackLdapIpAddress and Ldap.ldapIpAddress attributes match the IP address version configured for the OamAccessPoint MO.
3. Configure the TLS support using the following attributes: Set the Ldap.useTls attribute to TRUE. Note: If the Ldap.useTls attribute is set to FALSE, the passwords are not encrypted and possible to be intercepted when sent to the LDAP server. It is recommended to set the Ldap.useTls attribute to TRUE. Set the Ldap.tlsMode attribute to LDAPS. Note: The STARTTLS setting can also be used, but STARTTLS uses the same port as unprotected LDAP. For more information on the ports, see Node Hardening Guidelines. Set the Ldap.nodeCredential attribute to refer to the configured NodeCredential MO for O&amp;M. Set the Ldap.trustCategory attribute to refer to the configure TrustCategory MO.
4. Set the Ldap.profileFilter attribute to ERICSSON\_FILTER.

Results

LDAP

connection

is configured.

### 2.2.2 Configure LDAP for TBAC

Steps

1. Set attribute EricssonFilter.targetBasedAccessControl to UNLOCKED.
2. Set one or more target types for TBAC by configuring the UserManagement.targetType attribute corresponding to the LDAP server configuration. The attribute UserManagement.targetType can contain several values.

## 2.3 Configure O&amp;M Access Point

This section describes the actions for configuring an O&amp;M access point.

In order to access the O&amp;M services through a TN port, an O&amp;M access point must

be configured.

### 2.3.1 Configure OamAccessPoint

Prerequisites

- BrmFailsafeBackup is activated.
- An AddressIPv4 or AddressIPv6 instance is configured. For more information, see Manage Transport Network or, if IPsec is used, see Manage IPsec.

Steps

1. Set the OamAccessPoint.accessPoint attribute of OamAccessPoint=1 to refer to an AddressIPv4 or AddressIPv6 instance.
2. If LDAP is used, check that the type of the IP address in Ldap.ldapIpAddress and Ldap.fallbackLdapIpAddress matches the MO instance referenced by OamAccessPoint.accessPoint.

Results

OamAccessPoint

is configured and the user can get access to the O&amp;M services in the node

through a TN port.

![Image](../images/216_1553-LZA7016014_1Uen.B/additional_3_CP.png)

### 2.3.2 Configure Alternative OamAccessPoint

O&amp;M access can be protected using an IPsec VPN connection. Configuring an alternative

OamAccessPoint provides access to O&amp;M services outside of IPsec.

This allows node access even if the IPsec protected O&amp;M connection fails. For more

information about IPsec VPN connection, see Manage

IPsec.

Configuring an alternative OamAccessPoint can prevent the need for a

site visit due to the failure of the IPsec protected O&amp;M connection. The alternative

OamAccessPoint uses TLS or SSH and is only recommended if a non-IPsec

solution is considered secure.

The alternative OamAccessPoint provides limited O&amp;M support.

Examples of these limitations are as follows:

- The alternative OamAccessPoint only permits maintenance user logon in case of IPsec protected O&amp;M connection failure. This is because LDAP requests can only be sent through the normal OamAccessPoint.
- It is not possible to use the same IP address for the normal and the alternative OamAccessPoint, even if the respective interfaces are in different virtual routers.
- The alternative OamAccessPoint can only initiate file transfer sessions in case the relevant MO action command allows specifying the source address to be used, for example CertM.installTrustedCertFromUri.

Prerequisites

- BrmFailsafeBackup is activated.
- An additional AddressIPv4 or AddressIPv6 instance is configured. For more information, see Manage Transport Network.

Steps

1. Set the OamAccessPoint.accessPoint attribute of OamAccessPoint=Alternative to refer to an AddressIPv4 or AddressIPv6 instance.

Results

An alternative OamAccessPoint is configured. The user can connect to the

node from the transport network through the given IP address even if the dedicated IPsec VPN

connection for O&amp;M services is out of order. An alternative way is offered to access the

O&amp;M services outside of IPsec.

An alarm is raised once a management session is established through the alternative

OamAccessPoint. For more information about the alarm, see Alternate Oam Connection In Use.

## 2.4 Configure Protocol and Interface

### 2.4.1 Configure NETCONF

#### 2.4.1.1 Configure NETCONF over TLS

Prerequisites

- NodeCredential MO instance for O&amp;M is configured.
- TrustCategory MO instance is configured, which contains trusted certificates used to authenticate NETCONF clients.

Steps

1. Set the attribute NetconfTls.nodeCredential to refer to the configured NodeCredential MO instance for O&amp;M.
2. Set the attribute NetconfTls.trustCategory to refer to the configured TrustCategory MO instance.
3. If the default O&amp;M port configuration is not suitable, set the attribute NetconfTls.port to a suitable port number.

Results

NETCONF over TLS is configured and is ready for use.

For more information on configuration of node credentials and trusted certificates, see

Enroll Node Credentials and

Manage Trusted Certificates.

#### 2.4.1.2 Configure O&amp;M Port for NETCONF over SSH

Steps

1. If the default O&amp;M port configuration is not suitable, set the attribute NetconfSsh.port to a suitable port number.

### 2.4.2 Configure CLI

#### 2.4.2.1 Configure CLI over TLS

Prerequisites

- NodeCredential MO instance for O&amp;M is configured.
- TrustCategory MO instance is configured, which contains trusted certificates used to authenticate CLI clients.

Steps

1. Set the attribute CliTls.nodeCredential to refer to the configured NodeCredential MO instance for O&amp;M.
2. Set the attribute CliTls.trustCategory to refer to the configured TrustCategory MO instance.
3. If the default O&amp;M port configuration is not suitable, set the attribute CliTls.port to a suitable port number.

Results

CLI over TLS is configured and is ready for use.

For more information on configuration of node credentials and trusted certificates, see

Enroll Node Credentials and

Manage Trusted Certificates.

#### 2.4.2.2 Configure O&amp;M Port for CLI over SSH

Steps

1. If the default O&amp;M port configuration is not suitable, set the attribute CliSsh.port to a suitable port number.

### 2.4.3 Configure HTTPS

Prerequisites

- NodeCredential MO instance for O&amp;M is configured.
- TrustCategory MO instances is configured, which contains trusted certificates used to authenticate user credentials in the clients.

Steps

1. Set the attribute Https.nodeCredential to refer to the configured NodeCredential MO instance for O&amp;M.
2. Set the attribute Https.trustCategory to refer to the configured TrustCategory MO instance.

Results

The HTTPS server for EMGUI is configured and is ready for use.

For more information on configuration of node credentials and trusted certificates,

see

Enroll Node Credentials and

Manage Trusted Certificates.

### 2.4.4 Configure File Server

#### 2.4.4.1 Configure FTPES Server

Prerequisites

- NodeCredential MO instance for O&amp;M is configured.
- TrustCategory MO instance is configured, which contains trusted certificates used to authenticate FTPES clients.

Steps

1. Set the attribute FtpTlsServer.nodeCredential to refer to the configured NodeCredential MO instance for O&amp;M.
2. Set the attribute FtpTlsServer.trustCategory to refer to the configured TrustCategory MO instance.
3. If the default O&amp;M port configuration is not suitable, set the attribute FtpTlsServer.port to a suitable port number.
4. Set the FtpTlsServer.administrativeState attribute to UNLOCKED if the FTPES server in the node is to be used. Otherwise, set the attribute to LOCKED.

Results

The FTPES server is available, or not available.

#### 2.4.4.2 Configure SFTP Server

Steps

1. Set the SftpServer.administrativeState attribute to UNLOCKED if the SFTP server in the node is to be used. Otherwise, set the attribute to LOCKED.

Results

The SFTP server is available, or not available.

## 2.5 Configure User Management

This section describes

the configuration related to maintenance user, custom role and custom

rule.

### 2.5.1 Configure Remote or Local Management for Maintenance Users

Remote or local management of maintenance users is controlled through the

MaintenanceUserSecurity.remoteManagement attribute.

A full access maintenance user or an O&amp;M user with the

Users\_Application\_Security\_Administrator role can set the value of the

MaintenanceUserSecurity.remoteManagement attribute.

#### 2.5.1.1 Configure Remote Handling of Maintenance Users

Steps

1. Set the MaintenanceUserSecurity.remoteManagement attribute to true. Note: All users are automatically logged off by the node to activate this change.

Results

Only O&amp;M users with

the

Users\_Application\_Security\_Administrator

role

can modify the maintenance user configuration.

#### 2.5.1.2 Configure Local Handling of Maintenance Users

Steps

1. Set the MaintenanceUserSecurity.remoteManagement attribute to false. Note: All users are automatically logged off by the node to activate this change.

Results

Only full access maintenance users can modify the maintenance user configuration.

### 2.5.2 Add Maintenance User for TLS Client Logon

To create a maintenance user for TLS client logon:

Steps

1. When the MaintenanceUserSecurity.remoteManagement attribute is set FALSE, close all sessions except for maintenance user sessions with action closeSessions() of MO MaintenanceUserSecurity. Note: When the MaintenanceUserSecurity.remoteManagement attribute is set to TRUE, O&amp;M users with Users\_Application\_Security\_Administrator role can perform this action without closeSessions().
2. Create a MaintenanceUser MO. Note: This can be done by an operator logged in as a full access maintenance user or an O&amp;M user with Users\_Application\_Security\_Administrator role if the MaintenanceUserSecurity.remoteManagement attribute is set to TRUE.
3. Set attribute MaintenanceUser.subjectName, which must have the same value as the Subject field of the user certificate in the client to be used. Example If the Subject field of the user certificate in the client is "CN=example-user, C=SE, O=Ericsson", set the MaintenanceUser.subjectName attribute to "CN=example-user, C=SE, O=Ericsson".
4. If creating a customized maintenance user
    1. Set the MaintenanceUser.userType attribute to CUSTOMIZED\_USER.
    2. Configure the MaintenanceUser.roles attribute. At least one role must be set. The role names are described in Predefined Roles. All predefined roles except Users\_Application\_Security\_Administrator can be set.

Results

A maintenance user is created and can be used for connecting the node over TLS.

To connect to the node over TLS, a trusted certificate and user credentials must be

stored in the client. For more details, see Prepare User Credentials and Trusted Certificate for TLS Client Logon.

Related Information

Maintenance User

### 2.5.3 Add Maintenance User for SSH Client Logon

To create a maintenance user for SSH client logon:

Steps

1. When the MaintenanceUserSecurity.remoteManagement attribute is set to FALSE, close all sessions except for maintenance user sessions with action closeSessions() of MO MaintenanceUserSecurity. Note: When the MaintenanceUserSecurity.remoteManagement attribute is set to TRUE, O&amp;M users with Users\_Application\_Security\_Administrator role can perform this action without closeSessions().
2. Create a MaintenanceUser MO. Note: This can be done by an operator logged in as a full access maintenance user or an O&amp;M user with Users\_Application\_Security\_Administrator role if the MaintenanceUserSecurity.remoteManagement attribute is set to TRUE.
3. Set attribute userName and attribute password of MO MaintenanceUser.
4. If creating a customized maintenance user
    1. Set the MaintenanceUser.userType attribute to CUSTOMIZED\_USER.
    2. Configure the MaintenanceUser.roles attribute. At least one role must be set. The role names are described in Predefined Roles. All predefined roles except Users\_Application\_Security\_Administrator can be set.

Results

Maintenance user is created and can be used for connecting the node over SSH.

Related Information

Maintenance User

### 2.5.4 Change Maintenance User Attribute Values

To create a maintenance user account, see Add Maintenance User for TLS Client Logon or Add Maintenance User for SSH Client Logon.

The following attributes can be changed for an existing maintenance user account:

- MaintenanceUser.password
- MaintenanceUser.subjectName
- MaintenanceUser.userName
- MaintenanceUser.roles

The MaintenanceUser.roles attribute can only be changed for a

maintenance user of type CUSTOMIZED\_USER, and takes effect at the next logon of the

customized maintenance user.

The MaintenanceUserSecurity.remoteManagement attribute determines

the user role required to manage the MaintenanceUser MO. When the

attribute is set to false, only a full access maintenance user

account can manage the MO. When the attribute is set to true, only

an O&amp;M user with the role Users\_Application\_Security\_Administrator can manage

the MO.

### 2.5.5 Change Maintenance User Logon Security Parameters

Only full

access maintenance users and O&amp;M users with the

Users\_Application\_Security\_Administrator role can change security logon

parameters.

The configurable security parameters of MaintenanceUserSecurity MO

are the following:

- failedLoginAttemptPeriod
- loginDelay
- noOfFailedLoginAttempts
- userLockoutPeriod
- loginDelayPolicy

The MaintenanceUserSecurity.loginDelayPolicy attribute with the

RANDOM default value is used to increase security by ensuring a

synchronized random delay for all user types.

In case of changing logon security parameters, the following rule must be

satisfied:

- The following formula is applied when changing parameters failedLoginAttemptPeriod or loginDelay or noOfFailedLoginAttempts of MO MaintenanceUserSecurity.

Example 1   Lockout for 15 Minutes after Three Logon Attempts

Following parameter settings of MO MaintenanceUserSecurity lock

the maintenance user for 15 minutes on receiving three consecutive logon failures

within 5 minutes. Each logon failure also enforces the user to wait for 10 seconds

before the user is allowed to logon again.

- failedLoginAttemptPeriod = 5
- loginDelay = 10
- noOfFailedLoginAttempts = 3
- userLockoutPeriod = 15
- loginDelayPolicy = FIXED

Example 2   Lockout for 15 Minutes after Eight Logon Attempts with Increased Delay

Following parameter settings of MO MaintenanceUserSecurity lock

the maintenance user for 15 minutes on receiving seven consecutive logon failures

within 8 minutes. Since loginDelayPolicy is

INCREASING, the node automatically enforces incremental delay

after each logon failure. Consecutive logon failures result in delays of the form 1,

2, 4, 8, 16, 32, 32, 32.

- failedLoginAttemptPeriod = 8
- noOfFailedLoginAttempts = 7
- userLockoutPeriod = 15
- loginDelayPolicy = INCREASING

Example 3   No Lockout, but Logon Attempts with Increased Delay

It is possible to avoid locking of maintenance user. Following parameter settings of

MO MaintenanceUserSecurity will never lock the maintenance user but the node

automatically enforces incremental delay after each logon failure. Consecutive logon

failures result in delays of the form 1, 2, 4, 8, 16, 32, 32, 32...

MaintenanceUserSecurity:noOfFailedLoginAttempts (deleted or empty)

Other maintenance user logon parameters of MO

MaintenanceUserSecurity have no meaning in this case.

### 2.5.6 Unlock a Locked Maintenance User

Only full access maintenance users and O&amp;M users with the

Users\_Application\_Security\_Administrator role can unlock other maintenance

users.

Maintenance users are locked out if a configured number of consecutive failed logon

attempts occur in the configured amount of time. For more details, see Brute-force Protection Mechanism.

To unlock a locked maintenance user, do the following:

Steps

1. Initiate action unlockUser(&lt;maintenanceUserId&gt;) under MO MaintenanceUserSecurity.

### 2.5.7 Create Custom Rule

To create a custom rule:

Prerequisites

- BrmFailsafeBackup function is activated.

Steps

1. Create an instance of MO CustomRule under LocalAuthorizationMethod.
2. Specify the target MO that the rule applies to and set attribute ruleData according to the syntax description in the MOM.
3. Set the access right that a role mapped to this custom rule has on a target object specified in Step 2, and set attribute permission of the respective MO instance CustomRule according to the syntax description in the MOM.
4. Optional: Set the rule name in attribute ruleName of the respective MO instance CustomRule.
5. Optional: Describe the custom rule policy in a user-friendly manner in attribute userLabel of the respective MO instance CustomRule.

Results

A new custom rule is created and can be assigned to custom roles.

### 2.5.8 Create Custom Role

To create a custom role:

Prerequisites

- BrmFailsafeBackup function is activated.

Steps

1. Create an instance of MO CustomRole under LocalAuthorizationMethod.
2. Set the custom role name in attribute roleName of the respective MO instance CustomRole.
3. Assign at least one custom rule to the newly created custom role by adding at least one MO instance CustomRule in attribute rules of the respective MO instance CustomRole.
4. Optional: Describe the custom rule policy in a user-friendly manner in attribute userLabel of the respective MO instance CustomRole.

Results

The custom role is created and can be assigned to user accounts.

Related Information

Create Custom Rule

### 2.5.9 Add or Remove Custom Rules for a Custom Role

To modify the policy of an existing custom role:

Prerequisites

- BrmFailsafeBackup function is activated.

Steps

1. Add or remove custom rules from attribute rules of the respective MO instance CustomRole.
2. Update the role descriptive text in attribute userLabel of the respective MO instance CustomRole to reflect the new policy.

Results

The role represented by the respective MO instance CustomRole is

updated. The respective MO instance CustomRole is added or removed in

attribute reservedByRoles of the referred MO

CustomRule. The authorization policy of the users that possess the

changed role are updated.

### 2.5.10 Change a Custom Rule

Prerequisites

- BrmFailsafeBackup function is activated.

Steps

1. To change the target MO that the rule applies to, change attribute ruleData of the respective MO instance CustomRule accordingly.
2. To change the access right that a role mapped to this custom rule has on the target object or objects specified in attribute ruleData, change attribute permission of the respective MO instance CustomRule accordingly.

Results

The custom roles associated to this custom rule are updated. The authorization policy of

the users that possess the roles associated with this custom rule is updated.

### 2.5.11 Remove a Custom Rule

To remove a custom rule from the node, it must be removed from all the custom roles

that are referencing it.

Prerequisites

- BrmFailsafeBackup function is activated.

Steps

1. Do one of the following:
    - Remove the rule from all the custom roles that are referencing it.
    - Remove the custom roles referencing the custom rule from the node.
2. To remove an existing custom rule, delete the respective CustomRule MO instance.

Results

The custom rule is removed from the node.

Related Information

Add or Remove Custom Rules for a Custom Role

Remove a Custom Role

### 2.5.12 Remove a Custom Role

Prerequisites

- BrmFailsafeBackup function is activated.

Steps

1. To remove an existing custom role from the node, delete the respective CustomRole MO instance.

Results

Attribute reservedByRoles of the CustomRule MO

instances referred by the removed CustomRole is updated. The

authorization policy of the users that possess the deleted role is updated accordingly.

## 2.6 Configure Session Timers

### 2.6.1 Configure Session Inactive Timeout Value for EMGUI over HTTPS

Session Inactive Timeout attribute specifies the inactivity period after which the

session terminates automatically.

Steps

1. Configure the ElementManagerWeb.idleTimer attribute to set Session Idle Timer. Note: 30 seconds before the session is timed out, a warning window pops up. Click on Keep me logged in to extend the session.

### 2.6.2 Configure Absolute Timeout Value for EMGUI over HTTPS

Absolute Timeout attribute specifies the maximum life span of a session after which

the session terminates automatically.

Steps

1. Configure the ElementManagerWeb.absoluteTimer attribute to set absolute timeout for EMGUI session. Note: After absolute timer limit is reached, the session terminates. New logon is required.

### 2.6.3 Configure Session Inactive Timeout Value for CLI over SSH or TLS

Session Inactive Timeout attribute specifies the inactivity period after which the

session terminates automatically.

Steps

1. Configure the Cli.idleTimer attribute to set Session Idle Timer. Note: Changing the Cli.idleTimer results in all ongoing Cli sessions to be terminated.

### 2.6.4 Configure Session Inactive Timeout Value for File Transfer over SSH or TLS

Session Inactive Timeout attribute specifies the inactivity period after which the

session terminates automatically.

Steps

1. Configure the FtpServer.idleTimer attribute to set Session Idle Timer.

## 2.7 Prepare User Credentials and Trusted Certificate for TLS Client Logon

Both maintenance users and O&amp;M users support TLS client logon. For TLS client logon,

the following components must be stored in the client:

- User credentials, including the user certificate and the corresponding private key
- A trusted certificate to validate the O&amp;M node certificate

The client can be located in

ENM or

outside of ENM. Depending on this, the way of

obtaining

user credentials and trusted certificate differs.

### 2.7.1 Scenario 1: When Initiating Node Connection from Outside of ENM

#### 2.7.1.1 Fetch User Certificate or User Credentials from PKI

User

certificate or

user

credentials for the client can be issued from any PKI owned by operators. In this

section, ENM PKI is taken as an example.

Prerequisites

- A PKI end entity for the user must be created in ENM PKI. For O&amp;M users, Common Name in the Subject field must be set to the username of the user. The Subject Alternative Name field is optional, but if it is configured, the Common Name in the Subject Alternative Name field must be set to the username of the user as well. For maintenance users, the Subject field in the end entity must fully match the MaintenanceUser.subjectName attribute in the node. For more information on creating a PKI end entity for a user, see the PKI Entity Management document in the ENM Online Help CPI library. The configuration for the case of AMOS, EM and WinFIOL users should be followed.

Steps

1. Do one of the following to generate the user certificate or user credentials: Example The following openssl commands can be used to generate an EC private key and the corresponding CSR file: Verify curves supported by your version of OpenSSL: openssl ecparam -list\_curves Create EC parameters file based on one of the available curves: openssl ecparam -name prime256v1 -out ecparam.pem Generate private key and CSR: openssl req -newkey ec:ecparam.pem -keyout private.key -out csr.pem Note: This step must be executed by Security Administrator. It is recommended to include the full chain in the generated user credentials or user certificate.
    - Log in to ENM PKI and generate the user certificate in Privacy Enhanced Mail (PEM) format by uploading a CSR file, which is generated by the client. With this method, the private key does not leave the client.
    - Log in to ENM PKI and generate the user credentials in PKCS#12 format, including the private key and the certificate.
2. Share the user certificate or user credentials through secure channels. Note: This step must be executed by Security Administrator.
3. Store the user certificate or user credentials in the client.
4. Optional: In case an user certificate in PEM format is created in Step 1 and the node access application requires user credentials in PKCS#12 format, the user certificate must be merged with the private key kept in the client into user credentials in PKCS#12 format. Example Copy the user certificate to the same location as the private key in the client. Use openssl to merge the user certificate and the private key into user credentials in PKCS#12 format: openssl pkcs12 -export -out credentials.p12 -inkey private.key -in certificate.pem

Node access applications EMCLI and EMGUI can be used to access the node with a

certificate from outside of ENM. For more information on further steps to access

the node with a certificate through EMCLI or EMGUI, see the dedicated documents

EMCLI and Manage EMGUI.

Results

The user certificate is fetched or user credentials are fetched from PKI and stored

in the client.

#### 2.7.1.2 Fetch Trusted Certificate from TDPS in ENM

O&amp;M node certificates are issued by ENM PKI. The ENM\_PKI\_Root\_CA can be

self-signed or act as subCA to an external CA.

For the TLS connection, a trusted certificate must be downloaded to the client from

ENM for validation of the O&amp;M node certificates.

Prerequisites

- CA certificates in the chain of the O&amp;M node certificate must be published to the Trust Distribution Point Service (TDPS) in ENM. For more information, see the section Trust Distribution Point Service Tasks of the document ENM Public Key Infrastructure System Administrator Guide in the Ericsson Network Manager CPI library.

Steps

1. Log in to ENM and get the TDPS URL of the root CA certificate in the O&amp;M node certificate chain through ENM CLI. For more information, see ENM Public Key Infrastructure System Administrator Guide in the Ericsson Network Manager CPI library. Note: This step must be executed by Security Administrator.
2. Open the TDPS URL shared by Security Administrator and download the trusted certificate.
3. Store the trusted certificate in the client.

Node access applications EMCLI and EMGUI can be used to access the node with a

certificate from outside of ENM. For information on further steps to access the

node with a certificate through EMCLI or EMGUI, see the dedicated documents

EMCLI and Manage EMGUI.

Results

A trusted certificate is fetched from

TDPS

and stored in the client.

### 2.7.2 Scenario 2: When Initiating Node Connection from ENM

#### 2.7.2.1 Fetch User Credentials and Trusted Certificate from PKI

User credentials for the

client in ENM

must

be issued

by

ENM PKI.

The

ENM\_PKI\_Root\_CA can be self-signed or act as subCA to an external CA.

In this section,

the default

ENM PKI is taken as an example.

Prerequisites

- A valid ENM user account is set up for ENM logon and for launching node access applications. For more information on configuring users, see the section Configuring Users to Access AMOS, Element Manager and WinFIOL Towards SL2 or TLS Enabled Nodes of the document ENM Network Security Configuration System Administrator Guide in the Ericsson Network Manager CPI library. To access the node, this user account must also be assigned with proper roles defined in the node.
- A PKI end entity for the user must be created in ENM PKI. It is created automatically if following the instruction in section Configuring Users to Access AMOS, Element Manager and WinFIOL Towards SL2 or TLS Enabled Nodes of the document ENM Network Security Configuration System Administrator Guide in the Ericsson Network Manager CPI library.

Steps

1. Log in to ENM and launch the node access application in ENM to connect to the node. The user credentials file ssucredentials.xml is automatically downloaded and stored in the client application of ENM. All CA certificates in the chain of the user credentials, including ENM\_PKI\_Root\_CA certificate, are automatically downloaded and stored in the client application of ENM.

Results

User credentials and the ENM\_PKI\_Root\_CA trusted certificate are fetched from ENM PKI

and stored in the client application of ENM.