---
complexity_score: 16.5
converted_at: '2025-08-13T06:59:23.355016Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 7
images_saved: 3
original_path: 4_1551-LZA7016017_1Uen.AF.html
pictures_extracted: 7
processing_method: docling_multimodal
quality_score: 9.0
source_file: 4_1551-LZA7016017_1Uen.AF.html
source_zip: en_lzn7931020_r50f.zip
tables_extracted: 14
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 1244
---

# 

Performance Event Format

NR

Contents

![Image](../images/4_1551-LZA7016017_1Uen.AF/additional_3_CP.png)

![Image](../images/4_1551-LZA7016017_1Uen.AF/additional_3_CP.png)

- Introduction
    - Additional Information
    - Purpose
- Performance Recordings
    - Cell Trace Recordings
    - UE Trace Recordings
- File Format for Recording Data
    - Overview of Cell Trace and UE Trace Recording File Formats
    - File Naming
        - Cell Trace Recording File Name Format
        - UE Trace Recording File Name Format
    - Cell Trace and UE Trace File Collection - ENM File Renaming
        - ENM File Renaming of Cell Trace Files
        - ENM File Renaming of UE Trace Files
    - File Data Outline
        - PM Event Layout
        - File Decoding
- Streaming Format for Recording Data
- Administrative Events
- Protocol Definition Example
- GPB Field Numbers
    - Reserved for Future

# 1 Introduction

## 1.1 Additional Information

- 3GPP TS 38.401; NG-RAN; Architecture description
- 3GPP TS 32.423; Telecommunication management; Subscriber and equipment trace; Trace data definition and management
- Language Guide (proto3)

## 1.2 Purpose

This document describes the overall format outline followed by detailed descriptions of

the included records of which it consists. This information is needed when designing

decoders for the NR Cell Trace and UE Trace event files.

# 2 Performance Recordings

A performance recording can be output to file or streamed to a designated receiver. For

file output, all recordings are accumulated into files for the duration of the ROP and

can be stored for up to 25 hours in the gNodeB. The ROP is 15 minutes for all Cell Trace

and UE trace files.

## 2.1 Cell Trace Recordings

Each Cell Trace recording logs events that are included in the event job.

Cell Trace event jobs are numbered 10000-10005.

The gNodeB-CU-CP, gNodeB-CU-UP, and gNodeB-DU managed functions each provide subscribed

events in Cell Trace ROP files or streams.

## 2.2 UE Trace Recordings

The UE Trace function records performance events from

individual, operator-selected UEs that travel through a network. Radio events can be

recorded for both the uplink and the downlink. These recordings allow the network

operator to identify parameters that must be adjusted, particularly after changing or

extending the network.

As the UE leaves the coverage area and it is passed over to the next network element, the

configuration data of the trace recording moves with the UE. Based on the configuration

data, performance events are written to files or streamed to an external receiver.

When the network element is a gNodeB, each of the gNodeB-CU-CP and gNodeB-DU managed

functions provide a file or stream for a single UE Trace job.

If events are written to files, they are collected by the OSS following the Cell Trace ROP. Selected UEs are identified by

their IMSI, IMEI, or IMEISV within the core or by the OSS.

Within the RAN, the trace session for a UE is uniquely identified by a trace

reference.

# 3 File Format for Recording Data

## 3.1 Overview of Cell Trace and UE Trace Recording File Formats

The recorded data consists of standardized events and proprietary events in Google

Protocol Buffers (GPB) format.

The interface messages are taken from the gNodeB external

interfaces in Abstract Syntax Notation 1 (ASN.1) encoded format and converted to

byte-packed binary format.

All recording types of PM recording files are compressed using GZIP (zLib) to further

save space and benefit the Operation and Maintenance (O&amp;M) bandwidth. A parser is

available in ENM to decode the files.

## 3.2 File Naming

PM event file names generated by the Cell Trace and UE Trace functions are prefixed with

A and suffixed with .gpb.gz.

The prefix A reflects the 3GPP-defined Type of the

measurement result included in the file. The suffix .gpb.gz

reflects that the PM events are GPB-encoded and the file is compressed using GZIP.

PM event files produced by the Cell Trace function contain

\_CellTrace\_ in the file name.

PM event files produced by the UE Trace function contain \_uetrace\_

in the file name.

### 3.2.1 Cell Trace Recording File Name Format

Files produced by the Cell Trace recording function have the following file name

format:

A&lt;Startdate&gt;.&lt;Starttime&gt;-&lt;Endtime&gt;\_CellTrace\_&lt;NF&gt;&lt;No&gt;\_&lt;RC&gt;\_&lt;EHI&gt;.gpb.gz

The prefix A reflects the 3GPP-defined Type of the

measurement result included in the file. The suffix .gpb.gz

reflects that the PM events are GPB-encoded and the file is compressed using GZIP.

For each file produced by the Cell Trace recording function, when

networkManagedElementId is set on

ManagedElement, a symbolic link to the file is stored. This link

has the same file name as the file it points to, except for the

NetworkManagedElementId, added as a node identifier:

A&lt;Startdate&gt;.&lt;Starttime&gt;-&lt;Endtime&gt;\_CellTrace\_&lt;NF&gt;&lt;No&gt;\_&lt;RC&gt;\_&lt;EHI&gt;\_NetworkManagedElementId.gpb.gz.

The variable parts of the Cell Trace recording file name are described in Table 1.

Table 1   Description of Variable Parts of Cell Trace Recording File Names

| Variable    | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <Startdate> | Indicates the date when the granularity period began. The                                         <Startdate> field is of the form YYYYMMDD,                                         where:  YYYY is the year in four-digit notation     MM is the month in two-digit notation (01–12)     DD is the day in two-digit notation (01–31)                                                                                                                            |
| <Starttime> | Indicates the time when the granularity period began. The                                         <Starttime> field is of the form HHMM,                                     meaning the following:    HH is the two-digit hour of the day, based on the 24-hour                                             clock (00 – 23).     MM is the two-digit minute of the hour. The possible                                             values are 00, 15, 30, and 45. |
| <Endtime>   | Indicates the time when the granularity period ended.  The <Endtime> field is of the form HHMM, meaning                                     the following:    HH is the two-digit hour of the day, based on the 24-hour                                             clock (00 – 23).     MM is the two-digit minute of the hour. The possible                                             values are 00, 15, 30, and 45.                                          |
| <NF>        | Indicates the network function type. The possible values are                                     CUCP, CUUP, and DU.                                                                                                                                                                                                                                                                                                                                              |
| <No>        | Indicates the number of the Network Function with one digit.                                                                                                                                                                                                                                                                                                                                                                                                      |
| <RC>        | Indicates the priority and type of the file. Can be set to the                                     following values:    1 for normal Cell Trace data     2 for high priority Cell Trace data     3 for high priority Continuous Cell                                             Trace                                                                                                                                                                            |
| <EHI>       | Event Handler Instance (EHI) where 1 is the first instance, 2 is                                     the second instance, and so on.                                                                                                                                                                                                                                                                                                                              |

Example 1   Cell Trace File

Name

A20200508.1315-1330\_CellTrace\_DU0\_1\_17.gpb.gz

### 3.2.2 UE Trace Recording File Name Format

Files produced by the UE Trace recording function have the following file name

format:

A&lt;StartDate&gt;.&lt;Starttime&gt;-&lt;Endtime&gt;-&lt;SenderType&gt;[&lt;SenderTypeInstance&gt;]\_uetrace\_&lt;TraceRef&gt;.gpb.gz

The prefix A reflects the 3GPP-defined Type of the

measurement result included in the file. The suffix .gpb.gz

reflects that the PM events are GPB-encoded and the file is compressed using GZIP.

The variable parts of the UE Trace recording file name are as described in Table 2. These variables follow the file naming

convention described in the 3GPP specification 3GPP TS 32.423.

Table 2   Description of Variable Parts of UE Trace Recording File Names

| Variable             | Description                                                                                                                                                                                                                                                                                                                                                                                          |
|----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <Startdate>          | Indicates the date of the first record in the trace file. The                                         <Startdate> field is of the form YYYYMMDD,                                         where:  YYYY is the year in four-digit notation     MM is the month in two-digit notation (01–12)     DD is the day in two-digit notation (01–31)                                                           |
| <Starttime>          | Indicates the time of the first record in the trace file. The                                     field is of the form HHMM, where:  HH is the two-digit hour of the day, based on the                                                 24-hour clock (00–23)     MM is the two-digit minute of the hour. The possible                                                 values are 00, 15, 30, and 45. |
| <Endtime>            | Indicates the time of the first record in the trace file. The                                     field is of the form HHMM, where:  HH is the two-digit hour of the day, based on the                                                 24-hour clock (00–23)     MM is the two-digit minute of the hour. The possible                                                 values are 00, 15, 30, and 45. |
| <SenderType>         | Indicates the type of the sender or network function that                                     produced the file. The possible values are CUCP, CUUP, or                                     DU.                                                                                                                                                                                                      |
| <SenderTypeInstance> | Indicates the instance of the <SenderType>. It                                     is set to 1.  This field can be zero to four digits in length.                                                                                                                                                                                                                                                    |
| <TraceRef>           | The Trace Reference is represented in hexadecimal format. It is                                     composed of the PLMN ID (MCC, MNC) and the Trace ID.(1)                                                                                                                                                                                                                                          |

(1)

For more information on the Trace ID, see 3GPP TS

32.423, B.1.

Example 2   UE Trace File

Name

A20200508.1315-1330-DU1\_uetrace\_12F5935000E9.gpb.gz

## 3.3 Cell Trace and UE Trace File Collection - ENM File Renaming

When ENM collects the PM event files created by the Cell Trace and UE Trace recording

functions, it renames the files to make them more accessible to northbound systems. ENM

inserts a &lt;UniqueId&gt; in the file name produced by the Cell Trace and UE

Trace functions. This serves to identify from which node the file came.

The &lt;UniqueId&gt; is the Managed Element name used in the ENM system.

### 3.3.1 ENM File Renaming of Cell Trace Files

When ENM collects the PM event file produced by the Cell Trace recording function, it

renames the file by inserting a &lt;UniqueId&gt; in the file name and

replaces the CellTrace element of the file name with

celltracefile.

| Original Cell Trace file name   |    | A<Startdate>.<Starttime>-<Endtime>_CellTrace_<NF><No>_<RC>_<EHI>.gbp.gz                |
|---------------------------------|----|----------------------------------------------------------------------------------------|
|                                 |    |                                                                                        |
| Cell Trace file renamed by ENM  |    | A<Startdate>.<Starttime>-<Endtime>_<UniqueId>_celltracefile_<NF><No>_<RC>_<EHI>.gbp.gz |

### 3.3.2 ENM File Renaming of UE Trace Files

When ENM collects the PM event file produced by the UE Trace recording function, it

renames the file by inserting a &lt;UniqueId&gt; in the file name and

replaces the uetrace element of the file name with

uetracefile. ENM also inserts the

&lt;ObfuscatedUeId&gt; element in the name of the file.

If ENM can map the Trace Reference in the original file name to the IMSI, IMEI, or IMEISV

provided when the UE Trace job was created, the obfuscated IMSI, IMEI, or IMEISV is

added to the file name. Otherwise, the value UNKNOWN is added. If

the obfuscation fails in ENM, the file name is replaced with the string

ANONYMIZERFAILED. This provision is meant to preserve the

privacy of attributable data even in the case of partial software failures.

Files based on the same Trace Reference are stored in the same directory. Files where the

mapping from Trace Reference to &lt;ObfuscatedUeId&gt; fails are stored in a

common UNKNOWN directory.

| Original UE Trace file name   |    | A<StartDate>.<Starttime>-<Endtime>-<SenderType>[<SenderTypeInstance>]_uetrace_<TraceRef>.gpb.gz                                 |
|-------------------------------|----|---------------------------------------------------------------------------------------------------------------------------------|
|                               |    |                                                                                                                                 |
| UE Trace file renamed by ENM  |    | A<StartDate>.<Starttime>-<Endtime>_<UniqueId>_<TraceRef>_<ObfuscatedUeId>_uetracefile_<SenderType>[<SenderTypeInstance>].gpb.gz |

Example 3   File Path When

&lt;ObfuscatedUeId&gt; Can Be Determined Based on Trace

Reference

/ericsson/pmic1/UETRACE/NRAT/216354010001/A20160308.1315+0000-1330+0000\_SubNetwork=LTESubNetwork,MeContext=NR01NR45600057\_216354010001\_4eZakHiCiHakCyZwLuroWZdW1i44wvzDvXVH\_yjjpYI=\_uetracefile\_CUCP1.gpb.gz

Example 4   File Path When

&lt;ObfuscatedUeId&gt; Cannot Be Determined Based on Trace

Reference

/ericsson/pmic1/UETRACE/NRAT/UNKNOWN/A20160308.1315+0000-1330+0000\_SubNetwork=LTESubNetwork,MeContext=NR01NR45600057\_216354010001\_UNKNOWN\_uetracefile\_CUCP1.gpb.gz

## 3.4 File Data Outline

On a high level, the file structure is built up of PM events. All information is

formatted in GPB version 3 (proto3).

Logical Layout

The delimiter is the size of the succeeding PM event, written as a GPB variable

length 32-bit integer.

Different approaches can be used to read the PM event depending on the language

chosen.

In proto3, zero values are filtered out, which makes it impossible to distinguish

between a no value and a zero value. To cope with this behavior, specific values are

set for the no value case.

Table 3   Values Set for No Value Cases

| Value                      | Description                         |
|----------------------------|-------------------------------------|
| -9,223,372,036,854,775,808 | Mandatory parameter without value   |
| -9,223,372,036,854,775,807 | Mandatory parameter without license |

The Mandatory parameter without license has priority over the Mandatory parameter

without value in case of no value and no license.

Example 5   PM Event Reading in Java Language

```
java.lang.Object
com.google.protobuf.AbstractParser<MessageType>
public MessageType parseDelimitedFrom(InputStream input)
                               throws InvalidProtocolBufferException
```

### 3.4.1 PM Event Layout

Each PM event is structured with PM Event Outer Header, PM Event Header and PM Event

Payload as shown in Example 6

and Protocol Definition Example.

Example 6   PM Event Layout

```
message PmEvent {

// PM Event Outer Header
  PmEventMessageGroup group = 3;
  int64 event_id = 4;
  
// PM Event Header
  PmEventHeader header = 14;

// PM Event Payload
  bytes payload = 15;

}
```

### 3.4.2 File Decoding

Steps

1. Decode the proto delimiter at the start of the message to indicate how many bytes are part of the succeeding PM event.
2. Decode the PM event by using a GPB decoder with the relevant PM event proto definition. The PmEventMessageGroup enum parameter in PM Event Outer Header states what message definition is used to decode the payload field. Table 4 Messages Used to Decode Payload PmEventMessageGroup Value Message Used to Decode Payload PM\_EVENT\_MESSAGE\_GROUP\_COMMON CommonPmEvent (see Example 7) PM\_EVENT\_MESSAGE\_GROUP\_DU DuFunctionPmEvent PM\_EVENT\_MESSAGE\_GROUP\_CUCP CuCpFunctionPmEvent PM\_EVENT\_MESSAGE\_GROUP\_CUUP CuUpFunctionPmEvent (see Example 8) Note: This process can be repeated for all PM events in the file.

# 4 Streaming Format for Recording Data

The event record for Cell Trace or UE Trace streams has the same format as the files.

Related Information

Overview of Cell Trace and UE Trace Recording File Formats

# 5 Administrative Events

Administrative events are special events that convey administrative messages for trace

file and stream management purposes. When applicable, administrative events are

activated automatically for all trace jobs. All administrative events are listed in

Lists and Delta Lists - Referral Document.

The structure of regular PM events can apply to administrative events. If no payload

parameters are defined for administrative events, the outer header parameters and header

parameters apply.

The messages of administrative events appears as common messages in the file. For more

information on message format, see Protocol Definition Example.

# 6 Protocol Definition Example

Example 7   PM Event Protocol Example

```
syntax="proto3";
package pm_event;
option java_package = "com.ericsson.pm_event";
option java_outer_classname = "PmEventOuterClass";

message PmEventHeader {
  int64 time_stamp = 1;
  bytes system_uuid = 2;
  string compute_name = 3;
  string network_managed_element = 4;
  repeated int64 pm_event_job_ids = 5;
  bytes trace_reference = 7;
  bytes trace_recording_session_reference = 8;
}

enum PmEventMessageGroup {
  PM_EVENT_MESSAGE_GROUP_NO_VALUE = 0;
  PM_EVENT_MESSAGE_GROUP_COMMON = 1;
  PM_EVENT_MESSAGE_GROUP_DU = 2;
  PM_EVENT_MESSAGE_GROUP_CUCP = 3;
  PM_EVENT_MESSAGE_GROUP_CUUP = 4;
}

enum UeTraceJobActivationTask {
  UE_TRACE_JOB_ACTIVATION_TASK_NO_VALUE = 0;
  UE_TRACE_JOB_ACTIVATION_TASK_INITIAL = 1;
  UE_TRACE_JOB_ACTIVATION_TASK_PROPAGATION = 2;
}

enum UeTraceJobDeactivationCause {
  UE_TRACE_JOB_DEACTIVATION_CAUSE_NO_VALUE = 0;
  UE_TRACE_JOB_DEACTIVATION_CAUSE_OSS = 1;
  UE_TRACE_JOB_DEACTIVATION_CAUSE_TRAFFIC = 2;
}

message FileOpen {
}

message FileCloseEndOfRop {
}

message FileCloseMaxFileSizeReached {
}

message MaxFileSizeRecovery {
}

message DroppedEvents {
  int64 number_of_dropped_events = 1;
  string managed_function = 2;
}

message Heartbeat {
  string managed_function = 1;
}

message FileContentRemovedForHigherPriorityFiles {
}

message StartRecordingSession {
  UeTraceJobActivationTask activation_task = 1;
}

message StopRecordingSession {
  UeTraceJobDeactivationCause deactivation_cause = 1;
}

message RecordingSessionMaxUeTraceFilesReached {
  UeTraceJobActivationTask activation_task = 1;
}

message RecordingSessionMaxStreamedUeTracesReached {
  UeTraceJobActivationTask activation_task = 1;
}

message CommonPmEvent {
  oneof event_payload {
    FileOpen file_open = 1;
    FileCloseEndOfRop file_close_end_of_rop = 2;
    FileCloseMaxFileSizeReached file_close_max_file_size_reached = 3;
    MaxFileSizeRecovery max_file_size_recovery = 5;
    DroppedEvents dropped_events = 6
    Heartbeat heartbeat = 8;
    FileContentRemovedForHigherPriorityFiles file_content_removed_for_higher_priority_files = 9;
    StartRecordingSession start_recording_session = 10;
    StopRecordingSession stop_recording_session = 11;
    RecordingSessionMaxUeTraceFilesReached recording_session_max_ue_trace_files_reached = 12;
    RecordingSessionMaxStreamedUeTracesReached recording_session_max_streamed_ue_traces_reached = 13;
  }
}

message PmEvent {
  PmEventMessageGroup group = 3;
  int64 event_id = 4;
  PmEventHeader header = 14;
  bytes payload = 15;
}
```

Example 8   Example Messages

```
// CuUpFunctionPmEvent

syntax="proto3";
package pm_event;
option java_package = "com.ericsson.pm_event";
option java_outer_classname = "CuUpFunctionPmEventOuterClass";

import "pm_event/cu_up_e1_reset.proto";
import "pm_event/cu_up_e1_reset_acknowledge.proto";

message CuUpFunctionPmEvent {
  oneof event_payload {  
    CuUpE1Reset cu_up_e1_reset = 4014;
    CuUpE1ResetAcknowledge cu_up_e1_reset_acknowledge = 4015;
  }
}
```

Example 9   Example Event

```
syntax="proto3";
package pm_event;
option java_package = "com.ericsson.pm_event";

message CuUpE1Reset {
  // PmEventId: 4014
  enum MsgDirection{
    MSG_DIRECTION_NO_VALUE = 0;
    MSG_DIRECTION_SEND = 1;
    MSG_DIRECTION_RECEIVE = 2;
    MSG_DIRECTION_NO_LICENSE = 255;
  }
  enum ProtocolName{
    PROTOCOL_NAME_NO_VALUE = 0;
    PROTOCOL_NAME_RRC_36_331_BCCH_BCH_MESSAGE = 1;
    PROTOCOL_NAME_RRC_36_331_BCCH_DL_SCH_MESSAGE = 2;
    PROTOCOL_NAME_RRC_36_331_DL_CCCH_MESSAGE = 3;
    PROTOCOL_NAME_RRC_36_331_DL_DCCH_MESSAGE = 4;
    PROTOCOL_NAME_RRC_36_331_PCCH_MESSAGE = 5;
    PROTOCOL_NAME_RRC_36_331_UL_CCCH_MESSAGE = 6;
    PROTOCOL_NAME_RRC_36_331_UL_DCCH_MESSAGE = 7;
    PROTOCOL_NAME_RRC_38_331_BCCH_BCH_MESSAGE = 8;
    PROTOCOL_NAME_RRC_38_331_BCCH_DL_SCH_MESSAGE = 9;
    PROTOCOL_NAME_RRC_38_331_DL_CCCH_MESSAGE = 10;
    PROTOCOL_NAME_RRC_38_331_DL_DCCH_MESSAGE = 11;
    PROTOCOL_NAME_RRC_38_331_PCCH_MESSAGE = 12;
    PROTOCOL_NAME_RRC_38_331_UL_CCCH_MESSAGE = 13;
    PROTOCOL_NAME_RRC_38_331_UL_DCCH_MESSAGE = 14;
    PROTOCOL_NAME_S1AP_36_413 = 15;
    PROTOCOL_NAME_X2AP_36_423 = 16;
    PROTOCOL_NAME_NGAP_38_413 = 17;
    PROTOCOL_NAME_XNAP_38_423 = 18;
    PROTOCOL_NAME_F1AP_38_473 = 19;
    PROTOCOL_NAME_E1AP_38_463 = 20;
    PROTOCOL_NAME_NO_LICENSE = 255;
  }
  message Asn1Message {
    MsgDirection msg_direction = 1;
    bytes msg_content = 2;
    repeated ProtocolName protocol_name = 3;
  }
  bytes main_plmn_id = 1;
  int64 gnb_id = 2;
  int64 gnb_id_length = 3;
  Asn1Message asn1 = 4;
}
```

# 7 GPB Field Numbers

The GPB field numbers are used for the event parameters in message definitions. The

retired GPB field numbers are not listed in Lists and Delta Lists - Referral Document. For

more information on field number, refer to Language Guide.

## 7.1 Reserved for Future

Table 5 shows GPB field numbers

that are reserved for future use and in which messages they are reserved.

Table 5   GPB Field Numbers Reserved for Future Use

| Message               | GPB Field Number   | Note                                                                  |
|-----------------------|--------------------|-----------------------------------------------------------------------|
| PmEvent               | 1, 2, 5, 6, 7      | Reserved for future use.  GPB field numbers in PM Event Outer Header. |
| PmEventHeader         | 6                  | Reserved for future use.                                              |
| FileOpen              | 1, 2, 3, 4         | Reserved for future use.                                              |
| StartRecordingSession | 2, 3               | Reserved for future use.                                              |
| TraceSessionStart     | 1, 2               | Reserved for future use.                                              |