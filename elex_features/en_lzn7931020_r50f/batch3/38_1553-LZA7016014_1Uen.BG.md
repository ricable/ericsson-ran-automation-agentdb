---
complexity_score: 26.5
converted_at: '2025-08-13T06:59:16.449868Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 3
images_saved: 3
original_path: 38_1553-LZA7016014_1Uen.BG.html
pictures_extracted: 3
processing_method: docling_multimodal
quality_score: 9.0
source_file: 38_1553-LZA7016014_1Uen.BG.html
source_zip: en_lzn7931020_r50f.zip
tables_extracted: 38
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 1244
---

# 

Manage Quality of Service

Contents

![Image](../images/38_1553-LZA7016014_1Uen.BG/additional_3_CP.png)

![Image](../images/38_1553-LZA7016014_1Uen.BG/additional_3_CP.png)

- Description
    - Quality of Service Overview
    - Licensed Functionality
    - Packet and Frame Priority
    - Queues
    - Scheduler
    - Shaper
    - Hierarchies
    - PCP to Queue Maps
    - DSCP to PCP Maps
    - Ingress Remarking
    - QoS for Radio Applications
    - RAN Transport Sharing
    - Managed Object Model Overview
    - QueueSystem MO
    - Subsidiary MOs to QueueSystem MO
    - QoS Profiles: PCP to PCP Maps
    - QoS Profiles: DSCP to PCP Maps
    - QoS Profiles: DSCP to DSCP Maps
- Procedures
    - Configuration Overview
    - Flow Configuration
    - Utilization Configuration
    - How to configure a Queue System for an Ethernet Interface
    - Configure a DSCP to PCP Map for an IP Interface
    - Configure a DSCP to PCP Map for an Ethernet Port
    - Configure a PCP to PCP Map for an Ethernet Port or a VLAN Port
    - Configure a DSCP to DSCP Map for an Ethernet Port, VLAN Port, Interface IPv4, or Interface IPv6
- Troubleshoot QoS
    - Useful Troubleshooting Command

# 1 Description

## 1.1 Quality of Service Overview

The Quality of Service (QoS) involves a management model and related concepts. It provides a

description of the following topics:

- The modeling of the area
- The functions related to the area
- The management of the functions

A managed area represents a group of functions and the corresponding MOs within the node. The

grouping of the managed areas defines areas mostly independent of one another.

The following functions are supported:

- The PCP to Queue Map puts the Ethernet frames in the desired queue, based on PCP.
- The DSCP to PCP Map assigns the correct PCP value to the encapsulating Ethernet frame of the IP packet.
- The Ingress remarking PCP or DSCP value packet or frame on the basis of the map.
- The Queue System building blocks make it possible to construct the desired traffic schedule. The Queue System building blocks are the following: Queues Random Early Drop (RED) queue Tail Drop queue Shapers Schedulers Strict Priority (SP) DWRR

## 1.2 Licensed Functionality

A number of functions related to the QoS are under license control, such as the following

MOs:

- QueueSystem
- QueueTailDrop, QueueRed (Queues)
- Shaper
- SchedulerDwrr and SchedulerSp (Schedulers)
- QoSClassifier
- DscpToPcpMap
- DscpSetToPCP
- PcpToQueueMap
- PcpSetToQueue
- PcpPcpMap
- DscpDscpMap

The following MOs are not under license control:

- QosProfiles
- DscpPcpMap
- QciProfilePredefined
- QciProfileOperatorDefined

## 1.3 Packet and Frame Priority

PCP defines Ethernet priority. The IEEE 802.1Q standard determines the PCP. PCP = 7 has the highest priority. Incoming packets without a PCP field

are treated as PCP = 0.

DSCP defines IP priority. Six bits of the Differentiated Service Field are occupied by DSCP.

The Differentiated Service Field consists of eight bits in total. See RFC 3260 for the

definition.

## 1.4 Queues

A queue is a buffer used by the system to temporarily store packets that are to be forwarded.

A queue is characterized by the following entities:

- Size of the queue.
- An enqueuing behavior, which defines how data is inserted in the queue.
- A dequeuing behavior, which defines how data is extracted from the queue.

The traffic selector selects the Ethernet frames to enqueue. Traffic can be selected by the

tuple {PCP, egress port (VLAN or Ethernet)}.

The enqueuing behavior is defined by the queue type, which is either Tail Drop or RED.

A Tail Drop queue drops frames when it is full. A RED queue begins to drop frames with a

probability &lt;P&gt; value, when it reaches the &lt;min&gt; threshold.

When a RED queue is full it reaches its &lt;max&gt; threshold. It means that

&lt;P=100%&gt;. In such cases, the RED queue drops all frames.

The dequeuing behavior is defined by the hierarchy of the following elements:

- Shaper
- Scheduler
- Queue

The dequeuing behavior occurs as a program that is executed every time a frame is to be

forwarded.

By default, there are eight queues for each Ethernet interface in the system. The queues are

denoted as Q1 to Q8. All queues are of the QueueTailDrop MO. The default

queue system is not visible in the MOM configuration.

When new Baseband units are introduced, the size of each queue in the default queue system

depends on the port capacity of the Baseband units and queue levels. For older Baseband units,

each queue has a default size of 1 MB. Table 1

shows the relationship between queue sizes and the port capacity for new Baseband units.

Table 1   Queue Size in the Default System

|   Port Capacity  (Gbps) |   Queue Level 1  (MB) |   Queue Level 2-5  (MB) | Queue Level 6-8  (MB)   | Total  (MB)   |
|-------------------------|-----------------------|-------------------------|-------------------------|---------------|
|                       1 |                   0.5 |                       1 | 1                       | 7.5           |
|                      10 |                   0.5 |                       1 | 1.5  5.5(1)             | 9  21(1)      |
|                      25 |                   0.5 |                       1 | 3.5  5.5(1)             | 15  21(1)     |
|                      50 |                   0.5 |                       1 | 7                       | 22.5          |
|                     100 |                   0.5 |                       1 | 14                      | 43.5          |

(1)

Only for RAN Compute Group 6.

The memory budget for egress queue system accounts for all queue systems, which include

default queue systems and custom-created queue system, within the Baseband. Table 2 shows the total memory budgets for the Baseband

units.

Table 2   Memory Budgets for Egress Queue System

| RAN Compute Group   |   Maximum Link Speed  (Gbps) |   Total Memory Budget  (MB) |
|---------------------|------------------------------|-----------------------------|
| RAN Compute Group 4 |                           10 |                          36 |
| RAN Compute Group 5 |                           25 |                          60 |
| RAN Compute Group 6 |                          100 |                         180 |

Configuration of large queues can cause latency issues, which are difficult to detect.

Therefore, custom egress queue systems must be created with caution. For a new Baseband unit,

besides the queue size, a lower link capacity can increase latency.

The following counters provide feedback on whether the queue size setting is adequate:

- QueueRed.filledLowerThreshold
- QueueTailDrop.filledLowerThreshold
- QueueRed.filledUpperThreshold
- QueueTailDrop.filledUpperThreshold

QoS features represented by the following MOs under QueueSystem MO are not

available for hardware-switched flows egressing through applicable VlanPort

MO, EthernetPort MO, or both:

- QueueRed
- QueueTailDrop
- QoSClassifier
- SchedulerDwrr
- SchedulerSp
- Shaper

## 1.5 Scheduler

A scheduler manages its child nodes, which are either queues or schedulers. The scheduler

selects the child nodes to serve at the next transmission. When a node has a backlog of

packets, it has the next transmission opportunity.

A scheduler always tries to use all available bandwidth. If a queue is empty, other queues

that are not empty share the unused bandwidth.

There are two major scheduler types, the SP scheduler and the DWRR

scheduler.

In case of an SP scheduler, its child node n always has priority

over child node n+1.

The DWRR scheduler follows a deficit round robin schedule, where each child queue has its own

weight. It is possible that none of the child queues are empty. In such cases, the

scheduler assures the servicing of queues at the rate specified by their weights.

## 1.6 Shaper

Shaper behavior defines the egress bandwidth as defined in MEF 10.2 (27 October 2009).

The CIR is the Bandwidth Profile parameter. It defines the average rate of Service Frames in

bps up to which the network delivers Service Frames and meets the performance objectives.

These objectives are defined by the CoS attribute. This is the average flow described in bps.

CoS is defined by the PCP for Ethernet frames.

The CBS is a bandwidth profile parameter. It limits the maximum number of bytes available for

a burst of service frames sent at the UNI. The limit determines the number of bytes that can

be used for bursts in a time period. The burst of Service Frames is sent at the UNI speed to

remain conformant to CIR.

## 1.7 Hierarchies

A hierarchy of five levels is supported. The hierarchy may contain the following nodes:

- A Shaper with an SP Scheduler, a DWRR Scheduler or a Queue as child.
- A DWRR Scheduler with an SP Scheduler, a DWRR Scheduler, a Shaper and/or Queues as children.
- An SP Scheduler with an SP Scheduler, a DWRR Scheduler, a Shaper and/or Queues as children. (An SP Scheduler can have up to four children.)
- A Queue.

A Scheduler or a Shaper cannot have more than two Scheduler ancestors in the hierarchy.

## 1.8 PCP to Queue Maps

PCP to Queue Maps are used to specify the queue in which an Ethernet frame is to be

temporarily stored. The mapping can be configured by the operator. In the default queue

system, the PCP number describes priority. PCP 7 is the highest value. Priority descends from

PCP 7 downwards. The only deviation from this rule is that PCP 1 has a lower priority than PCP

0.

VLAN can have their own PCP to Queue Maps, which result in the following functionalities:

- More than eight queues for each EthernetPort.
- Traffic with the same PCP can be prioritized differently, if they are on different VLANs.
- Queues can be shared between PCP to Queue Maps.
- Separate PCP to Queue Maps can be used. This means that each PCP to queue map has its own queue.

It is possible that the VlanPort.egressQosQueueMap attribute on a VLAN is

not set. In such cases, the PCP to Queue Map for the underlying Ethernet interface is

used.

An Ethernet interface can have more than one PCP to Queue Maps. In this case, the

EthernetPort.egressQosQueueMap attribute is to be set on the Ethernet

interface to determine which map to use. If only one map is available, the Ethernet interface

uses that.

## 1.9 DSCP to PCP Maps

The DSCP can be mapped to the PCP in the two following ways:

- By DSCP to PCP Maps with IP interfaces (IPv4 and IPv6) not under license control
- By Ethernet-port DSCP to PCP Maps, under license control

DSCP to PCP Maps associated with the IP interfaces mark each Ethernet frame with a PCP value.

This PCP value corresponds to the DSCP value. The functionality does not require

licensing.

DSCP to PCP Maps can be associated with both the IP interface and the Ethernet port. In such

cases, the map associated with the Ethernet Port overrides the map associated with the IP

Interface.

It is possible that the DSCP to PCP Map is not defined for an IP interface. In this case, the

IP interface uses the default DSCP to PCP Map.

Table 3   The DSCP to PCP Map of the Default Queue System

| DSCP           |   PCP | Queue Level   |
|----------------|-------|---------------|
| 51, 54         |     7 | Q1            |
| 32, 40, 48     |     6 | Q2            |
| 34, 36, 38, 46 |     5 | Q3            |
| 8, 16, 26, 28  |     4 | Q4            |
| 18, 20, 22     |     3 | Q5            |
| 10, 12, 14     |     2 | Q6            |
| none           |     1 | Q8            |
| 0, other       |     0 | Q7            |

## 1.10 Ingress Remarking

Ingress remarking makes it possible to handle incoming traffic that does not follow the

Network QoS Policy. Such incoming traffic can be the following, for example:

- Traffic coming from another QoS domain
- Traffic coming from nodes with poor QoS configuration possibilities

Ingress remarking can be configured to remark the following fields:

- Ingress PCP to PCP remarking (for bridging)
- Ingress DSCP to DSCP remarking (for routing and bridging)

## 1.11 QoS for Radio Applications

DSCP or PCP values are used by the transport network nodes. The QoS setting of DSCP or PCP

mapping have to be aligned with these values.

Table 4   Simplified Transport Network Settings

|   PCP Queue | PHB   | Scheduling Mode   | WFQ Weight   | Reserved Bandwidth (CIR)   |   Data Rate (kbps) | Available Bandwidth (PIR)   |
|-------------|-------|-------------------|--------------|----------------------------|--------------------|-----------------------------|
|           7 | LU    | SP                | N/A          | 4%                         |                  0 | 4%                          |
|           6 | CS6   | SP                | N/A          | 4%                         |                  0 | 4%                          |
|           5 | EF    | SP                | N/A          | 40%                        |                  0 | 40%                         |
|           4 | AF31  | DWRR              | 35%          | 22%                        |                  0 | 100%                        |
|           3 | AF21  | DWRR              | 30%          | 15%                        |                  0 | 100%                        |
|           2 | AF13  | DWRR              | 25%          | 15%                        |                  0 | 100%                        |
|           1 | BE    | DWRR              | 10%          | 0%                         |                  0 | 100%                        |

Table 4 shows an example for correct QoS settings.

The transport network limits the total bandwidth of a link with the highest priority to 4%.

The total bandwidth voice services (EF services) can occupy is limited to 40%. This applies

even if additional capacity is available, as the PIR value does not change. At least 15% of

the bandwidth is reserved for data traffic (AF classes). However, data traffic can use up to

100% of the available bandwidth, if the network has free capacity. All traffic of the radio

node can be mapped to the highest priority queue. In this case, only 4% of the total network

capacity is used.

### 1.11.1 QoS for LTE

QoS for LTE is related to QoS configuration in the RBS for S1, X2 and Mul traffic.

User plane traffic is transported over the S1 and X2 interfaces through E-UTRAN Radio Access

Bearers (E-RABs). Each E-RAB is assigned a QoS Class Indentifier (QCI) when the E-RAB is set

up with S1-AP or X2-AP signaling. The QCI defines QoS characteristics for data transported

over the E-RAB. It is possible to define DSCP values for each QCI by way of configuring the

QciProfilePredefined MO. The QCI value is specified using the

QciProfilePredefined.qci attribute. The corresponding DSCP value is

specified using the QciProfilePredefined.dscp attribute.

If the DSCP Mapping Based on ARP and QCI feature is activated, it

is possible to configure different DSCP values based on ARP and QCI pairs provided by

the MME. This can be done with the QciProfilePredefined.dscpArpMap

and QciProfileOperatorDefined.dscpArpMap parameters.

There are no QCI values for control plane traffic. Instead, DSCP values can be set by MOs for

control plane configuration. The MOs for O&amp;M communication configuration enable the

setting of DSCP values for O&amp;M traffic over Mul. Table 5 shows the recommended DSCP values for the

different traffic types.

Table 5   Recommended QCI, PHB, and DSCP Values

| Traffic Type                                             | PHB   |   DSCP |
|----------------------------------------------------------|-------|--------|
| Network Synchronization                                  | LU    |     54 |
| Routing, Network Control                                 | CS6   |     48 |
| QCI1 - GBR Conversational Voice                          | EF    |     46 |
| QCI2 - GBR Conversational Video (Live Streaming)         | AF42  |     36 |
| QCI3 - GBR Real Time Gaming                              | AF41  |     34 |
| QCI4 - GBR Non-Conversational Video (Buffered Streaming) | AF43  |     38 |
| QCI5 - IMS Signaling                                     | CS5   |     40 |
| QCI6 - Non-GBR TCP-Specific Services                     | AF31  |     26 |
| QCI7 - Non-GBR Voice/Video/Interactive Gaming            | AF11  |     10 |
| QCI8 - Non-GBR TCP Premium Bearer                        | AF12  |     12 |
| QCI9 - Non-GBR TCP Default Bearer                        | AF13  |     14 |
| S1AP/X2AP - Inter-Node Signaling                         | CS5   |     40 |
| O&M Access (including O&M Bulk Data)(1)                  | CS2   |     16 |

(1) O&amp;M Bulk Data cannot be

separated from general O&amp;M Access. Otherwise, O&amp;M Bulk Data is to be given

lower priority.

Other types of O&amp;M communication include, for example, performance management data. All

other O&amp;M communication coming from the RBS transport interface applies the DSCP value set

by the dscp attribute.

The following examples of MOs allow for the configuration of the dscp

attribute:

- BfdProfile
- DnsClient
- OamAccessPoint
- SctpProfile

The InterfaceIPv4 MO allows for the configuration of the

pcpArp attribute.

The InterfaceIPv6 MO allows for the configuration of the

dscpNdp attribute.

Details of configuration can be found in Managed Object Model (MOM).

For QoS for data transport over the air interface, see Manage Radio Network and Manage Bearers and Services.

### 1.11.2 QoS for WCDMA

The DSCP values for user plane traffic are set by the RNC that sends the signals to the

RBS.

The SctpProfile.dscp attribute configures DSCP values for control plane

traffic in the SCTP association endpoint.

O&amp;M communication includes, for example, performance management data. All such O&amp;M

communication coming from the RBS transport interface applies the DSCP value set by the

dscp attribute.

The following examples of MOs allow for the configuration of the dscp

attribute

- BfdProfile
- DnsClient
- OamAccessPoint
- SctpProfile

The InterfaceIPv4 MO allows for the configuration of the

pcpArp attribute.

For further configuration details, see the Managed Object Model (MOM).

### 1.11.3 QoS for NR

In EN-DC deployment, the UE connects to the eNodeB and uses control plane signaling

through the LTE network. The UE can also establish user plane connectivity in NR cells.

User data is transported through an S1-U interface that terminates in the gNodeB. From

the gNodeB, user data is sent to the UE in the LTE cell, in the NR cell, or both. To

achieve NR connectivity, the eNodeB sets up DRB resources in the gNodeB through X2-AP

signaling. The eNodeB sends DRB-related QCI parameters to the gNodeB to control the QoS.

The QoS Framework feature supports QoS for EN-DC users by a

straight mapping of QCI to 5QI, that is, QCI=x is treated as 5QI=x.

In an NR SA deployment, user plane traffic is transported over the NG-U and Xn-U

interfaces through PDU sessions. A PDU session can contain one or more QoS flows, and

can be set up with NGAP or XnAP signaling. After the PDU session is set up, the QoS flow

is assigned an NR QoS identifier (5QI). The 5QI defines QoS characteristics for data

transmission within the session. Predefined QCI values map well to predefined 5QI

values.

Furthermore, the NR QoS framework has the following additions:

- In NR, a new resource type called Delay Critical GBR is introduced.
- Specific QoS profile parameters can be signaled to override the values defined for the 5QI.

The PDU Session Resource Modify procedure checks if a new QoS flow is set up with 5QI=1

(conversational voice). If 5QI=1, the gNodeB replies to the AMF with a message involving

a cause value. As voice is supported in LTE, the cause value is the following:

IMS voice EPS fallback or RAT fallback triggered. In

such cases, blind release with redirect  is applied on the following conditions:

- There is a neighboring E-UTRAN frequency
- The UE is capable of transmission through E-UTRAN frequency bands

In this way, the UE is redirected to the E-UTRAN frequency, and the UE resources

are released.

QoS properties of an already established QoS flow and a DRB can be modified to provide

more flexible treatment of services to the connected UEs.

Table 6 shows the 5QI values assigned to the

various available services.

Table 6   5QI Values and Services

|   5QI Value | Example Services                                                                                                                                                                   |
|-------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|           1 | Conversational Voice                                                                                                                                                               |
|           2 | Conversational Video                                                                                                                                                               |
|           3 | Real Time Gaming, V2X Messages  Electricity Distribution - Medium Voltage  Process Automation - Monitoring                                                                         |
|           4 | Non-Conversational Video                                                                                                                                                           |
|          65 | Mission Critical User Plane  Push To Talk voice                                                                                                                                    |
|          66 | Non-Mission-Critical User Plane  Push To Talk Voice                                                                                                                                |
|          67 | Mission Critical Video user plane                                                                                                                                                  |
|          75 | V2X messages                                                                                                                                                                       |
|           5 | IMS Signaling                                                                                                                                                                      |
|           6 | Video (Buffered Streaming)  TCP-Based (for example, www, e-mail, chat, ftp, p2p file sharing,                                 progressive video, and so on)                        |
|           7 | Voice, Video (Live Streaming), Interactive Gaming                                                                                                                                  |
|           8 | Video (Buffered Streaming)  TCP-Based (for example, www, e-mail, chat, ftp, p2p file sharing,                                 progressive video, and so on)                        |
|           9 | Video (Buffered Streaming)  TCP-Based (for example, www, e-mail, chat, ftp, p2p file sharing,                                 progressive video, and so on)                        |
|          69 | Mission Critical Delay-Sensitive Signaling (for example, MC-PTT                                 signaling)                                                                         |
|          70 | Mission Critical Data  Video (Buffered Streaming)  TCP-Based (for example, www, e-mail, chat, ftp, p2p file sharing,                                 progressive video, and so on) |
|          79 | V2X Messages                                                                                                                                                                       |
|          80 | Low Latency eMBB Applications, Augmented Reality                                                                                                                                   |
|          82 | Discrete Automation                                                                                                                                                                |
|          83 | Discrete Automation                                                                                                                                                                |
|          84 | Intelligent Transport                                                                                                                                                              |
|          85 | Electricity Distribution                                                                                                                                                           |

In both EN-DC and NR SA downlink carrier aggregation over the E5 interface, QoS

priorities are not transferred across

the

partner cells. However, the NR QoS-Aware Downlink Carrier Aggregation feature allows the

prioritization

of

external traffic that is sent from an SpCell to an external SCell

over the E5 interface in an Advanced RAN Coordination deployment. The external SpCell

traffic can be prioritized relative to the local traffic in the external SCell. For more

information, see NR QoS-Aware Downlink Carrier Aggregation.

## 1.12 RAN Transport Sharing

This functionality provides the operator with information on how to configure a shared access

transport network for the following services:

- GSM
- CDMA
- WCDMA
- LTE

Sharing the transport infrastructure facilitates the reduction of the total transport

capacity a particular Radio Base Station (RBS) site requires. Shared transport occurs through

an IP over Ethernet connection.

This solution is based on the DSCP. The IP network between the following entities must be

QoS-enabled on a DSCP-basis:

- RBS site and Base Station Controller (BSC)
- Radio Network Controller (RNC)
- Serving Gateway (SG) or Mobility Management Entity (MME) site

If the bandwidth is congested, feature recommendations ensure that voice services are given

priority. For example, bandwidth congestion can occur because voice and data services require

more bandwidth than is available.

The following behavior is observable when the network is correctly dimensioned and is

configured according to RAN Transport and Sharing:

- Synchronization and highly prioritized signaling packets are prioritized to achieve the following benefits: Lowest possible delay Least possible jitter Low packet loss rate
- Generally, signaling is prioritized to achieve low packet loss rate. This facilitates resilient system behavior if transport capacity decreases severely.
- Speech and data services have sufficient bandwidth, up to the dimensioned peak use. Low delay and jitter can be expected.
- The bandwidth not used by the previously mentioned traffic types is available for packet service. Attempts to overload the network result in packet loss. The elastic behavior of these services allow them to adapt to the variable bandwidth and provide users with the best possible quality. If congestion occurs, the packets are dropped in reverse order. That is, the order of providing services is the following: Packet services Speech or data services Signaling Synchronization or high-priority signaling

The core of the network sharing functionality is shown in Table 7.

Table 7   Ericsson Recommended Three to Six Queue QoS Mappings and

Settings for Transport Sharing

| Mobile Traffic QoS   | Mobile Traffic QoS                                   | Mobile Traffic QoS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Mobile Traffic QoS   | Mobile Traffic QoS   | Mobile Traffic QoS   | Recommended Queue Mappings                       | Recommended Queue Mappings                       | Recommended Queue Mappings                       |
|----------------------|------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------|----------------------|----------------------|--------------------------------------------------|--------------------------------------------------|--------------------------------------------------|
| Class of Service     | Application/Service                                  | Examples                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | PHB                  | DSCP                 | P-Bit                | 6 Queues Recommended                             | 4 Queues                                         | 3 Queues                                         |
| 1                    | Synchronization                                      | Network frequency or phase synchronization: GSM, WCDMA, LTE, CES termination                 devices, and so on.                                                                                                                                                                                                                                                                                                                                                                                                                  | LU                   | 54                   | 7                    | Q1                                               | Q1                                               | Q1                                               |
| 1                    | Radio Network Control                                | WCDMA: FACH1,2, RACH, PCH, MBMS, FACH, GSM: OML, RSL, STN_L2TP_CP, and so on.                                                                                                                                                                                                                                                                                                                                                                                                                                                     | LU                   | 51                   | 7                    | Q1                                               | Q1                                               | Q1                                               |
| 2                    | Transport Network Control                            | IP Routing: BGP, OSPF, IS-IS, NTP ToD, L2 resilience, ICMP, and so on.  CDMA or EVDO Network Control: ICMP including pings and ICMP traceroute, RIP and SNTP, Topology                 manager, Secure HTTP, SNMP, and Reliable Notification Channel.                                                                                                                                                                                                                                                                             | CS6                  | 48                   | 6                    | Q2                                               | Q2                                               | Q1                                               |
| 2                    | Signaling                                            | Radio network control: SRB/RRC, NBAP, RNSAP, RANAP, S1AP/X2AP, CDMA Abis signaling                 & RAN Datagram, A11, A12, A13, HRPD Signaling, DoS Messaging, and so on.   Core network control: MAP, SIP-I, GTP-C, GTP', DIAMETER, RADIUS, DNS for APN resolution and MSS, LDAP, and so on.   UE application signaling, QCI5 = Interactive/THP1+signaling ind, CDMA User Delay-sensitive                 application signaling over forward link traffic channels.                                                            | CS5                  | 40                   | 6                    | Q2                                               | Q2                                               | Q1                                               |
| 2                    | O&M High Priority                                    | O&M configuration management.   SNMP traps regarding alarms.  DNS  LDAP  CMPv2                                                                                                                                                                                                                                                                                                                                                                                                                                                    | CS4                  | 32                   | 6                    | Q2                                               | Q2                                               | Q1                                               |
| 3                    | Voice                                                | Voice: QCI1 = PS conversation or speech,   CS conversational/speech on A, Abis, lu, lub, lur, CDMA/1xRTT Voice + Data, Voice and Data                 Signaling, CDMA or EVDO Delay-Sensitive-1.  Voice and Signaling CDMA or EVDO RTC Low Latency: Delay-sensitive user traffic and application                 signaling over reverse link traffic channels.                                                                                                                                                                    | EF                   | 46                   | 5                    | Q3                                               | Q2                                               | Q1                                               |
| 3                    | Video/Gaming/GBR                                     | Real-Time Gaming: QCI3 = PS conversational or unknown, CDMA or EVDO                 Delay-Sensitive-2: Second priority delay-sensitive user traffic over forward traffic                 channels.                                                                                                                                                                                                                                                                                                                                | AF41                 | 34                   | 5                    | Q3                                               | Q2                                               | Q1                                               |
| 3                    | Video/Gaming/GBR                                     | Live Streaming: QCI2 = PS conversational/unknown.   GBR Traffic CDMA/EVDO Delay-Sensitive-3: Third priority delay-sensitive user traffic over forward                 traffic channels, CDMA/EVDO User Rate-Sensitive-1: Rate-sensitive user traffic over                 forward traffic channels.                                                                                                                                                                                                                               | AF42                 | 36                   | 5                    | Q3                                               | Q2                                               | Q1                                               |
| 3                    | Video/Gaming/GBR                                     | Video streaming: QCI4 = PS Streaming/unknown.   GBR Traffic CDMA or EVDO Delay-Sensitive-4: Low priority delay-sensitive user traffic over                 forward traffic channels, CDMA or EVDO User Rate-Sensitive-2: Low-priority                 rate-sensitive user traffic over forward traffic channels.   CDMA/EVDO RTC High Capacity: Rate-sensitive and best effort user traffic over reverse link                 traffic channels. Separation of best effort and GBR uplink traffic is not                 possible. | AF43                 | 38                   | 5                    | Q3                                               | Q2                                               | Q1                                               |
| 4                    | Non-GBR Data Priority                                | PS traffic for priority users only: QCI6 = Interactive or THP1                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | AF31                 | 26                   | 4                    | Q4                                               | Q3                                               | Q2                                               |
| 4                    | Non-GBR Data Priority                                | Undifferentiated PS traffic: Interactive or THP2 + THP3 and Background THP4 in WCDMA or DCH on lub/lur, all PS traffic in GSM on Abis and Gb.                                                                                                                                                                                                                                                                                                                                                                                     | AF32                 | 28                   | 4                    | Q4                                               | Q3                                               | Q2                                               |
| 4                    | O&M Undifferentiated                                 | O&M high and low priority if separation is not possible. This includes all                 WCDMA O&M traffic.                                                                                                                                                                                                                                                                                                                                                                                                                     | CS2                  | 16                   | 4                    | Q4                                               | Q3                                               | Q2                                               |
| 4                    | O&M Low Priority                                     | TCU: O&M Bulk, CUDB replication, FTP charging low priority.  CDMA or EVDO Low-Priority OAM: Secure remote logon (SSH), secure software download, and logs                 upload (SFTP), and data collection upload.                                                                                                                                                                                                                                                                                                              | CS1                  | 8                    | 4                    | Q4                                               | Q3                                               | Q2                                               |
| 5                    | Non-GBR Data (HSPA on lub/lur OR CDMA/EVDO BE)       | PS traffic: Interactive/THP2 in WCDMA/HSPA on lub/lur or   CDMA or EVDO User Best Effort-1: Inter-User Best effort 1 user traffic over forward traffic channels.                                                                                                                                                                                                                                                                                                                                                                  | AF21                 | 18                   | 3                    | Q5                                               | Q3                                               | Q2                                               |
| 5                    | Non-GBR Data (HSPA on lub/lur OR CDMA/EVDO BE)       | PS traffic: Interactive or THP3 in WCDMA/HSPA onlub/lur, or   CDMA/EVDO User Best Effort-6: Inter-User Best Effort 6 user traffic over forward traffic channels.                                                                                                                                                                                                                                                                                                                                                                  | AF22                 | 20                   | 3                    | Q5                                               | Q3                                               | Q2                                               |
| 5                    | Non-GBR Data (HSPA on lub/lur OR CDMA/EVDO BE)       | PS traffic: Background THP4 in WCDMA or HSPA on lub/lur or   CDMA or EVDO User Best Effort-5: Inter-User Best Effort 5 user traffic over forward traffic channels.                                                                                                                                                                                                                                                                                                                                                                | AF23                 | 22                   | 3                    | Q5                                               | Q3                                               | Q2                                               |
| 6                    | Non-GBR Data (all PS traffic except HSPA on lub/lur) | PS traffic: QCI7 = Interactive or THP2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | AF11                 | 10                   | 2                    | Q6                                               | Q4                                               | Q3                                               |
| 6                    | Non-GBR Data (all PS traffic except HSPA on lub/lur) | PS traffic: QCI8 = Interactive or THP3.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | AF12                 | 12                   | 2                    | Q6                                               | Q4                                               | Q3                                               |
| 6                    | Non-GBR Data (all PS traffic except HSPA on lub/lur) | PS traffic: QCI9 = Background THP4.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | AF13                 | 14                   | 2                    | Q6                                               | Q4                                               | Q3                                               |
| 7                    | Other Types of Traffic                               | IMS self-provisioning, service network access, and so on.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | BE/CS0               | 0                    | 1                    | Additional queues    Up to eight queues in total | Additional queues    Up to eight queues in total | Additional queues    Up to eight queues in total |

## 1.13 Managed Object Model Overview

Figure 1   Applicable Managed Object Classes

The QoS area represents a subset of the MOM. For information about all applicable MO classes,

see Managed Object Model (MOM).

## 1.14 QueueSystem MO

The QueueSystem MO is the root MO class of the Ethernet QoS support. It

enables the creation of instances of the other MO classes.

All QoS MOs for an Ethernet interface are located under an EthernetPort MO

instance.

## 1.15 Subsidiary MOs to QueueSystem MO

A queue system hierarchy consists of the following three building blocks:

- Queues
- Shapers
- Schedulers

A queue is a leaf MO. It cannot contain any other MOs. The following two queue MO classes are

available:

- QueueTailDrop
- QueueRed

A shaper is a node MO and must contain other MOs. A shaper can contain the following

instances:

- Queue instances
- Shaper instances
- Scheduler instances

A scheduler is a node MO and must contain other MOs. A scheduler can contain the following

instances:

- Queue instances
- Shaper instances

The following two scheduler MO classes are available:

- SchedulerSp
- SchedulerDwrr

A QoSClassifier is a node MO. It must contain at least one

PcpToQueueMap MO. It can also contain an additional

PcpToQueueMap MO, or a DscpToPcpMap MO.

Shaper

The Shaper MO class controls the egress bit rate.

The Shaper.committedInformationRate attribute sets the maximum average

rate defined by the traffic shaper on the egress direction of the interface. The supported

value range is zero, or a value from 1000 through 100,000,000 kbps. If the value is zero,

there is no rate limit. In this case, the shaper attempts to use the full bandwidth of the

interface. If the value is non-zero, the shaper limits the long-term average output rate of

the interface to this maximum average rate. This applies on condition that the configured

value is less than the speed of the physical interface.

The Shaper.committedBurstSize attribute specifies the maximum burst size

in bytes. The value applies on the following conditions:

- The burst set is sent in the egress direction of the interface.
- The long-term average rate can be kept within the range set by the Shaper.committedInformationRate attribute.

The shaper allows bursting 4,000 bytes even if the

Shaper.committedBurstSize attribute is set to less than 4,000

bytes.

The shaper allows bursting a maximum of 64,000 bytes even if the

Shaper.committedBurstSize attribute is set to more than 64,000

bytes.

The shaper allows sending 1,000 kbps even if the

Shaper.committedInformationRate attribute is set to less than 1,000

kbps. This is only applicable for Baseband units with a port capacity of 25 Gbps and for

BB6621 and BB6631 units with port capacity of 10 Gbps.

SchedulerSP

A scheduler is a constructor that selects what is transmitted. The

SchedulerSp MO class is the simplest type of scheduler. It observes its

sources from a priority perspective, and selects the source with precedence. The

SchedulerSp MO is based on the priority of queues. Packets in the

high-priority queue always transmit first. Packets in the low-priority queue do not transmit

until all the high-priority queues become empty.

This MO does not include configurable attributes. However, it applies the

SchedulerSp.order attribute on its children to determine priority.

For this reason, source starvation is one of the challenges for this scheduler type.

SchedulerDWRR

DWRR is another scheduler construction. It gives all its sources opportunity to transmit.

Source starvation is avoided at the cost of dropping high-priority packets.

The key attribute of this MO is SchedulerDwrr.schedulingWeight. The

attribute is an array, and the number of its values must equal the number of its children.

It measures if a child is allowed to transmit. It regards weight as a factor of probable

transmission. The chance of success is determined by the own weight of the child divided by

the sum of all weights.

Operators need to configure weights as small as possible. For example, a 1:2:3 traffic

distribution is desired when traffic is excessive on all queues. In this case, configure the

weights to [1, 2, 3] instead of [10, 20, 30]. It is also possible to set a relatively high

weight on a queue to prioritize the queue sufficiently. For example, if weights are

configured [1, 9, 990], the third queue is guaranteed 99% of the

SchedulerDwrr bandwidth when congestion occurs.

The SchedulerDwrr.schedulingWeight attribute can accept values from

1 up to 1000. For precise scheduling behavior it is

recommended to use weight values up to a maximum of 200. This

recommendation is only applicable for Baseband units with a port capacity of 25 Gbps and for

BB6621 and BB6631 units with port capacity of 10 Gbps.

QueueTailDrop

The QueueTailDrop construction is the simplest queue. It drops frames

when it is full. However, if the source has a disruptive transmission pattern,

QueueTailDrop can be problematic.

The key attribute of this MO is QueueTailDrop.queueSize. Its value range

is between zero and 250 MB. However, when the queue size is set to a value of less than 20

kB (20,000), the actual queue size is 20 kB.

When a package arrives at the queue, the counters

QueueTailDrop.queueHCInOctets and

QueueTailDrop.queueHCInPkts are increased. If there is not enough

available memory in the queue, the packet is dropped and the counter

QueueTailDrop.queueHCDroppedOctets is incremented. When a packet is

taken from the queue to be sent out on the link, the counters

QueueTailDrop.queueHCOutOctets and

QueueTailDrop.queueHCOutPkts are incremented.

The counters QueueTailDrop.filledLowerThreshold and

QueueTailDrop.filledUpperTreshold give information about how often the

queue is refilled. Refilling occurs to 20%, respective 80%, in the last ROP interval.

Samples are taken 1000 each ROP.

QueueRed

The QueueRed construction addresses the abrupt dropping caused by the

tail drop behavior. It also introduces a grace period during which packets are still queued.

That is, in the grace period packets are still let through, although the queue started to

drop packets.

The key attributes of this MO are the following:

- QueueRed.queueSize
- QueueRed.minThreshold
- QueueRed.maxThreshold

The QueueRed.minThreshold attribute defines when the queue starts

dropping frames with low probability. The QueueRed.maxThreshold attribute

defines when the queue starts dropping frames with 100% probability, that is, all

frames.

The value range for QueueRed.queueSize is between zero and 250 MB.

However, when the setting for queue size is set to a value of less than 20 kB (20,000), the

actual queue size is 20 kB.

The operator is recommended to define QueueRed.maxThreshold to 100

percent and QueueRed.minThreshold to 30 percent.

The weight factor QueueRed.exponentWeight attribute is used when

calculating the average queue length. It is represented by the parameter n in the following formula:

drop probability = old\_average\_queue\_length * (1 - 2-n) +

current\_queue\_length * 2-n

The averaging weight factor controls the sensitivity to bursts and rapid changes in the

current queue length. The averaging weight factor can be set too high. This causes the

average queue length to respond too slowly to changes in the current queue size. In this

way, the queue cannot react to congestion. The averaging weight factor can also be set too

low. It causes the average queue length to respond too fast to changes in the actual queue

size. In such cases, the queue overreacts bursts and drops packets unnecessarily. The

default value is set to eight.

The egress bandwidth and the average frame size influence the choice of the attribute

value.

When a packet arrives at the queue, the counters

QueueRed.queueHCInOctets and QueueRed.queueHCInPkts

are increased. If the packets are dropped, the counter

QueueRed.queueHCDroppedOctets is incremented. When a packet is taken

from the queue to be sent out on the link, the counters

QueueRed.queueHCOutOctets and

QueueRed.queueHCOutPkts are incremented.

The counters QueueRed.filledLowerThreshold and

QueueRed.filledUpperTreshold give information about how often the queue

is filled. Filling occurs to 20%, respective 80%, in the last ROP interval. Samples are

taken 1000 each ROP.

QoSClassifier

The QoSClassifier is a root MO that contains the following child

MOs:

- PcpToQueueMaps (mandatory)
- DscpToPcpMap (optional)

PcpToQueueMap

The PcpToQueueMap is a mandatory MO. Together with the child MO

PcpSetToQueue, it defines what types of traffic the queues can be used

for in the queue system hierarchy. The PcpToQueueMap.defaultQueue

attribute specifies the queue used for PCP values not defined in the child

PcpSetToQueue MOs. If only one PcpToQueueMap MO

exists, that is used for all VlanPorts within the EthernetPort. Several

PcpToQueueMap MOs can be used for different mappings, depending on the

VlanPort. If different PcpToQueueMap MOs are used, the map for a specific

EthernetPort or VlanPort is defined in the argument PcpToQueueMap in the

respective MOs.

PcpSetToQueue

The PcpSetToQueue.pcpSet attribute specifies which PCP value is used for

a given queue.

DscpToPcpMap

The DscpToPcpMap MO is optional. It can be used together with the child

MO DscpSetToPcp to specify marking from PCP values based on DSCP values.

The DscpToPcpMap.defaultPcp attribute specifies the PCP value used for

DSCP values unspecified in the child DscpSetToPcp MOs. When the

DscpToPcpMap is mapped to the EthernetPort, it

overwrites the mapping used on an

InterfaceIPv4

or InterfaceIPv6 level.

DscpSetToPcp

The DscpSetToPcp.dscpSet attribute defines the dscp

values that are mapped to the value defined in attribute

DscpSetToPcp.pcp.

EthernetPort and VlanPort

The EthernetPort MO represents an Ethernet interface on the node. The

EthernetPort MO refers to the TnPort MO in the

equipment view. The TnPort MO identifies the used physical connector. The

VlanPort MO represents a single connection toward a VLAN on a specific

EthernetPort.

## 1.16 QoS Profiles: PCP to PCP Maps

PCP to PCP maps are associated with the EthernetPort or

VlanPort MOs through the

EthernetPort.IngressQoSMarking or the

VlanPort.IngressQoSMarking attribute. QoSProfiles is

the parent MO and is denoted as the ingress QoS marker for the PcpPcpMap

MO.

If no PcpPcpMap MO instance is defined for an

EthernetPort or VlanPort MO, ingress remarking does

not occur. This is the default configuration.

PCP to PCP Maps make it possible to change frames from one QoS domain to the PCP-marking of

another QoS domain. For example, it is possible that a node is not capable of VLAN tagging. In

such cases, PCP to PCP Maps can be used to remark traffic from the node.

## 1.17 QoS Profiles: DSCP to PCP Maps

DSCP to PCP maps are associated with IP interfaces through the

InterfaceIPv4.EgressQoSMarking or the

InterfaceIPv6.EgressQoSMarking attributes. QoSProfiles

is the parent MO and is denoted as the egress QoS marker for the DscpPcpMap

MO. DSCP to PCP is to be mapped in this way for routed and terminated traffic.

It is possible that no DscpPcpMap MO instance is defined for an IPv4 or

IPv6 interface. In such cases, the IP interface uses the default DSCP to PCP map. For further

reference, see Table 3.

It is also possible to use the DscpPcp MO under Ethernet ports. The

QoSClassifier MO is the parent to the DSCP to PCP maps contained under

Ethernet ports. DSCP to PCP maps are denoted to the DscpToPcPMaps MO. When

the DscpToPcpMap MO is used under Ethernet ports, it overrides the map

associated with the IP interface.

For more information about transport sharing, see RAN Transport Sharing.

## 1.18 QoS Profiles: DSCP to DSCP Maps

DSCP to DSCP maps can be associated with the following MOs:

- EthernetPort
- VlanPort
- InterfaceIPv4 (through the InterfaceIPv4.IngressQoSMarking attribute)
- InterfaceIPv6 (through the InterfaceIPv6.IngressQoSMarking attribute)

QoSProfiles is the parent MO, denoted as the ingress QoS marker

for the DscpDscpMap MO.

It is possible that no DscpDscpMap MO instance is defined for the

following MO instances:

- EthernetPort
- VlanPort
- InterfaceIPv4
- InterfaceIPv6

In such cases, ingress marking does not occur. This is the default

configuration.

DSCP to DSCP maps make it possible to change frames from one QoS domain to the

DSCP-marking of another QoS domain.

# 2 Procedures

## 2.1 Configuration Overview

The configuration of a queue system involves the following aspects:

- Flow configuration, including schedulers, shapers, and queues.
- Utilization configuration, including maps from DSCP to PCP, and maps from PCP to queues.

The two aspects are closely related. The configuration process is often iterative. The

operator begins with the simplest possible configuration. This is iterated until optimal

traffic flow occurs in the entire network. Complexity is in the combination of traffic models

in all nodes, not in the single nodes themselves.

## 2.2 Flow Configuration

Optimal queue depth is a function of the following quantities:

- The amount of traffic for each time unit in bytes
- The maximum feasible queue delay

Too low queue depth value can cause packets to be dropped before reaching the available

transmission bandwidth. This results in disturbances or reduces system capacity. Too high

queue depth value can cause bandwidth contention and extensive queuing.

Some packets carry real-time data. As queuing substantially increases packet transfer delay,

such packets can be discarded as stale at their destination. In such cases, packets are to be

dropped in the router instead of maintaining a deep queue.

Configuration Management (CM) and software loading based on TCP/IP are examples for non

real-time communication. For non real-time communication, the buffer depth can be higher.

queueSize = max\_delay * bandwidth\_of\_queue / 8

max delay is the maximum delay allowed for traffic in the queue.

bandwidth of queue is the speed that traffic is expected to leave the queue

with. It can also be calculated using shaping rate and scheduling weights. In other cases it

needs to be estimated.

## 2.3 Utilization Configuration

Configuring the queue hierarchies is not enough. It is also important

to make sure that the correct traffic flows are put into the correct

queues. This is done with the DSCP to PCP map and the PCP to queue

map. Hence, to create a queue system, both the hierarchy and the PCP

to queue maps are mandatory.

## 2.4 How to configure a Queue System for an Ethernet Interface

The following attributes are required to make the necessary configurations:

- Shaping is configured with the Shaper.committedInformationRate attribute.
- Maximum burst size is configured with the Shaper.committedBurstSize attribute.

One instance of the QueueSystem MO must be created under an instance of

the EthernetPort MO to implement QoS on the Ethernet interface.

### 2.4.1 Configure the Smallest Possible Queue System

The configuration described in Table 8

deploys the smallest possible queue system. It serves as a suitable beginning for the

iterative process necessary to create a balanced queue system.

Table 8   Configure the Smallest Possible Queue System

| Step                                                                   | MO Class      | Specific Attribute Value                                                        |
|------------------------------------------------------------------------|---------------|---------------------------------------------------------------------------------|
| Navigate to                                                            | EthernetPort  |                                                                                 |
| Create MO instance under previous MO instance.                         | QueueSystem   |                                                                                 |
| Create MO instance under previous MO instance and set attribute value  | QueueTailDrop | queueSize sets the maximum queue length.                                        |
| Create MO instance under previous MO instance.                         | QoSClassifier |                                                                                 |
| Create MO instance under previous MO instance and set attribute value. | PcpToQueueMap | defaultQueue sets the first or only queue.                                      |
| Create MO instance under previous MO instance and set attribute value. | PcpSetToQueue | pcpSet sets the previously created                   QueueTailDrop MO instance. |

### 2.4.2 Basic Queue System

Figure 2   A MOM Class Hierarchy in an Example Queue System

If the QueueSystem MO instance is empty, no

PcpToQueueMap MO is defined. In such cases, a

PcpToQueueMap MO instance must be configured during the same transaction.

This configuration is necessary because it is not allowed to define a queue system that makes

the node unreachable. The configuration fails unless the QueueSystem MO is

properly configured.

Table 9   Configure Queues with Shaper and Scheduler

| Step                                                                   | MO Class     | Specific Attribute Value                                                   |
|------------------------------------------------------------------------|--------------|----------------------------------------------------------------------------|
| Navigate to.                                                           | EthernetPort |                                                                            |
| Create MO instance under previous MO instance.                         | QueueSystem  |                                                                            |
| Create MO instance under previous MO instance and set attribute value. | Shaper       | Set attribute committedBurstSize.  Set attribute committedInformationRate. |
| Create MO instance under previous MO instance.                         | SchedulerSp  |                                                                            |

Table 10   Create and Configure a Tail Drop queue

| Step                                                                   | MO Class      | Specific Attribute Value                       |
|------------------------------------------------------------------------|---------------|------------------------------------------------|
| Navigate to.                                                           | SchedulerSp   |                                                |
| Create MO instance under previous MO instance and set attribute value. | QueueTailDrop | Set attribute queueSize.                       |
| If more MO instances are created, set attribute value.                 | QueueTailDrop | Set attribute order.  Set attribute queueSize. |

Table 11   Configure a DWRR Queue

| Step                                                                    | MO Class      |                                                       |
|-------------------------------------------------------------------------|---------------|-------------------------------------------------------|
| Navigate to.                                                            | SchedulerSp   |                                                       |
| Create MO instance under previous MO instance, and set attribute value. | SchedulerDwrr | Set attribute order.  Set attribute schedulingWeight. |
| Create MO instances under previous MO instance, and set attribute value | QueueTailDrop | Set attribute queueSize.                              |
| If more MO instances are created, set attribute value.                  | QueueTailDrop | Set attribute order.  Set attribute queueSize.        |

### 2.4.3 Configure a PCP to Queue Map

Table 12   Configure a PCP to Queue Map

| Step                                                                   | MO Class      | Specific Attribute Value                                                                                                                              |
|------------------------------------------------------------------------|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| Navigate to.                                                           | EthernetPort  |                                                                                                                                                       |
| Create MO instance under previous MO instance.                         | QueueSystem   |                                                                                                                                                       |
| Create MO instance under previous MO instance.                         | QoSClassifier |                                                                                                                                                       |
| Create MO instance under previous MO instance and set attribute value. | PcpToQueueMap | Set attribute defaultQueue.                                                                                                                           |
| Create MO instance under previous MO instance and set attribute value. | PcpSetToQueue | Set attribute pcpSet.  Set attribute queue to the queue defined under the                   SchedulerSP or SchedulerDwrr MO                 instance. |

## 2.5 Configure a DSCP to PCP Map for an IP Interface

Figure 3   Overview of DSCP to PCP Maps for an IP Interface

To configure an IP interface, the DscpPcpMap MO instance must be

created. For further details, see DSCP to PCP Maps.

Table 13   Configure a DSCP to PCP Map for an IP Interface

| Step                                           | MO Class    | Specific Attribute Value                               |
|------------------------------------------------|-------------|--------------------------------------------------------|
| Navigate to.                                   | QosProfiles |                                                        |
| Create MO instance under previous MO instance. | DscpPcpMap  | Set attribute defaultPcp.  Set attribute pcp0 to pcp7. |

Table 14   Associate the DscpPcpMap MO with InterfaceIPv4 or InterfaceIPv6 MO instance

| Step         | MO Class                       | Specific Attribute Value        |
|--------------|--------------------------------|---------------------------------|
| Navigate to. | InterfaceIPv4 or InterfaceIPv6 | Set attribute EgressQoSMarking. |

Steps

- Note: Association with the looback interface is not available

## 2.6 Configure a DSCP to PCP Map for an Ethernet Port

Make sure that all egress traffic from an Ethernet port adheres to the IP RAN Transport DSCP

to PCP mapping.

Table 15   Configure a DSCP to PCP Map for an Ethernet Port

| Step                                                                   | MO Class      | Specific Attribute Value                   |
|------------------------------------------------------------------------|---------------|--------------------------------------------|
| Navigate to.                                                           | EthernetPort  |                                            |
| Create MO instance under previous MO instance.                         | QueueSystem   |                                            |
| Create MO instance under previous MO instance.                         | QoSClassifier |                                            |
| Create MO instance under previous MO instance and set attribute value. | DscpToPCPMap  | Set attribute defaultPcp.                  |
| Create MO instance under previous MO and set attribute value.(1)       | DscpSetToPCP  | Set attribute dscpSet.  Set attribute pcp. |

(1)

This step can be repeated depending on the number of created MO instances.

Table 16   Example Command File

![Image](../images/38_1553-LZA7016014_1Uen.BG/additional_3_CP.png)

## 2.7 Configure a PCP to PCP Map for an Ethernet Port or a VLAN Port

Figure 4   Overview of PCP to PCP Maps for an Ethernet or a VLAN Port MO

Make sure that all ingress traffic from an Ethernet port or VLAN port adheres to the QoS

domains PCP system.

To configure PCP to PCP Map for an Ethernet or VLAN port, see Table 17.

Table 17   Configure a PCP to PCP Map for an Ethernet Port or a VLAN Port

| Step                                           | MO Class                   | Specific Attribute Value                               |
|------------------------------------------------|----------------------------|--------------------------------------------------------|
| Navigate to.                                   | QosProfiles                |                                                        |
| Create MO instance under previous MO instance. | PcpPcpMap                  | Set attribute defaultPcp.  Set attribute pcp0 to pcp7. |
| Navigate to.                                   | EthernetPort or  VlanPort. | Set attribute ingressQosMarking.                       |

## 2.8 Configure a DSCP to DSCP Map for an Ethernet Port, VLAN Port, Interface IPv4, or Interface IPv6

Figure 5   Overview of the DSCP to DSCP Map for an Ethernet Port, VLAN Port, Interface IPv4,

or Interface IPv6 MO

Make sure that all ingress traffic to an Ethernet port, a VLAN port, Interface IPv4 or

Interface IPv6 adheres to the QoS domains DSCP system.

To configure a DSCP to DSCP map for an Ethernet port, VLAN port, InterfaceIPv4 or

InterfaceIPv6, see Table 18.

Table 18   Configure a DSCP to DSCP Map for an Ethernet Port or VLAN Port, Interface IPv4,

or Interface IPv6

| Step                                           | MO Class                                                                                    | Specific Attribute Value                                                                   |
|------------------------------------------------|---------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|
| Navigate to.                                   | QosProfiles                                                                                 |                                                                                            |
| Create MO instance under previous MO instance. | DscpDscpMap                                                                                 | Set attribute defaultDscp.  Set attribute dscp0 to                                 dscp63. |
| Navigate to.                                   | EthernetPort or  VlanPort,  InterfaceIPv4 or                                 InterfaceIPv6. | Set attribute ingressQosMarking.                                                           |

# 3 Troubleshoot QoS

## 3.1 Useful Troubleshooting Command

The following CLI command can be useful while troubleshooting the QoS configuration.

Table 19   Command Useful to Troubleshoot QoS

| Command                 | MO Class     | Description                                                                                                                                                                                                                                                                                                                      | Use                                                 |
|-------------------------|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
| show qos-system         | EthernetPort | This command displays the                                 following information:  The most relevant parts of the QoS configuration of the                                             current EthernetPort MO     The values of the ingress and drop counters of the                                             relevant queues | When inspecting or debugging the QoS configuration. |
| show qos-system details | EthernetPort | This command displays the following additional information besides                                 the information shown by the show gos-system                                     command:  Queue size in Bytes for each queue     PCP value associated with the queue                                                         | When inspecting or debugging the QoS configuration. |