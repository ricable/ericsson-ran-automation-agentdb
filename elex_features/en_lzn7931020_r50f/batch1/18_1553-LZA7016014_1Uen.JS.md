---
complexity_score: 30.0
converted_at: '2025-08-13T06:59:37.792630Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 2
images_saved: 3
original_path: 18_1553-LZA7016014_1Uen.JS.html
pictures_extracted: 2
processing_method: docling_multimodal
quality_score: 9.0
source_file: 18_1553-LZA7016014_1Uen.JS.html
source_zip: en_lzn7931020_r50f.zip
tables_extracted: 46
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 1244
---

# 

Manage Security

Baseband Radio Node

Contents

![Image](../images/18_1553-LZA7016014_1Uen.JS/additional_3_CP.png)

![Image](../images/18_1553-LZA7016014_1Uen.JS/additional_3_CP.png)

- Description
    - Certificates on the Node
    - Initial Start Conditions
    - Operation and Maintenance
    - Software Validation
    - Security Logging
    - Anti-Rollback
    - Trusted NTP Server
    - Minimization of Drive Tests
    - Port Scanning Detection and Logging
    - Radio Equipment Authentication
    - Theft Deterrence
- Procedures
    - Manage Trusted Certificates
    - Enroll Node Credentials
    - Configure Simple Network Management Protocol
    - Configure Cipher Suites and Elliptic Curves for TLS and SSH
    - Enable Signature Validation Service
    - Configure Trusted NTP Server
    - Configure Board Restore Button on Emergency Access GUI
    - Configure Real-Time Security Event Logging
    - Encrypt Keys and Client Passwords
- Privacy Functionality
    - Personal Data
    - Ericsson Support Information Package
    - Privacy Implications of LTE Minimization of Drive Tests
    - Privacy Implications of NR Minimization of Drive Tests
    - Privacy Implication of Port Mirroring
    - Privacy Implications of Packet Capture
    - Privacy Functionality for Enhanced Cell ID in Traces
    - Privacy Functionality for Streaming Features
    - Privacy Implications of OTDOA PRS Management
    - Privacy Functionality for OTDOA Control Plane Location Support
    - Privacy Implications of OTDOA User Plane Location Support
    - Privacy Implications of Inter-Frequency OTDOA
    - Privacy Functionality for Enhanced Cell ID Control Plane Location Support
    - Privacy Functionality for Enhanced Cell ID User Plane Location Support
    - Privacy Implications of Cell ID-Based Location Support
    - Privacy Functionality for LPPa-based E-CID Support
    - Privacy Implications of LPPa-based OTDOA Support
    - Privacy Implications for A-GPS Control Plane Location Support
    - Privacy Functionality for A-GPS User Plane Location Support
    - Privacy Implications of Category M Enhanced Cell ID Location Support
    - Privacy Implications of Anonymization of Data in eNodeB
    - Privacy Implications of Anonymization of Data in gNodeB
    - Privacy Implications of RDS Location Support
    - Privacy Implications of Shared RAN Features
    - Privacy Implications of Basic AAS for TDD
    - Privacy Implications of NB-IoT Enhanced Cell ID Location Support
    - Privacy Implications of Location Support
    - Privacy Implications of NR Advanced UE Location Support
    - Privacy Implications of High-Resolution Timing Advance for Macro Positioning
    - Privacy Implications of Uplink Angle of Arrival for Macro Positioning
    - Privacy Implications of Macro Positioning Information in Traces
    - Privacy Implications of Periodic Measurements for Macro Positioning

# 1 Description

## 1.1 Certificates on the Node

The node relies on asymmetric cryptography and digital signatures to authenticate communicating

peers, and to ensure communication confidentiality and integrity. Certificates and trust

relationships ordered in a PKI system are required to ensure the correctness and

validity of the keys used. The PKI system can be embedded in the ENM, or can be

standalone for IPsec certificates. Standalone PKI systems do not need to be

connected to the ENM. It is possible to enroll multiple IPsec node certificates from

standalone PKI systems, and each can be enrolled from a different

PKI.

The following sets of keys and certificates must be present on the node:

Related concepts

Enroll Node Credentials

Manage Trusted Certificates

Related tasks

Create a Trust Category

## 1.2 Initial Start Conditions

Initial start or autointegration is done on site by Ericsson or by the operator. It has the

following prerequisites:

- The operator trusted certificates are installed by CMPv2 during enrollment of the Node Credentials.
- Node credentials and trusted certificates are needed if one or more of the following is to be used directly after integration: NETCONF LDAP by TLS IPsec Port-based authentication
- LDAP configuration is completed.
- Adding a full access maintenance user is recommended, and it is required if no O&amp;M user is defined.

Related concepts

Manage Trusted Certificates

Enroll Node Credentials

## 1.3 Operation and Maintenance

O&amp;M connections are possible by using Transport Network (TN), wired Local Maintenance

Terminal (LMT) port, and wireless LMT port.

O&amp;M connections are secured by TLS or SSH encryption.

Table 1   TLS and SSH Connections with Baseband Radio Node as a client

| Protocol   | Required Connectivity and Security Data                                                            |
|------------|----------------------------------------------------------------------------------------------------|
| TLS        | Trusted certificate to authenticate the server     Node credentials for O&M     TLS server address |
| SSH        | SSH username and password     SSH server address                                                   |

For information

on

the node acting as a TLS or SSH server, see Manage User Access.

For further information on security-related activities, see Security User Guide.

Related concepts

Configure Cipher Suites and Elliptic Curves for TLS and SSH

### 1.3.1 TN Port

The TN port has an Ethernet interface, used for transmission handling. Packet filtering is done

on the TN interfaces, see Manage Transport Network.

In order to access the O&amp;M services, an instance of the MO

OamAccessPoint must be configured.

For information on how to configure an O&amp;M access point, see Configure O&amp;M Access Point.

### 1.3.2 Wired LMT Port

The LMT port has an Ethernet interface, used for a locally connected terminal. The terminal

and ME must be on the same IP network.

The LMT Port Disabling (FAJ 121 5058) licensed feature can be used to disable the LMT port,

which is an effective way to prevent unauthorized access. Access can be restricted for TLS,

SSH, or other uses of the LocalAccess MO.

In case a Baseband Radio Node has the LMT Port Disabling feature activated, the LMT port must

be unlocked before the Baseband Radio Node is sent to the repair center.

LMT Cable Present Alarm

Because of the risk of potential unauthorized access associated with the LMT port, the

LMT Cable Present alarm can be enabled to signal if an

Ethernet cable is connected. This alarm does not reflect a faulty state. For more

information about the alarm, see LMT

Cable Present.

### 1.3.3 Wireless LMT Port

The wireless LMT port on RAN Compute units in RAN Compute group 6 supports the 2.4GHz

frequency band and acts as a Wi-Fi client to an external Wi-Fi access point. The Wi-Fi

client passively scans for a Wi-Fi access point to broadcast the known SSID

before it initiates the connection setup process.

Wi-Fi Service Activated Alarm

The Wi-Fi Service Activated alarm is raised to indicate

that Wi-Fi access is activated. This alarm is informational. It does not indicate a

fault. It notifies users that wireless access is enabled and a connection is

established. For more information on the alarm, see WiFi Service

Activated.

Wi-Fi Service Unavailable Alarm

The Wi-Fi Service Unavailable alarm is raised when the

Wi-Fi service cannot be established due to hardware or firmware faults, or a faulty

communication path between the central processing module and the Wi-Fi hardware

module. For more information

about

the alarm, see WiFi Service

Unavailable.

#### 1.3.3.1 Enable the Wi-Fi Client

The Wi-Fi client on the RAN Compute unit in RAN Compute group 6 is disabled by

default in Network Loader mode, and must be enabled manually before use. When

enabled, the Wi-Fi client attempts to connect to a Wi-Fi access point for up to 30

minutes before the interface is automatically disabled. Any type of board restart or

use of the wired LMT port automatically disables the Wi-Fi client.

Once the RAN Compute unit is integrated, the wireless LMT port can only be activated

through the MOM from the management system, and can no longer be activated locally

from site. For more information, see the WiFiAccessM MO

class                 description.

Required Tools and Equipment

- Access to site
- RAN Compute unit

Steps

1. Power on the RAN Compute unit.
2. Press the Maintenance button three times within 6 seconds.
3. Ensure that the Wi-Fi indicator flashes slowly.

### 1.3.4 Factory Data Reset Through Emergency Access

Emergency access can be used to delete all the data from the disk manually. The factory

data reset operation can only be performed if the Baseband Radio Node runs in Network

Loader mode on one of the following released software versions:

- 24.Q3 or later
- MTR24.35 or later

Network Loader mode can be accessed by performing a board restore procedure. For more

information on board restore, see Board Restore Through Emergency Access.

For more information on accessing the emergency access page, see Data Collection Guidelines.

For more information on upgrading the Network Loader, see Upgrade Network Loader.

When the factory data reset operation is started through emergency access, the operator

is redirected to the main Autointegration page where the start

and finish processes are stored in the autointegration log.

The factory data reset operation might take up to one hour to complete.

### 1.3.5 Emergency Access

Emergency Access is an interface used as a last resort to reach the node to fetch vital

Ericsson

Support Information (ESI) when O&amp;M access to the node is unavailable.

Emergency Access is available on site through the LMT port or from a remote Operation and

Maintenance Center (OMC) through a TN port.

Access to Emergency Access supports the following:

- HTTPS
- No client authentication. Server authentication is optional.

The ESI package is encrypted and contains logs and other data used by Ericsson to analyze any

problems with the node. The ESI package can only be sent to a server connected to the same

network the client requests the package for.

For example, an LMT user cannot order the ESI package for a server connected to the transport

network.

The following methods are available for Emergency Access:

- Through the Emergency Access GUI A web GUI shows the available options for the Emergency Access. For instructions on how to use Emergency Access to export the ESI package, see Data Collection Guideline.
- Through the Radio Node Portal For instructions on how to use the Radio Node Portal web page, see Radio Node Portal.

### 1.3.6 Board Restore Through Emergency Access

Emergency Access can also be used to manually reset the node to its initial state, using

the following elements:

- The physical Board Restore button on the outside of the board
- The Board Restore web GUI button

| Boards with a Board Restore button    |    | In case of boards which have a physical Board Restore button, the                             Board Restore web GUI button is disabled by                         default. It is recommended to initiate board restore by the physical Board                         Restore button. If the physical Board Restore button is difficult to access,                         the Board Restore web GUI button can be enabled by                         the LocalAccessM.EmergencyRestoreState attribute.   |
|---------------------------------------|----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                       |    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Boards without a Board Restore button |    | The Board Restore web GUI button is always enabled on                         boards that are not equipped with a physical Board Restore button.                                                                                                                                                                                                                                                                                                                                                         |

Related tasks

Configure Board Restore Button on Emergency Access GUI

### 1.3.7 Simple Network Management Protocol

Simple Network Management Protocol (SNMP) is used for alarm handling and notifications

for the ENM. There are two variants:

- SNMPv2C
- SNMPv3

It is recommended to use SNMPv3, with authentication and privacy, towards ENM to

improve security. SNMP configuration of the node is normally done and maintained by ENM.

For details about how to manually configure SNMP, see the description in the ENM

CPI.

Related concepts

Configure Simple Network Management Protocol

## 1.4 Software Validation

The basic feature Signed SW improves the software security on the node. The Signed SW feature

stops executable software that is not signed by Ericsson. The hardware in the node

supports Signed SW. The hardware has the trust anchor preinstalled, which only accepts

software that is signed with Ericsson certificates.

## 1.5 Security Logging

The following logs are used for security purpose:

- Security log
- Audit trail log
- EDR log

The logs may be exported to an SFTP of FTPES server through one of the following:

- Manually, as described in the Export Log MO Logs section of Manage Software
- Automatically transferred to an off-site file server when the log file exceeds the size limit, as bulk data, as described in Configure Push Log section of Manage Software

The feature Real-Time Security Event Logging (RTSEL) is used when the security, audit

trail and Endpoint Detection and Response (EDR) log events are streamed to the syslog

server. For more information about this feature, see the document Real-Time Security Event Logging. For a list of RTSEL

events, see the document Real-Time Security Event List.

The logs are read-only and cannot be altered from outside of the node. The node has

permanently turned off logging into the shell and only has the OAM interfaces. The logs

are read-write internally within the node.

Security events streamed through RTSEL follow the RFC5424 standard.

### 1.5.1 Security Log

The security log is a system log that stores events into a file.

The following security-related events are registered:

- Remote user logon attempts (successful and unsuccessful)
- Start and end time of access to the system
- Any failed X.509 certificate validation for a TLS link or an IPsec VPN connection
- Some other IPsec related events. See Manage IPsec for details
- Network Time Protocol (NTP) time of day adjustment
- Trusted NTP server events Authentication is enabled or disabled for the NTP server NTP authentication key changes NTP system peer authentication status changes
- A maintenance user is locked out
- Locked maintenance user is automatically unlocked
- Locked maintenance user unlocked by MO action
- Certificate management events Installation of node credential and trusted certificates CRL handling
- File access through SFTP or FTPES server
- Emergency Access operations
- EMGUI events

### 1.5.2 Audit Trail Log

The Audit Trail Log logs NETCONF and Ericsson CLI commands and MO operations entered on the

node. The Audit Trail Log presents the trail of each user for all the user interfaces except

for the EA interface, which is not part of the audit trail log.

The log is always activated and it cannot be switched off.

Actions and set operations are logged.

### 1.5.3 Endpoint Detection and Response Log

The EDR log captures the system call monitoring of Baseband Radio Nodes.

The log file and the corresponding Log MO are automatically created during system

startup. By setting the value of the FeatureState.featureState

attribute to ACTIVATED for the Integrated Endpoint Detection and

Response feature, the events of monitoring system call are formatted and written in to

the EDR log.

## 1.6 Anti-Rollback

The Anti-Rollback prevents rollbacks to Upgrade Packages (UPs) that are signed by a revoked

certificate. This is done by removing UPs and any associated backup from the system. For more

information, see Manage

Software.

## 1.7 Trusted NTP Server

A trusted NTP server enables authentication and integrity protection for ToD information

between the node and the NTP server.

The authentication uses pre-shared keys that are installed on the node and on the NTP

server to protect the NTP packet based on the algorithm. The node supports the

installation of multiple authentication keys to get ToD information from multiple

authenticated NTP servers.

Pre-shared key renewal requires manual synchronization on the node and on the NTP server

side, as NTPv4 (RFC 5905) does not provide the option to renew the keys

using the protocol.

When authentication is enabled, the node sends a MAC in the NTP request to the NTP server

and validates the MAC on response. If validation fails, timestamp of the rejected NTP

server is not used for node ToD.

Related tasks

Configure Trusted NTP Server

## 1.8 Minimization of Drive Tests

The Minimization of Drive Tests

(MDT)

functionality requires user consent.

The 3GPP-specified Minimization of Drive Tests functionality provides a simpler, cheaper,

and remote method to use for troubleshooting or verification of the radio network.

There are two RAN features that use the MDT standard:

- Minimization of Drive Tests (FAJ 121 4518)
- NR Minimization of Drive Tests (FAJ 121 5348 )

Measurements collected by NR Minimization of Drive Tests include data which is considered

personal. As such, due to privacy concerns and legal obligations, user consent is

required to use the feature. User consent is collected by the operator as part of a

customer care process. Once obtained, user consent information availability is stored as

part of the subscription data in the core network. (Ref: 3GPP TS 32.422). User consent

is signaled to RAN from the core when a UE session is first set up, or passed between

RAN nodes as part of handover.

For more information, see Minimization of Drive Tests and NR Minimization of Drive Tests.

## 1.9 Port Scanning Detection and Logging

The Port Scanning Detection and Logging feature analyzes UDP, TCP, and SCTP traffic. The

feature analyzes incoming traffic from different managed ports to identify and log

information on port scanning attacks. See Port Scanning Detection and Logging and Node Hardening Guidelines.

## 1.10 Radio Equipment Authentication

The radio equipment authenticates its peer using installed vendor credentials, when the

CPRI or eCPRI

control and management interface is set up.

A RAN Compute

unit

without vendor credentials can connect to the radio

unit

for backwards compatibility.

## 1.11 Theft Deterrence

The Theft Deterrence feature provides a capacity for the Baseband node to be locked to a

specific network of the operator. It becomes significantly harder to integrate the

Baseband node into other networks when the feature is activated. The usage of the

feature is to reduce the rate of theft of Baseband units.

If a Baseband node is sent to Ericsson for repair, the Theft Deterrence feature must be

deactivated. For more information, see Theft Deterrence.

# 2 Procedures

This section describes how to configure

security-related functions and traffic/IPsec.

## 2.1 Manage Trusted Certificates

The trusted certificates belong to MO TrustedCertificate.

### 2.1.1 Install a Trusted Certificate at Integration of the Node

For each trusted certificate, a new instance of MO TrustedCertificate is

needed.

To install a trusted certificate at integration of the node, initiate the

CertM.installTrustedCertFromUri action. The

uri and uriPassword parameters must be

empty and only the fingerprint is considered. When installing a trusted IPsec certificate, and a standalone

certificate server outside of the O&amp;M network is used, the

trustpointInterface parameter must be set. The

trustpointInterface parameter points to the interface used

for installing the IPsec certificate.

As a result, a new instance of MO TrustedCertificate is created. No

certificate is downloaded. A certificate that matches the provided fingerprint is

downloaded later.

### 2.1.2 Install a Trusted Certificate

Steps

1. Ensure that there is no other action in the RUNNING or in CANCELLING state reported by the state of attribute CertM.reportProgress.
2. Initiate action CertM.installTrustedCertFromUri (uri, uriPassword, fingerprint, trustpointInterface, moId). Examples of parameters required for installing a trusted certificate include TrustedCertificate.ManagedCertificateState. For more examples, see MO class TrustedCertificate. Note: The fingerprint is checked against the fingerprint calculated on the complete file to be installed. The trustpointInterface is an optional parameter of the CertM.installTrustedCertFromUri action, and only used for IPsec certificates. If the certificate server is not reachable through the O&amp;M network, the parameter must be set. Result: In case of successful installation, the certificate file is downloaded through SFTP, FTPES, HTTP, or HTTPS from the provided URI. A new TrustedCertficate MO is created. The TrustedCertificate.certificateContent is filled out from the installed certificate. The appropriate fields of attribute CertM.reportProgress are set to state FINISHED with result SUCCESS.If the action cannot be processed, the action returns FALSE. This can be due to, for example, an invalid URI or an ongoing parallel action on the CertM MO. If there was a problem during the execution of the action, the CertM.reportProgress is set to FINISHED with result FAILURE. The AsyncActionProgress.resultInfo attribute shows the cause of the failure. After installation, the trusted certificate is disabled and has to be enabled by default.

Related tasks

Enable a Trusted Certificate

### 2.1.3 Enable a Trusted Certificate

Steps

To enable a previously invalidated trusted certificate:

1. Set attribute managedState of respective MO TrustedCertificate to ENABLED.

Results

Manage state is set to ENABLED after receiving

TrustedCertificate MO.

### 2.1.4 Cancel the Ongoing Installation of a Trusted Certificate

If the installation of a trusted certificate does not finish, for example due to network connection problems, the operation can be canceled:

Steps

1. To verify if an installation of a trusted certificate is ongoing, verify if attribute reportProgress has state RUNNING.
2. To cancel the ongoing installation of a trusted certificate, initiate action cancel of MO CertM.

Results

After canceling an ongoing installation, the state of the

reportProgress attribute becomes CANCELED.

### 2.1.5 Invalidate a Trusted Certificate

Steps

To invalidate an installed trusted certificate:

1. Set attribute managedState of respective MO TrustedCertificate to DISABLED. Invalidation is reversible. The invalidated certificate may be enabled again at a later point.

Results

Manage state is set to DISABLED, after receiving

TrustedCertificate MO.

### 2.1.6 Remove a Trusted Certificate

To be able to remove an existing trusted certificate, the certificate must not be

referenced by any TrustCategory or any other MO. If it is, remove the

certificate from all MOs that reference it and then remove the trusted certificate from the

system.

Steps

To remove an installed trusted certificate:

1. Initiate action removeTrustedCert (TrustedCertificate trustedCert) of MO CertM.

Results

After Step 1 is completed, the

following results can occur:

- The trusted certificate MO is removed from the node.
- The trusted certificate MO is not populated.

### 2.1.7 Create a Trust Category

Steps

1. Create an MO TrustCategory. This has to be created before trusted certificates may be used. Trusted certificates can be grouped into the TrustCategory MO by specifying the number of instances of the TrustCategory.trustedCertificates attribute. This provides the possibility of using multiple certificate authorities simultaneously. Note: There is one exception: the EnrollmentAuthority.enrollmentCaCertificate attribute is used directly without a TrustCategory MO.
2. Verify if the default value of TrustCategory.crlCheck is set to DEACTIVATED. For each TrustCategory, there has to be a decision on whether to activate certificate revocation. The default value for attribute TrustCategory.crlCheck is DEACTIVATED. For TrustCategory.crlCheck to work, the following services must be in place: DNS is configured with the CRL-DP entries. CRLs are generated continuously by the PKI system. NTP time is used by the node. This makes it possible to check that all the services are in place before activating TrustCategory.crlCheck.
3. Activate TrustCategory.crlCheck as soon as possible, after all conditions are fulfilled. TrustCategory.crlCheck checks if certificates have been revoked, which leads to increased security. In case of IPsec certificates, with the TrustCategory.crlInterface attribute, it is possible to set the interface from which the CRL is fetched. If the CRL-DP is located outside of the O&amp;M network, the TrustCategory.crlInterface attribute has to be configured.

Results

The MO Trust Category is created, activated, and trust

certificates are added to the trust category.

## 2.2 Enroll Node Credentials

The creation of a valid node credential requires execution of a certificate enrollment

process. Certificate enrollment may be performed in several ways, depending on where the

key generation or key retrieval occurs. It depends on whether the enrollment is executed

in-band as online enrollment, or out-of-band as offline enrollment.

If standalone PKI/CA and external DHCP servers are configured in the customer's IPv4 or IPv6

network, IPsec Node Credentials are enrolled from standalone PKI/CA server during node

integration or replacement process.

Enrolled IPsec Node Credentials are used to establish temporary and permanent VPN tunnel with

the Security Gateway. During integration, the node establishes a connection towards a

trusted network over a temporary IPsec VPN tunnel. The node then downloads files

(configuration files, Upgrade Package and so on) that are needed to integrate or replace

the node located in untrusted IP network.

IPsec Node Credentials are automatically enrolled using online enrollment.

The following options are available for Node Credential Enrollment:

For more information, see the Ericsson Network Manager, ENM library.

Related tasks

Online Enrollment

CSR-Based Offline Enrollment

PKCS#12 Based Offline Enrollment

### 2.2.1 Online Enrollment

To start an online enrollment, do the following:

Steps

1. Create an instance of MO EnrollmentAuthority.
2. Configure one of the attributes EnrollmentAuthority.enrollmentCaFingerprint or enrollmentCaCertificate. If EnrollmentAuthority.enrollmentCaFingerprint is used, then the EnrollmentAuthority.enrollmentAuthorityName must also be configured. The EnrollmentAuthority.enrollmentCaFingerprint is mandatory if the EnrollmentAuthority.enrollmentCaCertificate is not used.
3. Create an instance of MO EnrollmentServerGroup that contains MO EnrollmentServer.
4. Configure the following attributes: EnrollmentServer.protocol EnrollmentServer.uri If an IPsec certificate is used, and the enrollment server is outside of the O&amp;M network: EnrollmentServer.enrollmentInterface
5. Create an instance of MO NodeCredential.
6. Specify the key type and length that is used for the next enrollment. To do this, configure attribute NodeCredential.keyInfo.
7. Specify the Distinguished Name (DN) of the Enrollment Server Group used for the online enrollment through attribute NodeCredential.enrollmentServerGroup.
8. Specify the DN of the Enrollment Authority used for the online enrollment through attribute NodeCredential.enrollmentAuthority.
9. Set attribute NodeCredential.subjectName.
10. If to be used for IPsec, set attribute NodeCredential.subjectAltName.
11. Set attribute NodeCredential.renewalMode. If renewalMode is set to Reaching the threshold triggers MANUAL Certificate Management the Certificate is to Expire alarm. AUTOMATIC Automatic renewal. If automatic renewal times out, the Certificate Management Automatic Enrollment Failed alarm is raised. To ensure the node availability after restart if the NodeCredential MO is defined, the initial enrollment is forced when the credentials are not present or incomplete regardless of whether the renewalMode attribute of the NodeCredential MO is set to MANUAL or AUTOMATIC.
12. Set attribute NodeCredential.expiryAlarmThreshold according to the renewal intervals decided by the operator.
13. Optionally, set a timer for the enrollment process to finish. If the set time elapses before the enrollment is finished, the enrollment fails. Configure the timer and set a value in minutes for attribute NodeCredential.enrollmentTimer. Note: It is not recommended to disable the timer when renewalMode is set to AUTOMATIC. This would impede automatic enrollment timeout, and cause no alarms to be raised until NodeCredential expires.
14. Specify the Domain Name Server (DNS) address in attribute DnsClient.serverAddress. It is used when the Certificate Revocation List (CRL) contains server information as a Fully Qualified Domain Name (FQDN).
15. Initiate action NodeCredential.startOnlineEnrollment.
16. If installation is successful, the NodeCredential.certificateContent is filled out from the installed certificate, TrustedCertificate MOs are created in the node, and the state field of the attribute NodeCredential.enrollmentProgress is set to FINISHED with result SUCCESS. The action returns FALSE if the node cannot process the invocation of the action. This can occur due to the following reasons: EnrollmentAuthority.enrollmentCaFingerprint or EnrollmentAuthority.enrollmentAuthorityName is invalid There is another parallel action ongoing on the same MO If there was a problem during the execution of the action, the state field of the attribute NodeCredential.enrollmentProgress is set to FINISHED and the result field set to FAILURE. The field resultInfo of the attribute NodeCredential.enrollmentProgress shows the cause of the failure.

Related concepts

O&amp;M and IPsec Parameters for Online Enrollment

### 2.2.2 Online Enrollment during Node Integration in Untrusted Network

When the node is located in untrusted network, the node needs to setup a temporary

IPsec tunnel to the Security Gateway. This is required to establish a connection to

services in the trusted network (AIWS, SMRS), where previously generated

configuration files are stored.

If Zero Touch Integration or replacement is used, the operator can configure the

external DHCP server with Enrollment data and PKI servers in the untrusted network.

Enrollment data can be specified via:

- DHCPv6 server for IPv6 transmission network
- DHCPv4 server, EGIS - for IPv4 transmission network

If DHCP or EGIS is not configured with Enrollment data, the node establishes an

IPsec VPN tunnel with Vendor Credentials.

If LMT Integration or replacement is applied for the node located in untrusted

network, where the operator configures standalone PKI server, Enrollment data are

specified on Site Installation File. The node automatically triggers IPsec Node

Credential Enrollment from standalone PKI server before establishing the IPsec VPN

tunnel to the Security Gateway.

For online Enrollment parameters, see O&amp;M and IPsec Parameters for Online Enrollment. For

information on parameters for online enrollment during integration or replacement,

see  Integration Planning and Infrastructure Guidelines.

The node will automatically enroll IPsec Node Credentials with Enrollment data

provisioned from DHCP server.

Steps

1. Power on the node. Note: If LMT Integration is used, use the Emergency Access WEB GUI to manually download the Site Installation File (SIF), which contains the Enrollment data.

Results

The node downloads the configuration files needed to complete the integration or

replacement procedure.

### 2.2.3 O&amp;M and IPsec Parameters for Online Enrollment

Table 2   O&amp;M and IPsec Parameters for Online Enrollment

| Moclass.attributename                       | O&M Example Values                                                                                      | IPsec Example Values                                                                                      | Comment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|---------------------------------------------|---------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| EnrollmentAuthority.enrollmentCaFingerprint | F2:0C:51:95:3C:EA:C4:24:63:9B:​B2:B8:64:1F:B5:9D:D7:1C:DA:09                                            | F2:0C:51:95:3C:EA:C4:24:63:9B:​B2:B8:64:1F:B5:9D:D7:1C:DA:09                                              | Give the fingerprint of COMInfRootCA. Choose the 								fingerprint algorithm as per the node 									CertMCapabilities MO. Use openssl utility to 								get the fingerprint of the CA. Example: /usr/sfw/bin/openssl 									x509 -in /opt/ericsson/csa/certs/COMInfRootCA.pem -text -noout 									-fingerprint -sha1 | grep SHA1                                                                                                                                                                                                                                            |
| EnrollmentAuthority.enrollmentAuthorityName | O=Ericsson,OU=ericssonOAM,CN=atclvm837NECertCA                                                          | O=Ericsson,CN=LTEIPSecNEcusRootCA                                                                         | Give the content of the Subject string, without leading or trailing 								spaces, from the <Hostname of the Admin 									server>NeCertCA (O&M) or 									LTEIPSecNEcusRootCA (IPsec). In this example, 								the hostname of the Admin server is <atclvm837>. 								Use openssl utility to get the subject of the CA.   Example O&M: /usr/sfw/bin/openssl x509 -in 									atclvm837NECertCA.pem -text | grep Subject  Example IPsec: /usr/sfw/bin/openssl x509 -in LTEIPSecNEcusRootCA.pem -text | grep Subject                                                          |
| EnrollmentServer.protocol                   | CMP                                                                                                     | CMP                                                                                                       | Give input as CMP for CMPv2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| EnrollmentServer.uri                        | http://<Infra Ip>:26772/cmp                                                                             | http://<Infra Ip>:26772/cmp                                                                               | Give input as the IP address of the Infra server in the uri. Same for 								O&M and IPsec.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| EnrollmentServer.enrollmentInterface        | Not applicable                                                                                          | ManagedElement=MSRBS76,Transport=1,Router=outer_vr,InterfaceIPv4=outer_if,AddressIPv4=outer_address       | Must be set if the enrollment server of the IPsec certificate is 								located outside of the O&M network.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| NodeCredential.keyInfo                      | ECDSA_SECP_256_R1                                                                                       | ECDSA_SECP_256_R1                                                                                         | Specify 								key type used for next node credentials enrollment based on operator 								requirements and enrollment server capacity.  For the value of the attribute, see MOM description.                                                                                                                                                                                                                                                                                                                                                                                      |
| NodeCredential.enrollmentServerGroup        | ManagedElement=MSRBS76,SystemFunctions=1,SecM=1,​CertM=1,EnrollmentServerGroup=oamEnrollmentServerGroup | ManagedElement=MSRBS76,SystemFunctions=1,SecM=1,​CertM=1,EnrollmentServerGroup=ipsecEnrollmentServerGroup | Give the reference of EnrollmentServerGroup 								MO.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| NodeCredential.enrollmentAuthority          | ManagedElement=MSRBS76,SystemFunctions=1,SecM=1,​CertM=1,EnrollmentAuthority=oamEnrollmentAuthority     | ManagedElement=MSRBS76,SystemFunctions=1,SecM=1,​CertM=1,EnrollmentAuthority=ipsecEnrollmentAuthority     | Give the reference of EnrollmentAuthority MO for 								O&M or IPsec.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| NodeCredential.subjectName                  | C=SE,O=Ericsson,​CN=MSRBS76-OAM                                                                         | C=SE,O=Ericsson,​CN=MSRBS76-IPSEC                                                                         | Give correct and unique Distinguished Name (DN).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| NodeCredential.subjectAltName               | Not needed for O&M.                                                                                     | MSRBS76-IPSEC.ericsson.se                                                                                 | Give correct and unique FQDN for IPsec according to this format: 									<UniqueLogicalName+suffix>.<company_name>.<country>.  This attribute must be set for IPsec, but not for O&M.                                                                                                                                                                                                                                                                                                                                                                                               |
| NodeCredential.renewalMode                  | AUTOMATIC                                                                                               | AUTOMATIC                                                                                                 | Give AUTOMATIC or MANUAL based on 							operator choice.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| CertM:installTrustedCertFromUri.fingerprint | F2:0C:51:95:3C:EA:C4:24:63:9B:​B2:B8:64:1F:B5:9D:D7:1C:DA:09                                            | 6B:FC:F8:6A:12:B8:65:DD:07:9B:​0A:48:EF:AE:C8:20:D8:6E:15:80                                              | Give the fingerprint of the Trusted certificate that is required to 								be installed and added to the Trusted Category dedicated for O&M 								or IPsec.  More than one Trusted Certificate may be installed for O&M or 								IPsec. Set this attribute for each Trusted Certificate.  Use openssl utility to get the fingerprint of the CA. The following 								path is valid for all OSS Trusted Certificates.  Example IPsec: /usr/sfw/bin/openssl x509 -in 									/opt/ericsson/csa/certs/LTEIPSecSEGRootCA.pem -text -noout 									-fingerprint -sha1 | grep SHA1 |

### 2.2.4 CSR-Based Offline Enrollment

The CSR-based offline enrollment is not to be performed at node integration.

To perform a CSR-based offline enrollment:

Steps

1. Create an instance of MO NodeCredential.
2. Set NodeCredential.subjectName attribute.
3. Set NodeCredential.keyInfo attribute.
4. Initiate action startOfflineCsrEnrollment of MO NodeCredential. This starts a manual enrollment procedure. For details about the parameters to be provided, see the MOM CPI section startOfflineCsrEnrollment. A CSR in the PKCS#10 format is created and sent to an SFTP or FTPES server.
5. The uploaded CSR file must be enrolled manually to become a complete certificate. The new certificate is placed on the SFTP or FTPES server for downloading.
6. Fetch the file enrolled at Step 2 from the SFTP, FTPES, HTTP, or HTTPS server by invoking action installCredentialFromUri of MO NodeCredential. For details about the parameters to be provided, see the description in the MOM CPI section installCredentialFromUri. If installation is successful, the certificateContent of MO NodeCredential is filled out on the basis of the installed certificate, and attribute enrollmentProgress is set to state FINISHED with result SUCCESS. The action returns FALSE if the node cannot process the invocation of the action. This may be due to reasons such as: Invalid URI provided The action is not supported based on the MO CertMCapabilities If there was a problem during the execution of the action, attribute enrollmentProgress is set to FINISHED with result FAILURE. The attribute resultInfo of AsyncActionProgress shows the cause of the failure.

### 2.2.5 PKCS#12 Based Offline Enrollment

To start an offline enrollment when the container file is in the PKCS#12

format:

Steps

1. Create an instance of MO NodeCredential.
2. Initiate action installCredentialFromUri of MO NodeCredential The file is fetched through SFTP, FTPES, HTTP, or HTTPS. For details about the parameters to be provided, see the description in the MOM description section installCredentialFromUri.

Results

If installation is successful, the attribute

NodeCredential.enrollmentProgress is activated.

## 2.3 Configure Simple Network Management Protocol

If a Baseband Radio Node is integrated using ENM Auto Provisioning, all the necessary SNMP

configuration is done automatically by ENM.

After configuration, the node has the following SNMP targets:

- Autointegration discovery messages and OAM IP change messages
- FM alarm handling

If a node with FM alarm supervision enabled is manually added in ENM , ENM automatically

creates the SNMP target on the node required for FM alarm handling.

To increase security, it is recommended to use SNMPv3 with authentication and privacy. For

details about configuration in ENM, see the description in the ENM CPI.

### 2.3.1 Configure SNMP

Steps

Configure the following MO attributes to enable sending alarms and to enable the

SNMP access. The following must be configured for the Snmp

MO:

1. Set Snmp.agentAddress to 0.0.0.0.
2. Set Snmp.administrativeState to UNLOCKED.

### 2.3.2 Configure SNMP Target for Autointegration Discovery Messages

Prerequisites

- Create the SnmpTargetV3 MO under the Snmp MO.
- Determine the SNMP configuration used for Auto Provisioning by ENM. For example, check the information used for another working node connected to ENM. Note the IP address of the ENM blade that handles Auto Provisioning and Configuration Management address.

Steps

- Configure SnmpTargetV3 by setting the following attributes: Attribute Configuration Instruction SnmpTargetV3.address Set the attribute to the IP address of the ENM blade that handles Auto Provisioning. SnmpTargetV3.port If the OamAccessPoint.accessPoint attribute of the OamAccessPoint=1 MO instance is set to an IPv4 address, set port to 162. If the OamAccessPoint.accessPoint attribute of the OamAccessPoint=1 MO instance is set to an IPv6 address, set the port value to 10162. SnmpTargetV3.transportMethod Set the attribute to INFORM. SnmpTargetV3.snmpSecurityLevel Set the attribute to AUTH\_PRIV. SnmpTargetV3.privKey Set the attribute to the private key from ENM. SnmpTargetV3.privProtocol Set the attribute to the value that matches the private protocol configuration on ENM. SnmpTargetV3.authKey Set the attribute to the authentication key from ENM. SnmpTargetV3.authProtocol Set the attribute to the value that matches the authentication protocol configuration on ENM. SnmpTargetV3.user Set the attribute to the user from ENM. SnmpTargetV3.administrativeState Set the attribute to UNLOCKED.

### 2.3.3 Configure SNMP Target for Alarm Handling

Prerequisites

Determine the SNMP configuration used for Alarm Handling by ENM. For example, it can be

determined by checking the information used for another working node connected to ENM. SNMP

configuration can be done automatically from ENM by enabling FM alarm supervision for the

node in ENM.

- SNMP version used for Fault Management in ENM: v2C or v3. SNMPv3 with AUTH\_PRIV is recommended to use towards ENM to improve security. If v2C is used, the community string is also needed from ENM. If v3 is used, the SnmpTargetV3.snmpSecurityLevel is also needed from ENM. The following information is also needed when the attribute has the value AUTH\_NO\_PRIV or AUTH\_PRIV: SnmpTargetV3.user SnmpTargetV3.authKey SnmpTargetV3.authProtocol SnmpTargetV3.privKey SnmpTargetV3.privProtocol
- IP address of the ENM blade that handles Fault Management.
- Port number for SNMP Fault Management used by ENM.
- SnmpTargetV2C.TransportMethod or SnmpTargetV3C.TransportMethod used for SNMP Fault Management by ENM.

To perform the following steps, SnmpTargetV2C MO has to be created under

Snmp MO.

Steps

1. Create an SnmpTargetV3 MO instance, or, if SNMPv3 is not supported in OSS, SnmpTargetV2C instance under the Snmp MO with ID=ENMFM.
2. Configure the created MO by setting the following attributes: Table 3 Attribute Configuration Instruction Attribute Configuration Instruction SnmpTargetV2C.address SnmpTargetV3.address Set the attribute to the IP address of the ENM blade that handles Fault Management. SnmpTargetV2C.port SnmpTargetV3.port Set the attribute to the port number to be used on the ENM blade that handles Fault Management. SnmpTargetV2C.transportMethod SnmpTargetV3.transportMethod Set attribute to the transport method used on the ENM blade that handles Fault Management. SnmpTargetV2C.community Set the attribute to the community string used on the ENM blade that handles Fault Management. SnmpTargetV3.snmpSecurityLevel Set the attribute to AUTH\_PRIV. SnmpTargetV3.privKey Set the attribute to the private key from ENM. SnmpTargetV3.privProtocol Set the attribute to the value that matches the private protocol configuration on ENM. SnmpTargetV3.authKey Set the attribute to the authentication key from ENM. SnmpTargetV3.authProtocol Set the attribute to the value that matches the authentication protocol configuration on ENM. SnmpTargetV3.user Set the attribute to the user from ENM. SnmpTargetV2C.administrativeState SnmpTargetV3.administrativeState Set the attribute to UNLOCKED.

## 2.4 Configure Cipher Suites and Elliptic Curves for TLS and SSH

The Cipher Suites Configurability function provides means to configure the cipher suites

used in the node in SSH- and TLS-based components. The feature is realized by two

system-created MO classes, Tls and Ssh, which reside under the MO class SecM.

To configure ciphers for

the SSH protocol, the operator selects ciphers from lists of available supported cipher

types. In the case of SSH protocol, the operator selects ciphers from lists of available

supported cipher types. In the case of TLS protocol, the operator

specifies a filter for the selection of cipher suites and a filter for the selection of

elliptic curves. The change is done in real time on the nodes.

The

configuration

in the Tls or Ssh MO classes affects all

components that use SSH or TLS protocols respectively. This means that a

change

affects all O&amp;M connections through SSH or TLS protocols. All long lived components

using these protocols are restarted after a change in

configuration.

### 2.4.1 Necessary Safety Considerations while Configuring Cipher Suites and Elliptic Curves

A configuration of cipher suites

and elliptic

curves can disrupt the server-client connectivity if used improperly.

The connection setup can fail if a common cipher cannot be found between an external

client and the node or when the node acts as a client accessing an external server.

Furthermore, if the operator accidentally resets the cipher

suites

configuration to a default configuration, it can weaken the network security. It is

therefore important to perform the

configuration in a controlled and careful way.

At least one cipher suite must be enabled at the end of the configuration. If the

operator's configuration request results in an empty list of enabled cipher suites, the

configuration service in the node rejects the configuration request. If a system upgrade

results in an 'empty-list' condition, the system reverts to the default setting.

### 2.4.2 Prevent Configuration Failure

Before configuring the cipher suites and elliptic curves, understand and apply the

following safety measures:

- Activate the BrmFailsafeBackup function before configuring for SSH or TLS. This prevents a potential OAM connectivity loss.
- Change only one protocol, SSH or TLS, at a time so that there is always connectivity to the node.
- Ensure that the configuration results in common cipher suites between servers and clients to avoid connection failures.

### 2.4.3 Transport Layer Security

#### 2.4.3.1 Operate the Cipher Suites Configurability for TLS

The

following cipher suites are supported for TLS 1.0 protocol:

- TLS\_ECDHE\_ECDSA\_WITH\_AES\_256\_CBC\_SHA
- TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA
- TLS\_ECDH\_ECDSA\_WITH\_AES\_256\_CBC\_SHA
- TLS\_ECDH\_RSA\_WITH\_AES\_256\_CBC\_SHA
- TLS\_ECDHE\_ECDSA\_WITH\_AES\_128\_CBC\_SHA
- TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA
- TLS\_ECDH\_ECDSA\_WITH\_AES\_128\_CBC\_SHA
- TLS\_ECDH\_RSA\_WITH\_AES\_128\_CBC\_SHA
- TLS\_DHE\_RSA\_WITH\_AES\_256\_CBC\_SHA
- TLS\_DHE\_DSS\_WITH\_AES\_256\_CBC\_SHA
- TLS\_DHE\_RSA\_WITH\_AES\_128\_CBC\_SHA
- TLS\_DHE\_DSS\_WITH\_AES\_128\_CBC\_SHA
- TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA
- TLS\_RSA\_WITH\_RC4\_128\_SHA
- TLS\_RSA\_WITH\_DES\_CBC\_SHA
- TLS\_RSA\_WITH\_RC4\_128\_MD5
- TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA

The supported protocols are listed in the Tls.supportedCiphers MO

attribute.

Table 4   Supported Cipher Suites for TLSv1.2 protocol

| Cipher Suites                                 |
|-----------------------------------------------|
| TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384       |
| TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384         |
| TLS_ECDHE_ECDSA_WITH_AES_256_CCM              |
| TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8            |
| TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384(1)    |
| TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384(1)      |
| TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 |
| TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256   |
| TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256       |
| TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256         |
| TLS_ECDHE_ECDSA_WITH_AES_128_CCM              |
| TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8            |
| TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256(1)    |
| TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256(1)      |
| TLS_DHE_RSA_WITH_AES_256_GCM_SHA384           |
| TLS_DHE_RSA_WITH_AES_256_CBC_SHA256(1)        |
| TLS_DHE_RSA_WITH_AES_128_GCM_SHA256           |
| TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256     |
| TLS_DHE_RSA_WITH_AES_128_CBC_SHA256(1)        |
| TLS_RSA_WITH_AES_128_CBC_SHA(1)               |

(1)

The CBC cipher suites are not enabled if the

DEFAULT setting is used in the

cipher filter.

The following cipher suites are supported for TLSv1.3 protocol:

- TLS\_AES\_256\_GCM\_SHA384
- TLS\_AES\_128\_GCM\_SHA256
- TLS\_CHACHA20\_POLY1305\_SHA256
- TLS\_AES\_128\_CCM\_SHA256
- TLS\_AES\_128\_CCM\_8\_SHA256

The TLS cipher list depends on the underlying crypto library, which can change on

short notice. Always check the name struct in the

Tls.supportedCiphers attribute on the node for an up-to-date

list.

For the ECDHE\_ECDSA or ECDHE\_RSA key exchange algorithms, the server generates

ephemeral keys when the connection is established. The ephemeral public key is then

signed with the private key (ECDSA or RSA) of the node credentials and exchanged to

the client.

The elliptic curve used for ephemeral key generation is chosen from curves supported

by the client. The list of supported elliptic curves is communicated through the

client hello extensions.

To modify the list of enabled cipher suites for TLS:

Steps

1. Check the list of supported cipher suites in attribute Tls.supportedCiphers.
2. Configure the Tls.cipherFilter attribute by using appropriate cipher strings. The TLS-based server components are restarted immediately upon completion of the configuration request. The changes are active for the TLS client usage directly after configuration, without any restart. The set operation on the Tls.cipherFilter attribute causes the specified filter to be applied on the list of supported ciphers. The resulting list of cipher suites is presented in the Tls.enabledCiphers attribute.
3. Verify that Tls.enabledCiphers attribute includes the new selected list of cipher suites.
4. Perform a connection test to verify that the resulting ciphers and TLS versions allow connections. This is done by requesting the system to perform a task involving the component. A new set operation on the Tls.cipherFilter attribute on TLS overrides the previous cipher configuration on TLS.

Related concepts

Rules for cipherFilter String

#### 2.4.3.2 Rules for cipherFilter String

The cipherFilter consists of one or several cipher strings, separated

by a colon, or if

the cipherFilter is empty, which means all supported ciphers are

enabled. This results in the following format: "&lt;cipher

string&gt;[:&lt;cipher

string&gt;]...[:&lt;cipher

string&gt;]".

The cipher strings are processed and evaluated from left to right. The order of the

cipher strings and the use of the colon set the cipher suites in the order in which the

cipher suites are displayed in the list.

The user can choose among supported cipher strings that are listed in the

Tls.supportedCiphers attribute.

The following keywords can be used in the Tls.cipherFilter attribute:

A logical AND operator '+' is used to combine cipher strings. For example, the string

RSA+SHA represents all cipher suites containing both the RSA and the SHA algorithms. The

following rules apply to the use of the '+' in cipher strings:

- The '+' character must be preceded by an algorithm.
- The '+' character cannot do the following: appear between two algorithms of the same type appear immediately after the ':' sign

Therefore, the following filters are not allowed:

ALL:+RSA,

+RSA

or

aECDSA+aRSA.

If a cipher string

after ':' is preceded by the characters '!' or '-', the filter becomes exclusive. This

means that if '!' is used, the corresponding ciphers are deleted from the list. The

deleted ciphers can never reappear in the configuration request, even if they are

explicitly included by an inclusive cipher string in the same filter. For example, the

filter ALL:!RSA represents all cipher suites except those cipher suites

containing RSA.

If '-' is used, the corresponding ciphers are deleted from the list. But some or all of

the ciphers can be added again by an inclusive cipher string, after the exclusive cipher

string, in the same

filter. For

example, the value of the Tls.cipherFiler attribute is

ALL:-TLSv1\_2:-TLS-AES-128-GCM-SHA256:+TLS-AES-128-GCM-SHA256, which

means the ALL:-TLSv1\_2:-TLS-AES-128-GCM-SHA256:+TLS-AES-128-GCM-SHA256

only includes cipher suites supported in TLS1.3 and move

TLS\_AES\_128\_GCM\_SHA256 cipher to the last in the list of cipher

suites for the TLSv1.3 protocol.

A filter must contain at least one inclusive cipher string; otherwise, the configuration

request is rejected. An inclusive cipher string can

be the keyword 'ALL', any cipher algorithm

string, or an

empty filter.

A cipher string can contain one or several full cipher suites. In those cases, the '-'

character can be used to combine a full cipher

suite,

and it is not used as an exclusive character. For example, the cipher string

DHE-RSA-AES-128-GCM represents the specific cipher

suite with the name

TLS\_DHE\_RSA\_WITH\_AES\_128\_GCM\_SHA256.

Use uppercase strings to specify cipher strings. Lowercase characters are reserved for

modifiers.

The following are the available modifiers:

- The 'k' modifier in front of a cipher string specifies that the cipher string applies only to the key exchange algorithm.
- The 'a' in front of a cipher string specifies that the cipher string applies to the authentication algorithm.

For examples of allowed and not allowed cipher suite filters, see the following link:

Related reference

Examples of Cipher Filters

#### 2.4.3.3 Examples of Cipher Filters

Table 5   Examples of Allowed Cipher Filters as Specified in the

Tls.cipherFilter Attribute

| Tls.cipherFilter                             Value                             | Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|--------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ALL:!aRSA:!CBC                                                                 | Results in a set of enabled ciphers that include all cipher suites                                 except those with RSA authentication and CBC                                 mode                                 of operation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ALL:-aRSA:-CBC:SHA256                                                          | Results in a set of enabled ciphers that include all cipher suites                                 except those with RSA authentication without SHA256 Message                                 Authentication Code (MAC) and CBC                                 mode                                 of operation without SHA256 MAC ciphers. The                                 exclusive modifier “-“ is used before the trailing inclusive filter,                                 which results in a set of enabled ciphers that include all those                                 with SHA256 MAC ciphers.                                 Therefore                                 the resulting set includes those with RSA authentication and CBC                                 mode                                 of operation that also have the SHA256 MAC                                 cipher. |
| ALL:!kRSA                                                                      | Results in a set of enabled ciphers that include all cipher suites                                 except those with RSA key exchange ciphers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ALL:!aRSA                                                                      | Results in a set of enabled ciphers that include all cipher suites                                 except those with RSA authentication ciphers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ALL:!RSA                                                                       | Results in a set of enabled ciphers that include all cipher suites                                 except those with RSA key exchange and RSA authentication                                 ciphers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| kECDH+AES                                                                      | Results in a set of enabled ciphers that include only those with EDCH                                 key exchange ciphers that use the AES encryption cipher.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| kECDHE:GCM                                                                     | Results in a set of enabled ciphers that include only those with                                 ECDHE key exchange and those with GCM                                 mode                                 of operation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| kECDHE+CBC:-SHA                                                                | Results in a set of enabled ciphers that include only those with                                 ECDHE key exchange ciphers that use the CBC                                 mode                                 of operation, except any cipher suite that has an                                 SHA-1 MAC cipher.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ALL:!ECDHE-RSA-AES-256-CBC-SHA                                                 | Results in a set of enabled ciphers that include all cipher suites                                 except the specific cipher suite with the name                                 TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| TLS-ECDHE_-RSA-WITH-AES-256-GCM-SHA384:TLS-ECDHE-ECDSA-WITH-AES-256-GCM-SHA384 | Results in a set of enabled ciphers that include only the specific                                 ciphers suites with the names                                 TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384                                 and TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ALL:!RSA-CBC                                                                   | Results in a set of enabled ciphers that include all cipher suites                                 except those that contain the                                 RSA                                 key exchange and RSA authentication ciphers with CBC mode of                                 operation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ALL:!CCM                                                                       | Results in a set of enabled ciphers that include all cipher suites                                 except all those that                                 contain the                                 CCM                                 mode of operation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ALL:TLSv1_2  Or  ALL:                                     !TLSv1_3             | Results in a set of enabled ciphers that include only the cipher                                 suites supported in TLSv1.2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ALL:TLSv1_2:TLSv1_3                                                            | Results in a set of enabled ciphers that include only the cipher                                 suites supported in TLSv1.2 or TLSv1.3. Long-lived server components                                 that use these cipher suites are configured to support only TLSv1.2                                 and TLSv1.3.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| aECDSA:GCM:CHACHA20-POLY1305                                                   | Results in a set of enabled ciphers that include only those with                                 ECDSA authentication, the ones with                                 GCM                                 mode of operation and those with CHACHA20-POLY1305                                 encryption ciphers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| aECDSA:ECDHE:!CCM:!SHA                                                         | Results in a set of enabled ciphers that include those with ECDSA                                 authentication, the ones with ECDHE key exchange ciphers except any                                 cipher suite that uses CCM                                 mode                                 of operation or SHA-1 MAC                                 cipher.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ALL:-TLSv1_2:-TLS-AES-128-GCM-SHA256:+TLS-AES-128-GCM-SHA256                   | Results in a set of enabled ciphers that only include ciphers suites                                 supported in TLS1.3 and move TLS_AES_128_GCM_SHA256 cipher to the                                 last in the list of cipher suites for TLSv1.3 protocol.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ALL:!TLSv1                                                                     | Results in all TLS cipher suites and TLS versions except                                 TLS1.0.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

Table 6   Examples of Not Allowed Cipher Filters as Specified in the

Tls.cipherFilter Attribute

| Tls.cipherFilter                             Value   | Result                                                                                                                                                                                                                                                                                        |
|------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ALL:+AES-128                                         | Not allowed. The ‘+’ character is not allowed directly after ‘:’.                                                                                                                                                                                                                             |
| +CCM                                                 | Not allowed. The ‘+’ character must be preceded by a cipher                                 string.                                                                                                                                                                                           |
| -CCM                                                 | Not allowed. There must be at least one inclusive cipher string in                                 the filter.                                                                                                                                                                                |
| DEFAULT:-aRSA                                        | Not allowed. Any cipher string after ‘DEFAULT’ is ignored.                                                                                                                                                                                                                                    |
| akRSA                                                | Not allowed. It is not possible to combine ‘a’ and ‘k’ on the same                                 cipher string.                                                                                                                                                                             |
| kDHE-aRSA                                            | Not allowed. Character ‘-‘ can only be used to delete ciphers                                 (preceding the cipher string), or if ‘-‘ is part of a cipher                                 algorithm string (encryption) or in combining a full cipher                                 suite. |

#### 2.4.3.4 Operate the Elliptic Curves Configurability for TLS

The supported protocols are listed in the

Tls.supportedEllipticCurves MO attribute when the

Tls.ellipticCurveFilter attribute is set to

ALL.

The elliptic

curves in the

following table are supported for

TLS

1.0,

TLS 1.2,

and TLS 1.3

protocol.

Table 7   Supported Elliptic Curves for TLS 1.0, TLS 1.2

and TLS 1.3

| Elliptic Curve   | TLS 1.0 and TLS 1.2   | TLS 1.3   |
|------------------|-----------------------|-----------|
| sect571r1        | Yes                   | -         |
| sect571k1        | Yes                   | -         |
| secp521r1        | Yes                   | Yes       |
| brainpoolP512r1  | Yes                   | -         |
| x448             | Yes                   | Yes       |
| sect409k1        | Yes                   | -         |
| sect409r1        | Yes                   | -         |
| brainpoolP384r1  | Yes                   | -         |
| secp384r1        | Yes                   | Yes       |
| sect283k1        | Yes                   | -         |
| sect283r1        | Yes                   | -         |
| brainpoolP256r1  | Yes                   | -         |
| secp256k1        | Yes                   | -         |
| secp256r1        | Yes                   | Yes       |
| x25519           | Yes                   | Yes       |

As a

prerequisite, a proper cipher suite utilizing an elliptic curve algorithm for the

key exchange or authentication has to be used for TLS connection.

To modify the list of enabled elliptic curves for TLS:

Steps

1. Check the list of supported elliptic curves for TLS in the attribute Tls.supportedEllipticCurves for TLS.
2. Configure the Tls.ellipticCurveFilter attribute by using the appropriate filter format. The TLS-based server components are restarted immediately upon completing the configuration request. The changes are active for TLS client usage directly after configuration, without any restart. The setting of the Tls.ellipticCurveFilter attribute causes the specified filter to be applied to the list of supported elliptic curves. The resulting list of enabled elliptic curves is presented in the Tls.enabledEllipticCurves attribute.
3. Verify that the attribute Tls.enabledEllipticCurves includes the new list of elliptic curves enabled through the Tls.ellipticCurveFilter attribute.
4. Perform a connection test to verify that the resulting elliptic curves allow connections. As a prerequisite a proper cipher suite utilizing an elliptic curve algorithm for the key exchange or authentication has to be used for TLS connection. Note: A new set operation on the Tls.ellipticCurveFilter attribute on overrides the previous elliptic curve configuration on TLS.

#### 2.4.3.5 Rules for ellipticCurveFilter String

The elliptic curve strings are separated by colons and processed and evaluated from left

to right. The Tls.ellipticCurveFilter attribute consists of the

following formats:

- One or several elliptic curve strings, in the "&lt;elliptic curve string&gt;[:&lt;elliptic curve string&gt;]...[:&lt;elliptic curve string&gt;]" format.
- The keyword 'ALL', optionally followed by the characters ':!' and elliptic curves which need to be removed, in the "ALL:!&lt;elliptic curve string&gt;[:!&lt;elliptic curve string&gt;]...[:!&lt;elliptic curve string&gt;]" format.

#### 2.4.3.6 Examples of Elliptic Curves

Table 8   Examples of Supported Elliptic Curves as Specified in the

Tls.ellipticCurveFilter Attribute

| Tls.ellipticCurveFilter Value                          | Result                                                                                                                                                        |
|--------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ALL:!secp256k1                                         | Results in a set of enabled elliptic curves that include all curves                                 except secp256k1 curve.                                   |
| ALL:!brainpoolP256r1:!brainpoolP384r1:!brainpoolP512r1 | Results in a set of enabled elliptic curves that include all curves                                 except brainpoolP256r1, brainpoolP384r1, brainpoolP512r1. |
| secp256r1:x25519                                       | Results in a set of enabled elliptic curves that include only                                 secp256r1 and x25519 curves.                                    |

### 2.4.4 Operate the Ciphers Configurability for SSH

The configuration of the SSH ciphers is done by setting attribute values in the

Ssh MO class. The ciphers, the key exchange algorithms (kex),

and the message authentication codes (macs) are set separately.

Table 9   SSH Ciphers

| SSH           | Ciphers  (1)                         |
|---------------|--------------------------------------|
| Key exchange: | ecdh-sha2-nistp384                   |
| Key exchange: | ecdh-sha2-nistp521                   |
| Key exchange: | ecdh-sha2-nistp256                   |
| Key exchange: | diffie-hellman-group-exchange-sha256 |
| Key exchange: | diffie-hellman-group16-sha512        |
| Key exchange: | diffie-hellman-group18-sha512        |
| Key exchange: | diffie-hellman-group14-sha256        |
| Key exchange: | curve25519-sha256                    |
| Key exchange: | curve25519-sha256@libssh.org         |
| Key exchange: | curve448-sha512                      |
| Public key:   | ecdsa-sha2-nistp256(2)               |
| Public key:   | ssh-dss-1024                         |
| Public key:   | ssh-rsa-2048(2)                      |
| Encryption:   | chacha20-poly1305@openssh.com        |
| Encryption:   | aes256-gcm@openssh.com               |
| Encryption:   | aes256-ctr                           |
| Encryption:   | aes192-ctr                           |
| Encryption:   | aes128-gcm@openssh.com               |
| Encryption:   | aes128-ctr                           |
| Encryption:   | aes256-cbc                           |
| Encryption:   | aes192-cbc                           |
| Encryption:   | aes128-cbc                           |
| HMAC:         | hmac-sha2-256-etm@openssh.com        |
| HMAC:         | hmac-sha2-512-etm@openssh.com        |
| HMAC:         | hmac-sha2-256                        |
| HMAC:         | hmac-sha2-512                        |

(1)

Ciphers are configured using the following attributes:

- Ssh.selectedCiphers
- Ssh.selectedKeyExchanges
- Ssh.selectedMacs

Configuring weak ciphers is not recommended. Weak ciphers are

provided to facilitate backwards compatibility with older

peer equipment. The list of weak ciphers increases over time

as the deciphering capabilities increase.

(2)

The ServerKey MO corresponds to this cipher.

To modify the ciphers to use for SSH:

Steps

1. Check the supported ciphers, key exchange algorithms, and the message authentication codes, as shown in Table 9.
2. Select a subset from the list of the supported algorithms and use the selected subset to set the Ssh.selectedCiphers, Ssh.selectedKeyExchanges, and Ssh.selectedMacs attributes, respectively. The order of the selected algorithms corresponds to the order of preference. By changing the order when setting the selected algorithms, the order of preference is changed. The SSH-based server components are restarted immediately after completing the configuration request. In most cases, the SSH servers are available immediately after restart. But if the previously held resources are not released on time, new restarts are attempted every 2 minutes until the server is successfully restarted. The changes are active for SSH client usage directly after configuration, without restart. Note: The request must result in at least one selected algorithm for each attribute; otherwise the configuration request is rejected.
3. Perform a connection test to verify that the resulting configuration allows connections to be established.

### 2.4.5 Log of Cipher Suites Configuration Changes

All cipher suite configurations are logged in the Audit trail log, the Security log, and

the RTSEL log. For

details about the logs, please check Real-Time Security Event

List.

## 2.5 Enable Signature Validation Service

The Signature Validation Service is a security enhancement that follows offline

signature validation. It improves software security by warranting authenticity and

integrity of software that is about to be executed on the node. This way the feature

ensures the following for all node components:

- Executable software is certified.
- Executable software is unaltered.

Prerequisites

When the feature is delivered, the default value of the enum

SignatureValidationService in the MO

PlugInUnit is ENABLED.

Steps

1. Activate Signature Validation Service by the CLI command svs -enable.
2. Restart the node with restartRank RESTART\_COLD. Result: The value of the enum SignatureValidationService in the MO PlugInUnit is AVAILABLE. After the system upgrade, signature validation service cannot be disabled, and no further action is necessary.

## 2.6 Configure Trusted NTP Server

Prerequisites

- An instance of the NtpServer MO is created.
- A list of key algorithms is known.
- The NTP server has the pre-shared key installed, and authentication and integrity protection is activated.

Steps

1. Create the NtpSecurityPolicy MO
2. Set the NtpSecurityPolicy.keyAlgorithm attribute to the value that represents the strongest cryptographic algorithm that is available in the NTP server and on the node.
3. Configure the NtpSecurityPolicy.preSharedKey attribute with the pre-shared key for NTP server authentication.
4. Configure the NtpSecurityPolicy.keyID attribute with the identifier key ID for the MAC cryptographic key.
5. Configure the node with the same security policy used in the NTP server by assigning the NtpServer.ntpSecurityPolicy attribute to the configured instance of the NtpSecurityPolicy MO. Multiple NtpServer MO instances can refer to the same NtpSecurityPolicy MO.

Results

NTP server authentication is configured.

## 2.7 Configure Board Restore Button on Emergency Access GUI

The Board Restore button on the

Emergency

Access web GUI is disabled by default for boards equipped with a

physical Board Restore Button.

Prerequisites

- User with System Security Administrator role is identified.
- If using the wired Local Maintenance Terminal (LMT) port, the LocalAccess=web MO under the SecM::LocalAccessM MO has the administrativeState attribute set to UNLOCKED.
- If using the wireless LMT port, the WifiAccess=web MO under the SecM::WifiAccessM MO has the administrativeState attribute set to UNLOCKED.
- Access to the site is secured (Wired LMT port and wireless LMT port require local access).

To enable the Board Restore button:

Steps

1. Set the LocalAccessM.emergencyRestore MO attribute to WEBENABLED.
2. If an Emergency Access web GUI session is already ongoing, refresh the web page to apply the change.

Results

The Board Restore button is available on the EA web GUI.

## 2.8 Configure Real-Time Security Event Logging

### 2.8.1 Configure Real-Time Security Event Logging over TLS

Prerequisites

The NodeCredential and the TrustCategory MO

instances are configured.

Steps

1. Set the LogM.nodeCredential attribute to refer to the configured NodeCredential MO instance.
2. Set the LogM.trustCategory attribute to refer to the configured TrustCategory MO instance.
3. Create the Log=AuditTrailLog and the LogPushTransfer, or the Log=SecurityLog and theLogPushTransfer MO instances.
4. Set the LogPushTransfer.transferType attribute to STREAM.
5. Set the LogPushTransfer.uri to syslogs://&lt;syslog\_server\_ip&gt;.
6. Optional: Set the Log.severityFilter attribute to only filter out the required events according to the Syslog Message Severities in RFC5424.
7. Optional: Activate the Integrated Endpoint Detection and Response feature to push or stream EdrLog. For more information, see Integrated Endpoint Detection and Response.

Results

Real-Time security event logging over TLS is configured and ready to use.

### 2.8.2 Configure Real-Time Security Event Logging over UDP

Steps

1. Create the Log=AuditTrailLog and the LogPushTransfer, or the Log=SecurityLog and the LogPushTransfer MO instances.
2. Set the LogPushTransfer.transferType attribute to STREAM.
3. Set the LogPushTransfer.uri to syslog://&lt;syslog\_server\_ip&gt;.
4. Optional: Set the Log.severityFilter attribute to only filter out the required events according to the Syslog Message Severities in RFC5424.
5. Optional: Activate the Integrated Endpoint Detection and Response feature to push or stream EdrLog. For more information, see Integrated Endpoint Detection and Response.

Results

Real-Time security event logging over UDP is configured and ready to use.

## 2.9 Encrypt Keys and Client Passwords

An external interface is

available to create encrypted values instead of cleartext values to

limit the exposure of sensitive information.

### 2.9.1 Configure Client Passwords, Keys, and Action Passwords

An encrypted value can be created from the cleartext client password, key, or action

parameter and used in a script, configuration, or action.

Prerequisites

A customer lab node with 25.Q1 or later software.

Steps

1. Prepare a cleartext client password,key, or action password.
2. Initiate the SecM.createEncryptedKey(key) action with a cleartext Client password or Key or Action password as input. Result: The action generates the encrypted value of the client password, key, or action password in the format &lt;version&gt;:&lt;encrypted key&gt;.
3. If the encrypted value is intended for a script or configuration file, replace the cleartext value with the encrypted value: &lt;version&gt;:&lt;encrypted key&gt; in the file.
4. Reconfigure the node using a script or manually use the encrypted values instead of cleartext. The encrypted values created with this method can be used in the following password attributes: SwM.defaultPassword UpgradePackage.password Ldap.bindPassword LogPushTransfer.password BrmBackupScheduler.autoExportPassword, BrmBackupScheduler.keyDecryptionKey, BrmBackupScheduler.cryptoKeyUriPassword, and BrmBackupScheduler.backPassword BrmBackupManager.autoExportPassword MaintenanceUser.password The encrypted values created with this method can be used in the following key attributes: SnmpTargetV3.authKey and SnmpTargetV3.privKey NtpSecurityPolicy.preSharedKey WifiAccessM.preSharedKey The encrypted values created with this method can be used in the following action parameters: Action parameter InstallTrustedCertFromUri.uriPassword in action CertM.InstallTrustedCertFromUri Action parameters InstallCredentialFromUri.uriPassword and InstallCredentialFromUri.credentialPassword in action NodeCredential.InstallCredentialFromUri Action parameter startOnlineEnrollment.challengePassword in action NodeCredential.startOnlineEnrollment Action parameter Lock.password in action TheftDeterrence.Lock

Results

The password and the key configured through the external interface are converted to

node-unique encrypted data and stored in the node. The node unique encrypted data is

decrypted and used in cleartext when the node performs actions towards node-external

services.

The action password configured through the external interface is decrypted and used

in the action command.

### 2.9.2 Configure the Node Using a Cleartext Password, Key, Action Parameter, or Script with an Old Encryption Version

Prerequisites

Old scripts or configuration files exist with an old encryption version or

cleartext.

Steps

1. Reconfigure the node using a script or manually use the cleartext password, key, action password, or script with an old encryption version.

Results

The cleartext passwords, keys, or passwords encrypted with an old encryption are

converted to node-unique encrypted data and stored in the node. The node-unique

encrypted data is decrypted and used in the cleartext, when the node performs

actions towards node-external services.

The action passwords configured in the old scripts are decrypted and used in action

command.

# 3 Privacy Functionality

Because of privacy and legal obligations, user consent might be required before

collecting the personal data from a UE, and sharing any troubleshooting data with

Ericsson.

Depending on applicable privacy regulations, an agreement might be required to be entered

into with Ericsson before the troubleshooting data is shared with Ericsson. For example,

in the case of GDPR, a Data Protection Agreement (DPA) would be required between the

parties prior to sharing the troubleshooting data with Ericsson.

## 3.1 Personal Data

The Baseband Radio Node processes Personally Identifiable Information (PII). Control

Plane (CP) and User Plane (UP) traffic are processed in plain-text, because the air

ciphering encryption is terminated in the Baseband Radio Node.

PII

includes the following elements:

- UE identifiers, such as IMSI, and IMEI
- UE activity, such as performance events
- Content of communication, or UP traffic, including the following: voice text sound picture other content of the communication
- Location data, including the following: location coordinates UE history information TAI TAC cell ID
- Miscellaneous, such as UE security capabilities, and temporary identifiers

## 3.2 Ericsson Support Information Package

The Ericsson Support Information (ESI) package contains logs and other data to be used by

Ericsson for analyzing the problem in node failure. The collected information in ESI

packages could

contain

personal data

for

the product on which the ESI package is created. The ESI package is encrypted to prevent

any unauthorized access to its content.

For more information about data collection methods, see Data Collection Guideline.

Related concepts

Personal Data

## 3.3 Privacy Implications of LTE Minimization of Drive Tests

The activation of this feature requires user consent.

Instead of using traditional drive tests, this feature provides a simple, cheap, and remote

method to use for troubleshooting or verification of the radio network. The feature provides a

tool to optimize network planning with the MDT measurement data, including location

information.

User consent is required before activating the MDT function for a UE because of privacy and

legal obligations. Generally, user consent is collected through a customer care process. The

user consent information availability must be considered part of the subscription data and

provisioned to the HSS database.

- Location Data Granularity UE location is very sensitive data. To reduce the privacy risk, MDT measurements are implemented as described in 3GPP documentation.
- Location Data Retention Location data is collected in PM Event ROP files in the node. This data is sensitive, and must be deleted according to retention times. For the personal data collected by the MDT feature, the recommendation is 6-12 months. The length of time the PM Event ROP files are stored in the node depends on the total file sizes of the saved files. The maximum storage retention of PM Event ROP files on the node is 25 hours. The retention time is reduced as traffic on the node increases and generally retention time is much less than this. Older files are removed whenever new storage capacity is needed for new files.
- MDT Feature Control Only grant access to the specific set of personal data concerned in the task. Access is granted to personnel if the following criteria are met: Have a valid reason to access personal data. Must perform a task with personal data. Is the one performing the task. For a Baseband Radio Node, the file system is hidden from the user.
- Notice to the User Subscribers must be informed or noticed by the UE that UE location tracking is in progress. This threat is mitigated by the consent they gave to the operator. There can be an option, for example, to send the subscribers an SMS that troubleshooting is being performed and that UE location is tracked.
- MDT Feature Use Logging Logging privacy events is very important in creating evidence that can be used as an audit trail. For example, if there is a privacy breach, an audit trail can identify responsibilities and the root cause of the breach.

## 3.4 Privacy Implications of NR Minimization of Drive Tests

The activation of this feature requires user consent.

Instead of using traditional drive tests, this feature provides a simple, cheap, and

remote method to use for troubleshooting or verification of the radio network. The

feature provides a tool to optimize network planning with the MDT measurement data,

including location information.

User consent is required before activating the MDT function for a UE because of privacy

and legal obligations. Generally, user consent is collected through a customer care

process. The user consent information availability must be considered part of the

subscription data and provisioned to the UDM database.

- Location Data Granularity UE location is sensitive data. To reduce the privacy risk, MDT measurements are implemented as described in 3GPP documentation.
- Location Data Retention Location data is collected in PM Event ROP files in the node. This data is sensitive, and must be deleted according to retention times. For the personal data collected by the MDT feature, the recommendation is 6-12 months. The length of time the PM Event ROP files are stored in the node depends on the total file sizes of the saved files. The maximum storage retention of PM Event ROP files on the node is 25 hours. The retention time is reduced as traffic on the node increases and generally retention time is much less than this. Older files are removed whenever new storage capacity is needed for new files.
- MDT Feature Control Only grant access to the specific set of personal data concerned in the task. Access is granted to personnel if the following criteria are met: Have a valid reason to access personal data. Must perform a task with personal data. Is the one performing the task. For a Baseband Radio Node, the file system is hidden from the user.
- Notice to the User Subscribers must be informed or noticed by the UE that UE location tracking is in progress. This threat is mitigated by the consent that they gave to the operator. There can be an option, for example, to send the subscribers an SMS that troubleshooting is being performed and that UE location is tracked.
- MDT Feature Use Logging Logging privacy events is important in creating evidence that can be used as an audit trail. For example, if there is a privacy breach, an audit trail can identify responsibilities and the root cause of the breach.

## 3.5 Privacy Implication of Port Mirroring

This feature allows for deep dive troubleshooting and solving protocol problems when

all other means fail.

The feature can be used by both Ericsson and operator trusted personnel. It collects data

containing subscriber personal information, which can be used to identify subscribers

and their behavior in the network. When using this feature, all incoming and outgoing

raw data is captured, what makes it possible to store subscriber data on specific

equipment, such as protocol analyzers.

Access to the feature is restricted, and made available only to trusted personnel because

of its privacy and security sensitiveness. To respect subscriber privacy and to prevent

misuse of port mirroring, the use of the feature is logged, and audit trails are

collected. The information contained in the logs is used if there is a security or

privacy breach, and subsequent investigation.

For more information, see Port

Mirroring.

## 3.6 Privacy Implications of Packet Capture

This feature allows manual remote packet capturing at an interface level. It is used for

troubleshooting of networking and protocol problems and is meant to be used when all

other troubleshooting options are exhausted. IP packets are captured at either the

egress or at the ingress flow, or both. The PacketCaptureLog file is stored in pcap.aes

file format in a temporary file system. The file is encrypted and it can be exported to

a remote server for detailed analysis. The file can be analyzed with Wireshark and other

networking tools. This feature can be used both by Ericsson and operator personnel but

only users with the role Transport\_Application\_SecurityAdministrator can access privacy

related data.

For more information, see Feature Description Packet Capture.

## 3.7 Privacy Functionality for Enhanced Cell ID in Traces

The Enhanced Cell ID in Traces feature allows to identify the location of a UE at any

given time. The uplink timing alignment value is collected and used for group data

statistics. The primary use is geo-observability.

The timing alignment value gives an indication of the distance of an UE to an antenna.

Together with the signal characteristics from other cells it is possible, after post

processing, to identify the location of the UE at a certain time.

## 3.8 Privacy Functionality for Streaming Features

These features make it possible to stream traces to a receiver system.

In the Streaming of PM Events feature, the traces contain the same data as in cell trace

ROP files. For more information, see Streaming of PM Events.

In the

Streaming

of Events feature, the traces contain the same data as in cell trace

or UE Trace ROP files. For more information, see

Streaming of Events.

## 3.9 Privacy Implications of OTDOA PRS Management

This feature provides information about how to configure OTDOA-based calculations.

The feature offers less interference between neighboring cells during PRS transmissions,

which results in more accurate PRS measurements. Therefore, more accurate coordinates of

the location of the UEs are obtained.

## 3.10 Privacy Functionality for OTDOA Control Plane Location Support

The OTDOA method defined in 3GPP is based on PRS configuration. This feature enables the

operator to configure the PRS.

The UE measures PRSs from multiple eNodeBs and also receives the following

information:

- Geographical information of the eNodeB-positions
- The relative downlink timing of the eNodeBs

On such basis, an estimate of the UE-position can be established.

The OTDOA method provides sufficient positioning accuracy (50-200 m) to serve as a

fallback method for the A-GPS method. It also enables the operator to comply with the

FCC phase 2 accuracy requirements on the positioning of emergency calls. This also means

that the location information of the customer is known.

For more information, see Feature Description

OTDOA Control Plane Location

Support.

## 3.11 Privacy Implications of OTDOA User Plane Location Support

The activation of this feature requires user consent.

This feature enables the operator to configure the Positioning Reference Signals (PRSs)

that forms the basis for the OTDOA method defined in 3GPP.

The UE measures PRSs from multiple eNodeBs along with geographical information of the

eNodeB positions and their relative downlink timing, an estimate of the UE position can

be established.

The OTDOA method provides sufficient positioning accuracy (50-200 m) to serve as a

fallback method for the A-GPS method and enables the operator to comply with the FCC

phase 2 accuracy requirements on positioning of emergency calls. This also means that

the customer's location information will be known.

For more information, see OTDOA User Plane Location Support.

## 3.12 Privacy Implications of Inter-Frequency OTDOA

This feature allows the UE to take PRS measurements in cells which use a different

frequency from the one used by the serving cell.

This feature improves accuracy of the positioning-related measurements by increasing the

number of cells to measure. The location information of the UE will be known.

For more information, see Feature Description Inter-Frequency OTDOA.

## 3.13 Privacy Functionality for Enhanced Cell ID Control Plane Location Support

This feature in the RBS enables the operator to keep the location node updated, through

the OSS, about the geographic data of the cells served by the RBS.

An update is sent whenever a change occurs in any of

these cell parameters. The location node uses these cell data when compiling the

assistance data sent to the UE on the control plane bearer. In UE assisted mode, it also

uses the data when calculating the UE positioning, based on the measurements reported by

the UE.

The UE position accuracy is in the range of 200-300 meters.

For more information, see

Enhanced Cell ID Control Plane Location

Support.

## 3.14 Privacy Functionality for Enhanced Cell ID User Plane Location Support

This feature in the RBS enables the operator to keep the location node updated, through

the OSS, about the geographic data of the cells served by the

RBS. An update is sent whenever a change occurs in

any of these cell parameters. The location node uses this cell data when calculating the

UE positioning based on the UE measurements reported by the UE.

The UE position accuracy is in the range of 200-300 meters.

For more information, see Enhanced Cell ID User Plane Location

Support.

## 3.15 Privacy Implications of Cell ID-Based Location Support

This feature guarantees that the serving Mobility Management Entity (MME) will always

have the correct Cell Global Identity (CGI) for served active UE.

The feature provides a rough estimate of the UE position, the UE position is provided

with accuracy corresponding to the cell size. Since it is known which cell the UE is in

this can lead to accurate location estimation if cell size is small.

For more information, see Feature Description

Cell ID-Based Location

Support.

## 3.16 Privacy Functionality for LPPa-based E-CID Support

This feature allows the E-SMLC to initiate UE and eNodeB measurements for positioning

purposes. The measurement results are reported to the E-SMLC, where the UE positioning

is calculated.

The eNodeB provides measurement data to positioning node with messages that can be used

to estimate the location of a UE. The UE position is defined based on enhanced Cell ID

information.

The operator can retrieve some UE positioning information, with more accuracy than just

the Cell ID, without having special UE positioning support. With this feature the

operator can support some UE positioning even if the UE does not support LPP.

## 3.17 Privacy Implications of LPPa-based OTDOA Support

This feature allows the eNodeB to provide measurement data that can be used to estimate

the location of a UE.

For more information, see LPPa-based OTDOA Support.

## 3.18 Privacy Implications for A-GPS Control Plane Location Support

This feature in the RBS enables the operator to keep the location node updated, through

the OSS, about the geographic data of the cells served by the RBS. An update is sent

whenever a change occurs in any of the cell parameters. The location node uses the cell

data when compiling the assistance data sent to the UE on the control plane bearer. The

location node also uses the data when, for the UE assisted mode, it calculates the UE

positioning based on the GNSS measurements reported by the UE.

The UE's location information will be known. The A-GPS methods have a typical accuracy of

20-50 m. The UE forwards its position upon request.

For more information, see A-GPS Control Plane Location Support.

## 3.19 Privacy Functionality for A-GPS User Plane Location Support

This feature in the RBS enables the operator to keep the location node updated, through

the OSS, about the geographic data of the cells served by the RBS. An update is sent

whenever a change occurs in any of these cell parameters. The location node uses this

cell data when compiling the assistance data sent to the UE on the control plane bearer.

The node also uses the data when, for the UE assisted mode, it calculates the UE

positioning based on the GNSS measurements reported by the UE.

The UE's location information will be known. The A-GPS methods have a typical accuracy of

20-50 m. The UE forwards its position on the user plane to the positioning node upon

request.

For more information, see Feature Description

A-GPS User Plane Location

Support.

## 3.20 Privacy Implications of Category M Enhanced Cell ID Location Support

This feature allows the E-SMLC to initiate UE and eNodeB measurements for positioning

purposes. The measurement results are reported to the E-SMLC, where the UE positioning

is calculated.

The eNB provides measurement data to positioning node with messages that can be used to

estimate the location of a UE. The UE position is defined based on enhanced Cell ID

information.

The Operator can retrieve some UE positioning information, with more accuracy than just

the Cell ID, without having special UE positioning support. With this feature the

operator can support some UE positioning even if the UE does not support LPP.

For more information, see Feature Description Category M Enhanced Cell ID Location

Support.

## 3.21 Privacy Implications of Anonymization of Data in eNodeB

This function enables omitting end-user personal data from events, logs, and traces in

the eNodeB, which is otherwise logged in rare occasions.

The function is controlled by the

SecurityHandling.personalDataProtectionEnabled attribute. The

default value of the attribute is TRUE, which means that personal data

is not written in the logs by default.

The attribute can be set to FALSE to disable data protection, allowing

personal data to be written in the logs for troubleshooting and observability purposes.

The Personal Data Deidentification Disabled Alert is raised when it is set to false.

The function replaces the following content in the EVENT\_PARAM\_L3MESSAGE\_CONTENTS event

parameter with meaningless data:

- NAS message content: NAS-PDU IE in S1 messages dedicatedInfoNAS or dedicatedInfoNASList IE in RRC messages
- UEPagingID IE in the S1 Paging message if it contains IMSI.

This affects the following PM events:

- RRC\_RRC\_CONNECTION\_SETUP\_COMPLETE
- RRC\_RRC\_CONNECTION\_SETUP\_COMPLETE\_NB
- RRC\_UL\_INFORMATION\_TRANSFER
- RRC\_UL\_INFORMATION\_TRANSFER\_NB
- RRC\_DL\_INFORMATION\_TRANSFER
- RRC\_DL\_INFORMATION\_TRANSFER\_NB
- RRC\_RRC\_CONNECTION\_RECONFIGURATION
- S1\_INITIAL\_UE\_MESSAGE
- S1\_UPLINK\_NAS\_TRANSPORT
- S1\_DOWNLINK\_NAS\_TRANSPORT
- S1\_INITIAL\_CONTEXT\_SETUP\_REQUEST
- S1\_PAGING
- S1\_REROUTE\_NAS\_REQUEST
- S1\_NAS\_NON\_DELIVERY\_INDICATION
- S1\_ERAB\_SETUP\_REQUEST
- S1\_ERAB\_MODIFY\_REQUEST
- S1\_ERAB\_RELEASE\_COMMAND

The whole content of the EVENT\_PARAM\_L3MESSAGE\_CONTENTS event parameter is replaced

with meaningless data for PM events indicating one of the following errors:

- INTERNAL\_EVENT\_RRC\_ERROR
- INTERNAL\_EVENT\_S1AP\_PROTOCOL\_ERROR

This function is applicable for LTE and NB-IoT traffic.

## 3.22 Privacy Implications of Anonymization of Data in gNodeB

This function enables omitting end-user personal data from events, logs, and traces in

the gNodeB, which is otherwise logged in rare occasions.

The function is controlled by the

SecurityHandling.personalDataProtectionEnabled attribute. The

default value of the attribute is TRUE, which means that personal data

is not written in the logs by default.

The attribute can be set to FALSE to disable data protection, allowing

personal data to be written in the logs for troubleshooting and observability purposes.

The Personal Data Deidentification Disabled Alert is raised when it is set to false.

The function replaces the following NAS message content in

the asn1.msg\_content event parameter with meaningless data:

- NAS-PDU IE for NG messages
- dedicatedNAS-Message or dedicatedNAS-MessageList IE for RRC messages

This affects the following PM events:

- CuCpNgPduSessionResourceSetupRequest
- CuCpNgPduSessionResourceReleaseCommand
- CuCpNgPduSessionResourceModifyRequest
- CuCpNgInitialContextSetupRequest
- CuCpNgHandoverRequest
- CuCpNgInitialUeMessage
- CuCpNgDownlinkNasTransport
- CuCpNgUplinkNasTransport
- CuCpNgNasNonDeliveryIndication
- CuCpNgRerouteNasRequest
- CuCpRrcDlInformationTransfer
- CuCpRrcReconfiguration
- CuCpRrcSetupComplete
- CuCpRrcUlInformationTransfer

## 3.23 Privacy Implications of RDS Location Support

The RDS Location Support feature enables

Location-Based

Services

(LBS)

for indoor venues. It provides UE measurements on a per RD basis, for the Ericsson

Network Location (ENL) to calculate basic UE positioning. This feature supports both

periodic and on-demand measurement reporting.

Using existing ENL capabilities, the RDS Location Support feature supports active

positioning and uses LPPa E-CID messages to request LTE UE positioning reports from ENL.

The ENL performs AECID calculations, which determine the geolocation of the UE.

For more information, see the RDS Location Support and the

Radio Dot System documents.

## 3.24 Privacy Implications of Shared RAN Features

Depending on the applicable privacy regulations, the participating operators might be

required to enter into an agreement before the Shared LTE RAN or the Shared NR RAN

features are used. Taking the GDPR as an example, the participating operators might be

required to enter into a DPA before processing the subscriber data.

When operators share the Baseband Radio Node using a shared RAN feature, the personal

data of the subscribers

related

to

each participating operators are processed by the Baseband Radio Node

in plain-text. All other features with a privacy

implication

have

impact on the subscribers of the participating operators.

For example, if the

SecurityHandling.personalDataProtectionEnabled

attribute is set to false, then the UE

identifiers, such as IMSI of the participating operators might be revealed in PM

events.

## 3.25 Privacy Implications of Basic AAS for TDD

The feature has a privacy impact because UE IDs are collected and stored by the eNodeB.

The signals sent by the eNodeB to trigger SRS switch to DMRS and SRS release, contain

the UE IDs.

## 3.26 Privacy Implications of NB-IoT Enhanced Cell ID Location Support

This feature allows the E-SMLC to initiate eNodeB measurements for positioning purposes.

The measurement results are reported to the E-SMLC, where the UE positioning is

calculated.

The eNodeB provides measurement data for the positioning node with messages that can be

used to estimate the location of an NB-IoT UE. The UE position is based on E-CID

information.

The operator can retrieve some UE positioning information, with more accuracy than just

the cell ID, without having special UE positioning support. With this feature, the

operator can support some UE positioning even if the UE does not support LPP.

For more information, see the NB-IoT Enhanced Cell ID Location Support

Feature Description.

## 3.27 Privacy Implications of Location Support

The Location Support feature allows the

Location

Management Function

(LMF)

to initiate UE measurements for positioning purposes. The measurement results are

reported to the LMF, where the UE positioning is calculated.

The gNodeB provides measurement data to the LMF with messages that can be used to

estimate the location of the target UE. The UE position is defined based on the cell ID

and the SS-RSRP information.

With this feature, the operator can support UE positioning even if the UE does not

support LPP or does not respond to LPP messages.

## 3.28 Privacy Implications of NR Advanced UE Location Support

This feature allows the LMF to initiate UE measurements for positioning purposes. The

measurement results are reported to the LMF, where the UE positioning is calculated.

The gNodeB provides measurement data to the LMF with messages that can be used to

estimate the location of the target UE. The UE position is defined based on the NR

Timing Advance information.

## 3.29 Privacy Implications of High-Resolution Timing Advance for Macro Positioning

This feature allows the LMF to initiate UE measurements for positioning purposes. The

measurement results are reported to the LMF, where the UE positioning is calculated.

The gNodeB provides measurement data to the LMF with messages that can be used to

estimate the location of the target UE. The UE position is defined based on NR Timing

Advance information.

## 3.30 Privacy Implications of Uplink Angle of Arrival for Macro Positioning

This feature allows the LMF to initiate UE measurements for positioning purposes. The

measurement results are reported to the LMF, where the UE positioning is calculated.

The gNodeB provides measurement data to the LMF with messages that can be used to

estimate the location of the target UE. The UE position is defined based on uplink AoA

and NR Timing Advance information.

## 3.31 Privacy Implications of Macro Positioning Information in Traces

NR Timing Advance measurements provide a rough indication of the distance between the UE

and the cell antenna. Uplink AoA measurements provide a rough indication of the UE

direction. This makes it possible to identify where the UE is located at a certain time

and correlate the UE position information with other collected information for

statistical use.

## 3.32 Privacy Implications of Periodic Measurements for Macro Positioning

This feature allows the LMF to initiate UE measurements for positioning purposes. The

measurement results are reported to the LMF, where the UE positioning is calculated.

The gNodeB provides measurement data to the LMF with messages that can be used to

estimate the location of the target UE. The UE position is defined based on the NR

Timing Advance and uplink AoA information if requested and supported.