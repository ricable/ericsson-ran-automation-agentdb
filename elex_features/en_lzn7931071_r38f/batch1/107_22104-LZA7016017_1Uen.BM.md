---
complexity_score: 13.5
converted_at: '2025-08-13T06:58:01.305422Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 2
images_saved: 3
original_path: 107_22104-LZA7016017_1Uen.BM.html
pictures_extracted: 2
processing_method: docling_multimodal
quality_score: 9.0
source_file: 107_22104-LZA7016017_1Uen.BM.html
source_zip: en_lzn7931071_r38f.zip
tables_extracted: 13
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 2796
---

# 

NR Air Interface Protection

Contents

![Image](../images/107_22104-LZA7016017_1Uen.BM/additional_3_CP.png)

![Image](../images/107_22104-LZA7016017_1Uen.BM/additional_3_CP.png)

- Overview
- Dependencies
- Feature Operation
    - Initial Context Setup with User Plane Protection
    - PDU Session Resource Setup Procedure with User Plane Protection
    - NG-based NR Intra-System Handover with User Plane Protection
    - Xn-based NR Intra-System Handover with User Plane Protection
    - Replay Protection of the Receiving PDCP Layer
    - User Plane Integrity Protection in NR-DC
- Network Impact
- Parameters
- Performance
- Activate the Feature
- Appendix: Feature Change History
    - Appendix: 22.Q3: NR Air Interface Protection on Baseband 6630 for CPRI Traffic
    - Appendix: 22.Q4: Security Enhancements in Xn-Based Handovers and in Inter-gNodeB RRC Re-establishment
    - Appendix: 24.Q2.0: Support for User Plane Integrity Protection on Baseband 6630 Mixed Mode
    - Appendix: 24.Q2.0: User Plane Integrity Protection in NR-DC
    - Appendix: 24.Q2.0: Streetmacro 6701 Support for User Plane Integrity Protection in NR-DC

# 1 NR Air Interface Protection Overview

The feature provides data transmission with integrity protection and ciphering of the

user plane between the UE and the gNodeB in NR SA and NR-DC deployments.

| Feature Name           | NR Air Interface Protection                             |
|------------------------|---------------------------------------------------------|
| Feature Identity       | FAJ 121 5340                                            |
| Value Package Name     | NR Base Package                                         |
| Value Package Identity | FAJ 801 4002                                            |
| Node Type              | Baseband Radio Node                                     |
| Access Type            | NR                                                      |
| Licensing              | Non-license-controlled feature. No license is required. |

Summary

Integrity protection allows the detection and prevention of changes and manipulation

of the transmitted data. Integrity protection is recommended for applications where

additional security is required at the expense of higher resource use.

The integrity protection function provides the following benefits:

- Improved security of OTA user plane data.
- Secure data origin by signing the data digitally, so that it can be validated at the receiving end.
- Improved replay protection of the receiving PDCP entity in the gNodeB and the UE.
- By discarding the failed packets if the integrity verification fails, the PDCP sequence number of the discarded PDU is not processed or used by the PDCP receiver.

Ciphering allows the encryption and decryption of the transmitted data which provides

confidentiality and privacy.

Related Information

For more information related to the integrity protection of the feature, see the

following documentation:

- 3GPP TS 33.501; Security architecture and procedures for 5G System
- 3GPP TS 38.323; NR; Packet Data Convergence Protocol (PDCP) specification

For further information related to the concepts included in the feature, see the

following documentation:

- 3GPP TS 23.501; System architecture for the 5G System (5GS); Stage 2
- 3GPP TS 23.502; Procedures for the 5G System (5GS)
- 3GPP TS 24.501; Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3
- 3GPP TS 38.331; NR; Radio Resource Control (RRC); Protocol specification
- 3GPP TS 38.413; NG-RAN; NG Application Protocol (NGAP)
- 3GPP TS 38.463; NG-RAN; E1 Application Protocol (E1AP)

# 2 Dependencies of NR Air Interface Protection

The feature has dependencies to other features, hardware requirements, and

limitations.

Table 1   Feature Dependencies

| Feature                                                                | Relationship   | Description                                                                                                                                                                                                                                                                                                                                                                               |
|------------------------------------------------------------------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| NR Standalone (FAJ 121 5060)                                           | Related        | If the integrity protection of the user plane function of the       NR Air Interface Protection feature is enabled, the packets that are to be in effect discarded       by the RLC AQM for TCP optimization function of the NR Standalone feature might fail user       plane integrity verification in the UE. The packets might also fail because of invalid PDU       size in the UE. |
| NR Mobility (FAJ 121 5041)                                             | Related        | To comply with 3GPP TS 23.501, at IRAT mobility where                                 the user plane integrity plane protection is set to                                     Required for any of the PDU sessions of the UE,                                 the Release with Redirect mechanism is initiated instead of                                 handover.                       |
| NR-NR Dual Connectivity (FAJ 121                                 5380) | Related        | The user plane integrity protection over the Uu interface can be enabled on both the                 Master and Secondary Nodes for the UEs configured with NR-DC.                                                                                                                                                                                                                        |

Hardware

User plane integrity protection is supported on the following hardware units:

- Baseband 6621
- Baseband 6631
- Baseband 6641
- Baseband 6648
- Radio Processor 6337
- Radio Processor 6339
- Radio Processor 6347
- Radio Processor 6353
- RAN Processor 6647
- RAN Processor 6651
- Streetmacro 6705

Limitations

It is not recommended to use the user plane integrity protection function with UEs

that do not support full rate integrity protection as specified in 3GPP Release 15.

For UEs that do not support full rate integrity protection, one of the following

scenarios applies:

- The gNodeB rejects the PDU session.
- The gNodeB configures the PDU session without integrity protection.

The same integrity protection and ciphering algorithms are used for the control plane

and the user plane.

Network Requirements

It is recommended to keep ciphering enabled when the user plane integrity protection

is configured on the Secondary Node. UE issues might cause throughput drop for some

of the UEs when ciphering is disabled.

It is recommended to align the user plane integrity protection activation statuses on

the Master Node and the Secondary Node. UE issues might cause severe throughput drop

for some of the UEs when user plane integrity protection activation statuses are not

aligned on the Master Node and Secondary Node, and a High-Band serving cell is

unlocked on the Secondary Node.

# 3 Feature Operation of NR Air Interface Protection

The Access and Mobility Management Function (AMF) and the gNodeB handle the

establishment of the user plane integrity protection and ciphering between the UE and the

gNodeB.

The

AMF

provides the user plane security policy for the PDU session to the gNodeB during the PDU

session establishment. For each DRB in the PDU session, the integrity protection

algorithm signs the transmitted data digitally, so that the receiver can validate it.

The integrity protection algorithm is selected based on the following information:

- The algorithms supported by the UE
- The value of the SecurityHandling.integrityProtectAlgoPrio attribute

Ciphering is enabled by default. The priority of the supported ciphering algorithms can

be configured with the SecurityHandling.cipheringAlgoPrio

attribute.

The ciphering algorithm is selected based on the following information:

- The algorithms supported by the UE
- The value of the SecurityHandling.cipheringAlgoPrio attribute

## 3.1 Initial Context Setup with User Plane Protection

User plane integrity protection and ciphering are configured during the Initial Context

Setup procedure if the following attributes are configured:

- The SecurityHandling.featCtrlIntegProtUserPlane attribute set to ON.
- The SecurityHandling.cipheringAlgoPrio attribute is set to the selected ciphering algorithm.

The Initial Context Setup procedure that establishes the initial UE context in the gNodeB

includes the following actions related to user plane integrity protection setup:

- The Access and Mobility Management Function (AMF) sends the NGAP INITIAL CONTEXT SETUP REQUEST message to the gNodeB, which contains the following information related to the setup of user plane integrity protection and ciphering: The security capabilities of the UE related to integrity protection and ciphering The security key The security indication on PDU session level Note: The security indication on PDU session level determines if the user plane integrity protection is applied during PDU session establishment or if the PDU session is rejected.
- The gNodeB performs the AS Security Activation procedure followed by an RRC Reconfiguration procedure to configure the ciphering and the integrity protection.
- The gNodeB sends the NGAP UE INITIAL CONTEXT SETUP RESPONSE message to the AMF to confirm the successful establishment of the UE context including user plane integrity protection and ciphering setup.

Related Information

NR Standalone

## 3.2 PDU Session Resource Setup Procedure with User Plane Protection

PDU Session Resource Setup Procedure with User Plane Integrity Protection

Figure 1   Operational Sequence Diagram for

PDU

Session Resource Setup Procedure

with User

Plane Integrity

Protection

For the PDU Session Resource Setup procedure, the following messages are used to set

up user plane integrity protection and ciphering:

- The NGAP PDU SESSION RESOURCE SETUP REQUEST message is sent by the Access and Mobility Management Function (AMF) to the gNodeB including the security indication for user plane integrity protection and ciphering setup. The gNodeB performs one of the following actions, based on the security indication received in the message: DRB setup with user plane integrity protection DRB setup without user plane integrity protection PDU session setup rejection
- The RRCReconfiguration message is sent by the gNodeB to the UE which contains the indication for each DRB in the PDU session set up with user plane integrity protection and ciphering.
- The RRCReconfigurationComplete message sent by the UE to the gNodeB to confirm the successful completion of RRC re-configuration.
- The NGAP PDU SESSION RESOURCE SETUP RESPONSE message sent by the gNodeB to the AMF to confirm successful establishment of the PDU session including if the integrity protection and ciphering are set up.

Related Information

NR Standalone

## 3.3 NG-based NR Intra-System Handover with User Plane Protection

The following attributes must be configured on the target gNodeB for NG-based NR

intra-system handover with user plane integrity protection ciphering:

- The SecurityHandling.featCtrlIntegProtUserPlane attribute set to ON.
- The SecurityHandling.cipheringAlgoPrio attribute is set to the selected ciphering algorithm.

For the incoming handover requests, the following messages are used to set up the user

plane integrity protection on the target gNodeB:

- The NGAP HANDOVER REQUEST message is sent by the Access and Mobility Management Function (AMF) to the target gNodeB with security information to select the user plane integrity protection and ciphering algorithm based on UE security capabilities and the value of the following attributes: SecurityHandling.integrityProtectAlgoPrio SecurityHandling.cipheringAlgoPrio
- The NGAP HANDOVER REQUEST ACKNOWLEDGE message is sent by the target gNodeB to the AMF to indicate if the user plane integrity protection and ciphering setup are performed for the PDU sessions that are set up successfully, or if the user plane integrity protection is rejected.

Related Information

NR Mobility

## 3.4 Xn-based NR Intra-System Handover with User Plane Protection

The following attributes must be configured on the target gNodeB for Xn-based NR

intra-system handover with user plane integrity protection ciphering:

- The SecurityHandling.featCtrlIntegProtUserPlane attribute set to ON.
- The SecurityHandling.cipheringAlgoPrio attribute is set to the selected ciphering algorithm.

For incoming handover requests, the following messages are used to set up the user plane

integrity protection and ciphering on the target gNodeB:

- The XnAP HANDOVER REQUEST message is sent by the source gNodeB to the target gNodeB, which contains indication of user plane integrity protection and ciphering. The message also contains the maximum integrity protected data rate values both in downlink and uplink for each UE and each DRB that has user plane integrity protection activated.
- The XnAP HANDOVER REQUEST ACKNOWLEDGE message is sent by the target gNodeB to the source gNodeB which contains the security configuration used by the UE.
- The NGAP PATH SWITCH REQUEST message is sent by the target gNodeB to the Access and Mobility Management Function (AMF) with information about the supported algorithms for ciphering and user plane integrity protection based on the security capabilities of the UE.
- The NGAP PATH SWITCH REQUEST ACKNOWLEDGE message is sent by the SMF to the target gNodeB containing user plane integrity protection policy or UE security capabilities if they are different than those received in the NGAP PATH SWITCH REQUEST message. When security-related information is received in the NGAP PATH SWITCH REQUEST ACKNOWLEDGE message, an intra-cell handover is triggered. The security information is synchronized with the UE and the UE is kept in connected state.

If a user plane integrity protection policy change results in a PDU session release, the

target gNodeB sends an NGAP PDU SESSION RELEASE NOTIFY message to the AMF

with a list of the released PDU sessions.

Related Information

NR Mobility

## 3.5 Replay Protection of the Receiving PDCP Layer

The receiving PDCP entity with integrity protection provides improved replay

protection against cases in which a packet is sent with a PDCP hyper frame number value that

is no longer valid.

If the integrity protection is configured, the improved replay protection function is

automatically enabled.

If the integrity verification fails, the failed packet is discarded.

If there is a packet with a duplicate PDCP COUNT, the duplicated

packet is discarded.

## 3.6 User Plane Integrity Protection in NR-DC

User plane integrity protection in NR-DC provides enhanced security for UEs

configured with NR-DC.

The target Secondary Node determines if user plane integrity protection starts,

maintains, or stops for Secondary Node-terminated DRBs during the following NR-DC

procedures:

- Secondary Node Addition
- Secondary Node Initiated Secondary Node Change.

The Secondary Node evaluates the following information to determine if user plane

integrity protection must be applied on the DRB or not:

- The configuration of the security parameters sent by the Master Node in the XnAP S-NODE ADDITION REQUEST message, which contains the following information: Security information received from the Access and Mobility Management Function (AMF) with the following details: Security key Security capabilities of the UE Security indication The user plane integrity protection status set in the Master Node.
- The configuration of the following attributes on the Secondary Node: SecurityHandling.featCtrlIntegProtUserPlane SecurityHandling.integProtUserPlaneLowRate
- The capabilities of the hardware.

Based on the evaluation, the Secondary Node

sets

up Secondary Node-terminated DRBs with or without user plane

integrity protection applied.

The Secondary Node transfers

the

status of user plane integrity protection to the Master Node through

the XnAP S-NODE ADDITION REQUEST ACKNOWLEDGE message.

If the user plane integrity protection configuration differs between the Master Node and

the Secondary Node, the DRBs are released and then re-added to update the security

configuration towards the UE. The value of the PDCP

COUNT is

set

to 0.

The Master Node determines if user plane integrity protection starts, maintains, or stops

for Secondary Node-terminated DRBs that are to be reconfigured into Master

Node-terminated MCG DRBs during the following NR-DC procedures:

- Master Node Initiated Secondary Node Release
- Secondary Node Initiated Secondary Node Release

The Master Node evaluates

the

status of user plane integrity protection used in the Secondary Node

when released. If the user plane integrity protection configuration differs between the

Master Node and the Secondary Node, the DRBs are released and then re-added to update

the security configuration towards the UE. The value of the PDCP

COUNT is

set

to 0.

For more information on the configuration options for user plane integrity protection,

see 3GPP TS 23.501; System architecture for the 5G System (5GS); Stage

2.

# 4 Network Impact of NR Air Interface Protection

The user plane integrity protection function affects CPU load and memory use and

signaling.

Capacity and Performance

The user plane integrity protection function increases the following in the gNodeB

and the UE:

- CPU load
- Memory use

Using the user plane integrity protection function is only recommended for cases if

high-level security is needed as it has the following impacts:

- It increases OTA resource use, as 4 additional bytes are transferred in every transmitted PDCP PDU.
- It might increase UE power consumption.
- It reduces maximum data throughput for bearers that are configured with integrity protection.

When user plane integrity protection is activated, an addition of 4 bytes is

transferred in each PDCP PDU over the Uu interface. This has the following

results:

- Increased CPU processing load and memory usage.
- Reduced peak data throughput due to the additional data processing.

When a Secondary Node terminated split DRB is released and added again due to status

change in user plane integrity protection, a slight temporary increase of packet

loss might be expected.

Interfaces

The feature affects the following interfaces:

- NG-C The following messages contain the NGAP PDU Session Resource Setup Request Transfer IE: NGAP INITIAL CONTEXT SETUP REQUEST NGAP PDU SESSION RESOURCE SETUP REQUEST NGAP HANDOVER REQUEST The NGAP PDU Session Resource Setup Request Transfer IE can contain the SecurityIndication IE, which contains the following IEs in both uplink and downlink traffic: Integrity Protection Indication Confidentiality Protection Indication Note: Confidentiality protection is used for ciphering. Maximum Integrity Protected Data Rate Downlink IE Maximum Integrity Protected Data Rate Uplink IE The following messages contain the SecurityIndication IE: NGAP PATH SWITCH REQUEST NGAP PATH SWITCH REQUEST ACKNOWLEDGE The following NGAP response messages contain the SecurityResult IE: NGAP INITIAL CONTEXT SETUP RESPONSE NGAP PDU SESSION RESOURCE SETUP RESPONSE NGAP HANDOVER REQUEST ACKNOWLEDGE NGAP PDU SESSION RESOURCE MODIFY INDICATION The NGAP PDU Session Resource Setup Response Transfer and the Handover Request Acknowledge Transfer IEs contain the SecurityResult IE.
- Xn-C The XnAP HANDOVER REQUEST message includes the SecurityIndication IE. This indicates the requirements on user plane integrity protection and ciphering for the corresponding PDU session. The XnAP S-NODE ADDITION REQUEST and the XnAP S-NODE ADDITION REQUEST ACKNOWLEDGE messages include the SecurityIndication and SecurityResult IEs.
- Uu The RRC signaling contains information on integrity protection, including signaling parameters for user plane integrity protection that are applicable for UEs configured with NR SA and UEs configured with NR-DC. This indicates whether integrity protection is configured for the radio bearer. The PDCP PDUs have a 4-byte MAC-I appended for integrity protected DRBs in downlink and uplink data transmissions.

Other Network Elements

No impact.

# 5 Parameters for NR Air Interface Protection

This feature introduces and

affects attributes related to integrity protection.

Table 2   Parameters

| Parameter                                        | Type       | Description          |
|--------------------------------------------------|------------|----------------------|
| SecurityHandling.featCtrlIntegProtUserPlane      | Introduced | See MOM description. |
| SecurityHandling.integProtUserPlaneLowRate       | Introduced | See MOM description. |
| IntegrityProtection.integProtUserPlaneCapability | Introduced | See MOM description. |
| SecurityHandling.cipheringAlgoPrio               | Affected   | See MOM description. |
| SecurityHandling.integrityProtectAlgoPrio        | Affected   | See MOM description. |

# 6 Performance of NR Air Interface Protection

The feature has associated KPIs,

resource indicators, and PM counters that are related to user plane integrity

protection.

KPIs

Table 3   Key Performance Indicators

| KPI                                                                                                              | Description                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| UL Packet Loss Captured in gNodeB normalized with out of order                                     PDU delivered | If the feature is activated, the uplink packet loss rate might                                     increase if the integrity verification fails.                                                                                       |
| DRB Accessibility - Success Rate for mapped 5QI                                                                  | If the feature is activated, the DRB accessibility success rate                                     might slightly decrease in case UEs with integrity protection                                     limited to 64 kbps are rejected. |
| Average Overall DL Latency per QoS                                                                               | If the feature is activated, the average overall downlink latency                                     might increase slightly due to additional processing of                                     integrity protection.                |

The following resource indicators might increase slightly because of the additional 4

bytes of MAC-I if the feature is activated:

- DL Volume per Cell
- UL Volume per Cell

The rate at which this feature affects these resource indicators depends on the

traffic model.

Counters

- NRCellCU.pmDrbEstabFailIntgProt
- NRCellCU.pmPduSessionEstabAttIntgProt64kbps
- RpUserPlaneLink.pmPdcpPktRecUlDiscIntgQos
- RpUserPlaneLink.pmPdcpPktRecUlIntgQos
- RpUserPlaneLink.pmPdcpPktTransDlIntgQos
- RpUserPlaneLink.pmPdcpPktLossUlToDiscQos

The following MAC volume PM counters might increase because of the additional 4 bytes

of MAC-I appended to the PDCP PDUs:

- NRCellDU.pmMacVolDl
- NRCellDU.pmMacVolDlDrb
- NRCellDU.pmMacVolDlDrbQos
- NRCellDU.pmMacVolUl
- NRCellDU.pmMacVolUlResUe

The following downlink delay PM counters might increase because of the additional 4

bytes of MAC-I appended to the PDCP PDUs and the integrity protection

processing:

- NRCellDU.pmRlcDelayTimeDl
- NRCellDU.pmRlcDelayPktTransmitDl
- NRCellDU.pmRlcDelayTimeDlQos
- NRCellDU.pmRlcDelayPktTransmitDlQos

Events

The feature has no associated events.

Related Information

License and Resource Use Indicators

# 7 Activate Non-License-Controlled Features

Non-license-controlled features do not require manual activation and cannot be

deactivated.

While license-controlled features need to be activated, non-license-controlled features

are activated automatically during node integration. They also do not

have

a software license key associated, which means that they have no

entries in the LKF that is installed on the node.

In some cases, non-license-controlled features need to be configured

manually or have some of

their

subfunctions enabled to work properly.

# Appendix A: Feature Change History

This section lists changes that affected this feature and the impact it had on the

network.

## Appendix A.a: 22.Q3: NR Air Interface Protection on Baseband 6630 for CPRI Traffic

This feature enhancement makes Baseband 6630 support user plane integrity protection

for CPRI traffic which is a part of the NR Air Interface Protection feature.

| Feature Name           | NR Air Interface Protection   |
|------------------------|-------------------------------|
| Feature Identity       | FAJ 121 5340                  |
| Value Package Name     | NR Base Package               |
| Value Package Identity | FAJ 801 4002                  |
| Node Type              | Baseband Radio Node           |
| Access Type            | NR                            |
| Impact at Upgrade      | Mandatory                     |

Summary and Benefits

The feature enhancement provides the following benefits:

- It adds the user plane integrity protection capability for CPRI traffic on Baseband 6630.
- It enhances the user plane replay protection for CPRI traffic on Baseband 6630.

Capacity and Performance

The hardware capacity of Baseband 6630 might be reduced when the integrity protected

user plane traffic is handled.

Operation

No impact.

Interfaces

No impact.

Hardware

The feature enhancement is supported on Baseband 6630.

The Mixed Mode Baseband configuration for Baseband 6630 is not supported.

Other Network Elements

It is required to use ENM version 21.3 or later for this feature

enhancement.

Related Information

NR Air Interface Protection

## Appendix A.b: 22.Q4: Security Enhancements in Xn-Based Handovers and in Inter-gNodeB RRC Re-establishment

This feature enhancement improves support for the security IEs in Xn-based handovers

and in inter-gNodeB RRC re-establishment, and provides the User Plane (UP) integrity

protection in Xn-based handovers.

| Feature Name:           | NR Air Interface Protection   | NR Mobility         | NR RRC Connection Re-establishment   |
|-------------------------|-------------------------------|---------------------|--------------------------------------|
| Feature Identity:       | FAJ 121 5340                  | FAJ 121 5041        | FAJ 121 5346                         |
| Value Package Name:     | NR Base Package               | NR Base Package     | NR Base Package                      |
| Value Package Identity: | FAJ 801 4002                  | FAJ 801 4002        | FAJ 801 4002                         |
| Node Type:              | Baseband Radio Node           | Baseband Radio Node | Baseband Radio Node                  |
| Access Type:            | NR                            | NR                  | NR                                   |
| Impact at Upgrade:      | Mandatory                     | Mandatory           | Mandatory                            |

Summary and Benefits

With this feature enhancement, when security related information received in

NGAP PATH SWITCH REQUEST ACKNOWLEDGE message, an intra-cell

handover is triggered according to the 3GPP standard. Security information is

synchronized with UE and UE is kept in connected state. This enhancement is

applicable for Xn-based handover and inter-gNodeB RRC re-establishment functions.

UP integrity protection on the target node in Xn-based handover is supported

according to the 3GPP standard.

Capacity and Performance

No impact.

Operation

The CuCpProcNrHoIcPrep and CuCpProcNrHoIcExe

events

are updated with adding the NGAP PATH SWITCH REQUEST ACKNOWLEDGE

message.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

ENM version 22.11 or later is required for this

enhancement.

Related Information

NR Air Interface Protection

NR Mobility

NR RRC Connection Re-establishment

## Appendix A.c: 24.Q2.0: Support for User Plane Integrity Protection on Baseband 6630 Mixed Mode

This feature enhancement introduces support for user plane integrity protection for

Baseband 6630 in mixed mode configuration.

| Feature Name           | NR Air Interface Protection   |
|------------------------|-------------------------------|
| Feature Identity       | FAJ 121 5340                  |
| Value Package Name     | NR Base Package               |
| Value Package Identity | FAJ 801 4002                  |
| Node Type              | Baseband Radio Node           |
| Access Type            | NR                            |
| Impact at Upgrade      | Optional                      |

Summary and Benefits

Traffic security is improved if user plane integrity protection is enabled for

Baseband 6630 in NR+LTE dual mode configuration.

Capacity and Performance

No impact.

Operation

No impact.

Interfaces

No impact.

Hardware

This feature enhancement is applicable only to Baseband 6630 in NR+LTE dual mode

configuration. The hardware capacity of Baseband 6630 might be reduced when the

integrity protected user plane traffic is handled.

Other Network Elements

No impact.

Related Information

NR Air Interface Protection

## Appendix A.d: 24.Q2.0: User Plane Integrity Protection in NR-DC

The feature enhancement introduces support for integrity protection of the user plane

traffic over the air interface in NR-DC.

| Feature Name           | NR Air Interface Protection   |
|------------------------|-------------------------------|
| Feature Identity       | FAJ 121 5340                  |
| Value Package Name     | NR Base Package               |
| Value Package Identity | FAJ 801 4002                  |
| Node Type              | Baseband Radio Node           |
| Access Type            | NR                            |
| Impact at Upgrade      | Mandatory                     |

Summary and Benefits

The feature enhancement enables starting, maintaining, or stopping integrity

protection for user plane traffic over the Uu interface during the following NR-DC

procedures for the UEs configured with NR-DC:

- Secondary Node Addition
- Secondary Node initiated Secondary Node Change
- Master Node initiated Secondary Node Release
- Secondary Node initiated Secondary Node Release

The Secondary Node determines if user plane integrity protection starts, continues,

or stops for Secondary Node terminated DRBs during the following NR-DC

procedures:

- Secondary Node Addition
- Secondary Node initiated Secondary Node Change

If the Master Node adds the Secondary Node with intra-cell handover, the Secondary

Node terminated DRBs are re-established and the security configuration is updated on

the UE.

If the Master Node adds the Secondary Node without intra-cell handover, the Secondary

Node terminated DRBs are released and then re-added to update the security

configuration of the UE.

If the integrity protection configuration differs between the Master Node and the

Secondary Node due to status change, the DRBs reconfigured to be Secondary Node

terminated are released and then re-added to update the security configuration for

the UE.

The Master Node determines if the user plane integrity protection starts, continues,

or stops for Secondary Node terminated DRBs that are to be reconfigured into Master

Node terminated MCG DRBs during the following NR-DC procedures:

- Master Node initiated Secondary Node Release
- Secondary Node initiated Secondary Node Release

If the integrity protection configuration differs between the Master Node and the

Secondary Node due to status change, the DRBs reconfigured to be Master Node

terminated are released and then re-added to update the security configuration for

the UE.

The User Plane Integrity Protection in NR-DC feature enhancement provides enhanced

security for UEs configured with NR-DC, reducing the risk of manipulating the data

sent over the Uu interface.

Capacity and Performance

When the user plane integrity protection is activated for Secondary Node terminated

DRBs in NR-DC, an addition of 4 bytes is transferred in each PDCP Protocol Data Unit

(PDU) over the Uu interface. This has the following results:

- Increased CPU processing load and memory usage.
- Reduced peak data throughput due to the additional data processing.

The impact of the additional 4 bytes in the PDCP PDU transmissions can be monitored

on either the Master Node or the Secondary Node, depending on which node runs the

traffic. The following resource indicators can be used to observe the impact of the

additional 4 bytes in the PDCP PDU transmission:

- DL Volume per Cell
- UL Volume per Cell

The number of XnAP S-NODE ADDITION REQUEST REJECT messages might

increase in case the Secondary Node Addition procedure is rejected due to user plane

integrity protection configuration.

When a Secondary Node terminated split DRB is released and added again due to status

change in user plane integrity protection, a slight temporary increase of packet

loss might be expected.

Uplink packet loss rate might increase if the integrity verification fails. This can

be monitored by using the UL Packet Loss Captured in gNodeB normalized with out of

order PDU delivered KPI.

The feature enhancement impact can be monitored by the following PM counters either

on the Master Node or the Secondary Node, depending on which node runs the

traffic:

- RpUserPlaneLink.pmPdcpPktRecUlDiscIntgQos
- RpUserPlaneLink.pmPdcpPktRecUlIntgQos
- RpUserPlaneLink.pmPdcpPktTransDlIntgQos
- NRCellCU.pmPduSessionIntegrityProtection64kbps
- NRCellCU.pmDrbEstabFailIntgProt

Operation

The feature enhancement allows the use of the following attributes on the Secondary

Node when the UE is configured with NR-DC:

- SecurityHandling.featCtrlIntegProtUserPlane
- SecurityHandling.integProtUserPlaneLowRate
- SecurityHandling.integrityProtectAlgoPrio

Interfaces

This feature enhancement affects the following interfaces:

- Xn-C Additional security parameters are sent through the XnAP S-NODE ADDITION REQUEST and the XnAP S-NODE ADDITION REQUEST ACKNOWLEDGE messages.
- Uu Additional security parameters are sent through the RRCReconfiguration message to the UEs configured with NR-DC.

Hardware

The feature enhancement is supported on all RAN Compute units that support user plane

integrity protection.

Other Network Elements

- ENM It is recommended to use ENM version ENM 23.11 23.3 or later to support the MOM changes introduced by this feature enhancement. If the Release Independence Manager application is used, the MOM changes are supported on earlier ENM versions also.
- UE The feature enhancement increases the UE power consumption due to the additional processing of integrity protection information and the additional 4 bytes in PDCP PDU data transmissions. UE issues might cause throughput drop for some of the UEs when user plane integrity protection is configured on the Secondary Node but ciphering is disabled. UE issues might cause severe throughput drop for some of the UEs when user plane integrity protection activation statuses are not aligned on the Master Node and the Secondary Node, and a High-Band serving cell is unlocked on the Secondary Node.

Related Information

NR-NR Dual Connectivity

NR Air Interface Protection

## Appendix A.e: 24.Q2.0: Streetmacro 6701 Support for User Plane Integrity Protection in NR-DC

The feature enhancement introduces support for integrity protection of the user plane

traffic over the air interface in NR-DC when Streetmacro 6701 is used to implement the

Secondary Node.

| Feature Name           | NR Air Interface Protection   |
|------------------------|-------------------------------|
| Feature Identity       | FAJ 121 5340                  |
| Value Package Name     | NR Base Package               |
| Value Package Identity | FAJ 801 4002                  |
| Node Type              | Baseband Radio Node           |
| Access Type            | NR                            |
| Impact at Upgrade      | Optional                      |

Summary and Benefits

The feature enhancement enables user plane integrity protection for NR-DC Secondary

Node-terminated DRBs in networks with Streetmacro 6701 used to implement the

Secondary Node.

The feature enhancement ensures that the Streetmacro 6701 provides enhanced security

for UEs configured with NR-DC. This reduces the risk of manipulating the data sent

over the Uu interface.

Capacity and Performance

Due to the transfer of additional 4 bytes in each PDCP PDU over the Uu interface, the

following results can be expected on the Secondary Node-terminated DRBs for UEs

configured with NR-DC:

- Increased CPU processing load and memory usage.
- Reduced peak data throughput due to the additional data processing.

If a Secondary Node-terminated split DRB is released and added again due to a status

change in user plane integrity protection, a slight temporary increase of the packet

loss rate is expected.

The following PM counters can be used to monitor the NR Air Interface Protection

feature when the feature enhancement is activated:

- NRCellCU.pmDrbEstabFailIntgProt
- NRCellCU.pmPduSessionEstabAttIntgProt64kbps
- RpUserPlaneLink.pmPdcpPktRecUlDiscIntgQos
- RpUserPlaneLink.pmPdcpPktRecUlIntgQos
- RpUserPlaneLink.pmPdcpPktTransDlIntgQos

Operation

The following attributes can be used to enable and configure user plane integrity

protection on the Secondary Node:

- SecurityHandling.featCtrlIntegProtUserPlane
- SecurityHandling.integrityProtectAlgoPrio
- SecurityHandling.lowRateFunctionality

Interfaces

No impact.

Hardware

The user plane integrity protection over the Uu interface can be enabled on

Streetmacro 6701 used to implement the Secondary Node for the UEs configured with

NR-DC.

Other Network Elements

No specific network requirements.

Related Information

NR Air Interface Protection