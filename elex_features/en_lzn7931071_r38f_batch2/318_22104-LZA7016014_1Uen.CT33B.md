---
complexity_score: 12.5
converted_at: '2025-08-13T06:56:36.661261Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 2
images_saved: 3
original_path: 318_22104-LZA7016014_1Uen.CT33B.html
pictures_extracted: 2
processing_method: docling_multimodal
quality_score: 9.0
source_file: 318_22104-LZA7016014_1Uen.CT33B.html
source_zip: en_lzn7931071_r38f.zip
tables_extracted: 11
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 2796
---

# 

Packet Capture

Contents

![Image](../images/318_22104-LZA7016014_1Uen.CT33B/additional_3_CP.png)

![Image](../images/318_22104-LZA7016014_1Uen.CT33B/additional_3_CP.png)

- Overview
- Dependencies
- Feature Operation
    - Safe Shutdown of Ongoing L3 Interface-Level Packet Capture or L2 Port-Level Frame Capture
- Network Impact
    - Privacy Implications of Packet Capture
- Parameters
- Performance
- Activate the Feature
- Deactivate the Feature
- Engineering Guidelines for Packet Capture
    - Use Packet Capture
    - Example of Using Packet Capture
- Appendix: Feature Change History
    - Appendix: 17.Q3: Packet Capture and IPsec Advanced Trace Alignment
    - Appendix: Packet Capture Filtering Enhancement

# 1 Packet Capture Overview

The feature allows manual remote packet capturing at L3 interface level and frame

capturing at L2 port level to troubleshoot network and protocol problems.

| Feature Name           | Packet Capture                                                                                     | Packet Capture                                                                                     | Packet Capture                                                                                     | Packet Capture                                                                                     |
|------------------------|----------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|
| Feature Identity       | FAJ 121 4759                                                                                       | FAJ 121 4759                                                                                       | FAJ 121 4759                                                                                       | FAJ 121 4759                                                                                       |
| Value Package Name     | NR Base Package                                                                                    | LTE Base Package                                                                                   | WCDMA Base Package                                                                                 | GSM RAN Base Package                                                                               |
| Value Package Identity | FAJ 801 4002                                                                                       | FAJ 801 0400                                                                                       | FAJ 801 0359                                                                                       | FAJ 801 0386                                                                                       |
| Node Type              | Baseband Radio Node                                                                                | Baseband Radio Node                                                                                | Baseband Radio Node                                                                                | Baseband Radio Node                                                                                |
| Access Type            | NR                                                                                                 | LTE                                                                                                | WCDMA                                                                                              | GSM                                                                                                |
| Licensing              | License-controlled feature. One license is required for each                                 node. | License-controlled feature. One license is required for each                                 node. | License-controlled feature. One license is required for each                                 node. | License-controlled feature. One license is required for each                                 node. |

Summary

The feature is used for the efficient inspection of transport network issues,

significantly reducing troubleshooting time and operating expenses. The feature does

not replace existing troubleshooting features, methods, and tools. It is meant to be

used if all other troubleshooting options are exhausted.

The feature captures L3 packets or L2 frames and stores them in an encrypted

file.

Additional Information

For more information on filter syntax rules, see Miscellaneous Information Manual.

# 2 Dependencies of Packet Capture

The feature has L3 packet and L2 frame capturing limitations, IP limitations, and

requires AES-256 encryption support.

Feature Dependencies

There are no dependencies to other features.

Hardware

No specific hardware requirements.

Limitations

The feature has the following L3 interface-level packet capturing or L2 port-level

frame capturing limitations:

- 16,000 packets or frames can be captured in each pcap file.
- Capturing stops once the file reaches the maximum size.
- The feature does not guarantee that consecutive packets are captured on the interface or that consecutive frames are captured on the port.
- L3 interface-level packet capturing and L2 port-level frame capturing only captures Transport Network backhaul traffic.

When filtering is enabled, the following limitations apply:

- Only packets matching the configured filter requirements are saved, counting toward the limit of 16,000 packets.
- The filter string can be maximum 3950 characters long.
- A backslash (\) in the filter string must be escaped by another backslash. Example: "ip proto \\sctp"
- The maximum capture timeout value is 24 hours.
- The "proto [expr:size]" and "proto [expr]" filter expressions are not supported.
- The IpsecTunnel and the PeerIpsecTunnel packets cannot be filtered.
- If the filter string contains two or more words, it must be enclosed in quotation marks.

The feature does not support the following interfaces:

- InterfaceIPv4 without AddressIPv4.
- InterfaceIPv6 without AddressIPv6.
- InterfaceIPv4 configured as loopback.
- InterfaceIPv6 configured as loopback.
- EthernetPort MOs with encapsulation to the RiPort MO instance.
- VlanPort MOs with encapsulation to the RiPort MO instance.
- VlanPort MOs over the EthernetPort MO instance with encapsulation to the RiPort MO instance.
- VlanPort MOs reserved by the following MOs: ENodeBFunction ExternalENodeBFunction GNBDUFunction ExternalGNodeBFunction ExtGNBDUPartnerFunction

Network Requirements

The AES-256 algorithm is used to encrypt thePacketCaptureLog

file. The 256-CTR mode must be installed on the remote server for AES to decrypt the

PacketCaptureLog file. The 256-CTR mode is supported by

OpenSSL v1.0.1 or higher.

# 3 Feature Operation of Packet Capture

The feature provides an inspection tool for network issues if other troubleshooting

options are exhausted.

L3 interface-level packet capturing can be initiated on the following MOs:

- InterfaceIPv4
- InterfaceIPv6
- IpsecTunnel
- PeerIpsecTunnel

L2 port-level frame capturing can be initiated on the following MOs:

- EthernetPort
- VlanPort

L3 packets or L2 frames are captured at the egress or at the ingress flow. The

PacketCaptureLog file is stored in pcap.aes file format in a

temporary file system. The file is encrypted, and it can be exported to a remote server

for detailed analysis. The file can be analyzed with WiresharkÂ® and

other networking tools.

Figure 1 shows the operation of

the feature.

Figure 1   Packet Capture Feature Overview

The feature introduces the following roles for configuration:

## 3.1 Safe Shutdown of Ongoing L3 Interface-Level Packet Capture or L2 Port-Level Frame Capture

If certain configuration changes are made to the target of an ongoing L3

interface-level packet capture or L2 port-level frame capture, the feature safely shuts down

the ongoing packet or frame capturing.

The ongoing L3 interface-level packet capture or L2 port-level frame capture is safely

shut down because of the following MO configurations:

- Changes to the reservedBy attribute of the target MO through configuration changes to other MOs, as the applicable MO reference can impact the target MO as well.
- Any configuration changes are performed directly on the MO on which the L3 interface-level packet capture or L2 port-level frame capture is enabled.Note: The following MO configurations do not affect the ongoing L2 interface-level packet capture or L2 port-level frame capture: Changes to the administrativeState attribute of the target MO. Changes to the underlying encapsulation of the LagPort MO, such as adding or removing members of the LagPort MO.

# 4 Network Impact of Packet Capture

The feature has server configuration requirements for OSS and ENM upgrade.

Capacity and Performance

No impact.

Interfaces

No impact.

Other Network Elements

LDAP server configuration is required during OSS and ENM upgrade.

## 4.1 Privacy Implications of Packet Capture

This feature allows manual remote packet capturing at an interface level. It is used for

troubleshooting of networking and protocol problems and is meant to be used when all

other troubleshooting options are exhausted. IP packets are captured at either the

egress or at the ingress flow, or both. The PacketCaptureLog file is stored in pcap.aes

file format in a temporary file system. The file is encrypted and it can be exported to

a remote server for detailed analysis. The file can be analyzed with Wireshark and other

networking tools. This feature can be used both by Ericsson and operator personnel but

only users with the role Transport\_Application\_SecurityAdministrator can access privacy

related data.

For more information, see Feature Description Packet Capture.

# 5 Parameters of Packet Capture

The feature introduces the PacketCapture MO class that can be

configured using MO actions.

MO Actions

The following MO actions under the PacketCapture MO instance are

used for this feature:

- PacketCapture.export
- PacketCapture.start
- PacketCapture.status
- PacketCapture.stop

# 6 Performance of Packet Capture

The feature has no associated performance management entities.

KPIs

The feature has no associated KPIs.

Counters

The feature has no directly associated counters.

Events

The feature has no associated events.

# 7 Activate Packet Capture

To use the feature, it must be activated following the usual feature activation

procedure.

Prerequisites

The following prerequisites are mandatory:

- The license key is installed in the node.
- CCTR is active for at least one week before this procedure to collect enough troubleshooting data.

The following prerequisites are optional:

- The IPv6 feature must be activated if an IPv6 interface is used.
- The IPsec feature must be activated if an IPsec inner interface, the IpsecTunnel MO, or the PeerIpsecTunnel MO is used.
- A license key for the Ethernet Link Aggregation feature must be activated if the interface is encapsulated with the LagPort MO.

Steps

1. Set the FeatureState.featureState attribute to ACTIVATED in the FeatureState=CXC4012131 MO instance.

After This Task

Keep CCTR active for at least one week after this procedure for continued collection of troubleshooting data.

# 8 Deactivate Packet Capture

If the feature is no longer needed, it can be deactivated following the usual feature

deactivation procedure. It must also be deactivated before the activation of any conflicting

feature.

Prerequisites

CCTR is active for at least one week before this procedure to collect enough troubleshooting data.

Steps

1. Set the FeatureState.featureState attribute to DEACTIVATED in the FeatureState=CXC4012131 MO instance.

After This Task

Keep CCTR active for at least one week after this procedure for continued collection of troubleshooting data.

# 9 Engineering Guidelines for Packet Capture

The PacketCapture MO can be configured using MO

actions.

## 9.1 Use Packet Capture

Prerequisites

- The FeatureState.featureState attribute is set to ACTIVATED in the FeatureState=CXC4012131 MO instance.
- The InterfaceIPv4 or the InterfaceIPv6 MO is configured.
- The user is assigned the Transport\_Application\_SecurityAdministrator role.
- The node has an active SFTP server.
- Optionally, to capture IPsec traffic, the IpsecTunnel, or the PeerIpsecTunnel MO is configured.

Steps

1. Create a PacketCapture MO instance under the Transport MO.
2. Start the L3 interface-level packet capture or the L2 port-level frame capture by initiating the PacketCapture.start action. Note: Optional settings can be used for filtering and timeout options.
3. Check the status of capturing by initiating the PacketCapture.status action.
4. Stop the capturing by initiating the PacketCapture.stop action.
5. Export the PacketCaptureLog file to the server by initiating the PacketCapture.export action.
6. Decrypt the PacketCaptureLog file using the openssl command. openssl enc -aes-256-ctr -d -in &lt;encrypted\_file&gt; -out &lt;decrypted\_file&gt; -k &lt;passphrase&gt; -md md5. For more information about the PacketCaptureLog, see Manage Transport Network.

## 9.2 Example of Using Packet Capture

A practical example of using the Packet Capture feature.

Steps

1. Create a PacketCapture=1 MO instance under the Transport=1 MO. Example: cr Transport=1,PacketCapture=1.
2. Start the packet capture.
    - Without filtering enabled Example: mcc PacketCapture=1 start --interfaceLdn "ManagedElement=1,Transport=1,Router=LTECP,InterfaceIPv4=TN\_A\_CP" --count 16000.
    - With filtering enabled through specifying the string filter and the uint32 captureTimeout arguments Example: mcc PacketCapture=1 start --interfaceLdn "ManagedElement=1,Transport=1,Router=1, InterfaceIPv4=1" --filter "src host 1.2.3.4 and ip proto \\sctp and dst port 38412" --captureTimeout 1800.
    - With timeout enabled Example: mcc PacketCapture=1 start --interfaceLdn "ManagedElement=1,Transport=1,Router=1,InterfaceIPv4=1" --captureTimeout 600
3. Check the status of capturing. Example: mcc PacketCapture=1 status.
4. Stop the capturing manually or it will stop automatically after packet count limit is reached. Example: mcc PacketCapture=1 stop.
5. Export the PacketCaptureLog file to OSS in encrypted form. Example: mcc PacketCapture=1 export --uri sftp://OSSUSERNAME@OSSIP/tmp/ --password &lt;encryption\_password&gt; --uripassword OSSPASSWORD.
6. Decrypt the PacketCaptureLog file using the openssl command. Example: openssl enc -aes-256-ctr -d -in PacketCaptureLog.20180612T074302+0000.pcap.aes -out PacketCaptureLog.20180612T074302+0000.pcap -k Test12345678 -md md5.

# Appendix A: Feature Change History

This section lists changes that affected this feature and the impact it had on the

network.

## Appendix A.a: 17.Q3: Packet Capture and IPsec Advanced Trace Alignment

This is an alignment on the Packet Capture feature and the IPSec function for the same user experience.

| Feature Name:           | Packet 								Capture   |
|-------------------------|--------------------------|
| Feature Identity:       | FAJ 121 4759 R1          |
| Value Package Name:     | LTE Base Package         |
| Value Package Identity: | FAJ 801 0400 R8          |
| Node Type:              | Baseband Radio Node      |
| Access Type:            | LTE                      |

Change is to align the Packet Capture feature and the IPSec advance traces function so that the

end user has the same experience by using them. The current IPsec advance traces COM CLI

commands is replaced by the PCF commands which are available under PacketCapture MO.

Capacity and Performance

No impact.

Operation

- PCF COM CLI commands are executed under the PacketCapture MO to capture packets on the following: Interface IPv4/IPv6 IpsecTunnel PeerIpsecTunnel MO
- All capture packets including "IPsec advance traces" are stored in the PacketCaptureLog.pcap file.
- The TnPacketLog.pcap file is no longer used.

Interfaces

No impact.

Hardware

All Baseband products

Other Network Elements

No impact.

## Appendix A.b: Packet Capture Filtering Enhancement

The feature enhancement adds a filtering option to the Packet Capture feature which

allows the user to only capture packets that match the filtering criteria and introduces a

timeout option to control the length of the capturing session.

| Feature Name           | Packet Capture      | Packet Capture      | Packet Capture      | Packet Capture       |
|------------------------|---------------------|---------------------|---------------------|----------------------|
| Feature Identity       | FAJ 121 4759        | FAJ 121 4759        | FAJ 121 4759        | FAJ 121 4759         |
| Value Package Name     | NR Base Package     | LTE Base Package    | WCDMA Base Package  | GSM RAN Base Package |
| Value Package Identity | FAJ 801 4002        | FAJ 801 0400        | FAJ 801 0359 R38    | FAJ 801 0386         |
| Node Type              | Baseband Radio Node | Baseband Radio Node | Baseband Radio Node | Baseband Radio Node  |
| Access Type            | NR                  | LTE                 | WCDMA               | GSM                  |
| Impact at Upgrade      | Mandatory           | Mandatory           | Mandatory           | Mandatory            |

Summary and Benefits

The feature enhancement introduces a filtering option to only capture the packets

that match the troubleshooter requirements translated into filter syntax. It also

adds a mandatory parameter to configure the length of the session when filtering is

used and an optional time-out when filtering is not used.

The benefit of the feature enhancement is that it reduces troubleshooting time.

Capacity and Performance

No impact.

Operation

The start CLI command under the PacketCapture

MO is extended with the following arguments:

| filter         |    | Filter expression for packet filtering (Optional)   |
|----------------|----|-----------------------------------------------------|
|                |    |                                                     |
| captureTimeout |    | Duration of packet capturing (1â86400) (Optional)   |

The packet-capture status CLI command is extended with the

following display information:

| filter         |    | Applicable if the filter argument is set                                                                                                                                                                                   |
|----------------|----|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                |    |                                                                                                                                                                                                                            |
| captureTimeout |    | Total capture time if other ending packet capture criteria are not met                             (applicable if the captureTimeout argument is                             set)                                          |
|                |    |                                                                                                                                                                                                                            |
| remainingTime  |    | Remaining time to the end of the session (applicable if the count limit                             is not reached earlier or the PacketCaptureLog file                             size does not exceed 23MB size before) |

The string filter and the uint32 captureTimeout

arguments are only supported for the following MOs:

- EthernetPort
- VlanPort
- InterfaceIPv4
- InterfaceIPv6

Interfaces

No impact.

Hardware

No specific hardware requirements.

Other Network Elements

Without the Release Independence Manager application, this feature enhancement

requires ENM version 25.2 or later. The Release Independence

Manager application also supports the feature enhancement on earlier supported ENM

versions.

Related Information

Packet Capture