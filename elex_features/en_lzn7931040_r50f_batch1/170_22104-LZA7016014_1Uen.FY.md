---
complexity_score: 37.5
converted_at: '2025-08-13T06:59:17.932142Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 6
images_saved: 3
original_path: 170_22104-LZA7016014_1Uen.FY.html
pictures_extracted: 6
processing_method: docling_multimodal
quality_score: 9.0
source_file: 170_22104-LZA7016014_1Uen.FY.html
source_zip: en_lzn7931040_r50f.zip
tables_extracted: 57
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 1893
---

# 

IPsec

Baseband Radio Node

Contents

![Image](../images/170_22104-LZA7016014_1Uen.FY/additional_3_CP.png)

![Image](../images/170_22104-LZA7016014_1Uen.FY/additional_3_CP.png)

- Overview
- Dependencies
- Feature Operation
    - Network View
    - Process Steps
    - Functions and Concepts
- Network Impact
- Parameters
- Performance
- Activate the Feature
- Deactivate the Feature
- Engineering Guidelines
- Feature Change History
    - IPSec Certificate Revocation for Direct X2
    - IPsec Configurable Policies
    - Automatic Direct X2 IPsec Tunnel Setup
    - 17.Q4: IPv6 on Outer Network
    - 17.Q4: IKE v2 Configuration Payload
    - 17.Q4: NAT Traversal
    - 17.Q4: Enrollment of Two Credentials for IPsec
    - IKEv2 Configuration Payload for Iub
    - 18.Q1: Cipher Modernization for IPsec
    - 18.Q3: Support for IPsec Active-Standby Redundancy
    - 19.Q1: Increased Number of IPsec Tunnels in Virtual Router
    - 19.Q4: Support for Direct IPsec VPN Connection for X2 to eNodeB
    - 20.Q1: Enhancement for Direct X2 IPsec VPN Connection to the gNodeB
    - 20.Q1: Support for Mix of IPv4 and IPv6 Traffic in the Same IPsec VPN
    - 20.Q2: IPsec DPD Message Optimization
    - 20.Q3: IKEv2 Fragmentation
    - 20.Q3: Increased Retransmission Period at Longer DPD Time
    - 20.Q4: Automatic Direct X2 IPsec VPN Connection for EN-DC
    - 21.Q1: Single Direct IPsec between Basebands
    - 21.Q4: Interface State Tracking and PBR in the Inner Router
    - 22.Q2: Single Direct IPsec Between Basebands for IPv4 and IPv6
    - 22.Q4: Support for Direct IPSec VPN Connection for Xn to gNodeB
    - 24.Q1.0: Increased Number of System Limits and License Removal for Virtual Routers
    - 24.Q2.0: TN IPsec Support for New Algorithms
    - 25.Q1.0: Short DPD Timer Setting

# 1 IPsec Overview

The IPsec feature uses IPsec ESP to provide security functionality for the IP

layer.

| Feature Name           | IPsec                                                                      | IPsec                                                                      | IPsec                                                                      | IPsec                                                                      |
|------------------------|----------------------------------------------------------------------------|----------------------------------------------------------------------------|----------------------------------------------------------------------------|----------------------------------------------------------------------------|
| Feature Identity       | FAJ 121 0804                                                               | FAJ 121 0804                                                               | FAJ 121 3586                                                               | FAJ 121 0804                                                               |
| Value Package Name     | NR Base Package                                                            | IPsec                                                                      | IPsec                                                                      | Baseband IPsec GSM RAN                                                     |
| Value Package Identity | FAJ 801 4002                                                               | FAJ 801 0417                                                               | FAJ 801 0516                                                               | FAJ 801 0747                                                               |
| Node Type              | Baseband Radio Node                                                        | Baseband Radio Node                                                        | Baseband Radio Node                                                        | Baseband Radio Node                                                        |
| Access Type            | NR                                                                         | LTE                                                                        | WCDMA                                                                      | GSM                                                                        |
| Licensing              | License-controlled feature. One license is required for each 								node. | License-controlled feature. One license is required for each 								node. | License-controlled feature. One license is required for each 								node. | License-controlled feature. One license is required for each 								node. |

Summary

The IPsec feature uses IPsec ESP to provide the following for the IP layer:

- confidentiality
- authentication
- integrity protection
- anti-replay protection

The tunnel mode of IPsec also adds the VPN aspect, where IPsec can be used to

tunnel network traffic within one network over a third party network.

The

node supports IPsec using ESP tunnel mode for terminated IP traffic in the node.

IKEv2 is used as the control protocol. ESP processing is in compliance with RFC

4303, and the IKEv2 related processing is in compliance with RFC 7296. The node also

follows the applicable parts of the principles as defined in RFC 4301 security

architecture and the 3GPP security specifications (TS 33.210, TS 33.310, TS

33.401).

IPsec is used to protect user and control plane traffic (for example S1, X2, Iub, and Abis)

and OAM traffic.

Additional Information

More information about this feature and related topics can be found in the following

documentation:

- System Description
- Manage IPsec

# 2 Dependencies of IPsec

Table 1   Feature Dependencies

| Feature                                                                            | Relationship   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|------------------------------------------------------------------------------------|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CMPv2 (FAJ 121 4142)                                                               | Prerequisite   | IPsec needs certificate installed in the node, therefore this feature                                 is required.                                                                                                                                                                                                                                                                                                                                                                          |
| Multiple IP Addresses for S1 and X2 (FAJ                                 121 4697) | Related        | Between two shared nodes, the direct IPsec VPN connection for X2 is                                 established for the primary PLMN.  If the two shared nodes have different primary PLMNs, the direct                                 IPsec VPN connection is established for the primary PLMN of one of                                 the nodes. Only traffic between the selected inner IP addresses is                                 sent through the direct IPsec VPN connection. |
| Shared LTE RAN (FAJ 121 0860)                                                      | Related        | Direct IPsec for LTE and EN-DC X2 is not supported for             eNodeBs in a MORAN on single Baseband configuration. In this case, the                 ENodeBFunction.ipsecEpAddressRef and the                 ENodeBFunction.ipsecEndcEpAddressRef attributes must be             empty.                                                                                                                                                                                               |

Hardware

No

specific

hardware

requirements.

Limitations

No known limitations.

Network Requirements

The IPsec feature requires a security gateway to terminate IPsec at the remote end.

For detailed operational requirements on the security gateway, see Manage IPsec.

IPsec also requires a PKI to handle certificates needed for authentication. The PKI

system can be located in the trusted network and integrated with the ENM, or can be

standalone either in the trusted or untrusted network. However, it is recommended to

use a PKI system from Ericsson. When using a PKI system in the untrusted network, it

is possible to enroll certificates before setting up a temporary IPsec VPN. The

enrolled certificate can authenticate the IPsec VPN. In this case, the network

services must be prepared to support autointegration.

This feature does not mandate which certificate authority product is used to sign the

node certificate in the security gateway.

IKEv2 Configuration Payload is optionally used to assign the inner IP transport

configuration of an IP host. IKEv2 Configuration Payload can only be used if the

security gateway supports it. IKEv2 Configuration Payload can only be used if the

node is managed by ENM.

# 3 IPsec Operation

## 3.1 Network View

Figure 1   Example of Typical Usage of IPsec

Three different networks are used, one outer network, and two inner networks. The outer

network is the untrusted network that provides the transport to and from the Baseband Radio

node. The inner networks are an OAM network and a user or control plane network. Both inner

networks are trusted. The inner and outer networks are completely separated and use their own

addressing and routing. The Baseband Radio node has one local address in each network.

The transport of the inner traffic between the Baseband Radio Node and the SEG over the outer

network

is done through an IPsec VPN connection. An IPsec VPN connection consists of one IKE SA and

one or more child SA pairs. An IPsec VPN connection is defined by the two endpoints in the

outer network. Because of this, the two IPsec VPN connections cannot share the same pair of

local and remote addresses in the outer network.

In this scenario the Baseband Radio node has two IPsec VPN connections, one for each inner

network. Both share the local outer address, but use different remote outer addresses for the

security gateways.

A common industry term for an IPsec VPN connection is IPsec tunnel. However, there are

multiple definitions of an IPsec tunnel, so this document does not use the term.

Any of the following combinations of IPv4 and IPv6 addresses is possible in the inner and

outer networks for an IPsec VPN connection:

- Only IPv4 address for both networks.
- Only IPv6 address for both networks.
- IPv4 address in one network and IPv6 address in the other network.
- Either IPv4 or IPv6 address in the outer network and both IPv4 and IPv6 addresses in the inner network.

IPsec NAT traversal is supported if IPv4 is used in the outer network. In that case, the

Baseband Radio node can be behind a NAT device.

Normally, certificate based authentication is used. Thus, valid credentials (node certificate

and trusted certificates) must be installed in the Baseband-based node for the IPsec function

to work. See Manage

Security for more information.

The certificate authority that signs the IPsec node certificate is part of a PKI system. The

PKI system can be located in the trusted network and integrated with the ENM, or can be

standalone either in the trusted behind security gateway or untrusted network. When using a

PKI system in the trusted network, a Vendor Credential (Ericsson-specific certificate) is

needed to authenticate the initial IPsec VPN connection. When using a PKI system in the

untrusted network, the operator certificate can be used to authenticate the initial IPsec VPN

connection. It is possible to have up to eight different IPsec node certificates, groups of

trusted certificates, or PKI systems. Each IPsec VPN connection can use one of these IPsec

node certificates and groups of trusted certificates.

IPsec During Autointegration

For more information about IPsec during integration, see Integration Infrastructure Guidelines.

## 3.2 Process Steps

Figure 2 gives a high level overview of the

structure of IPsec related functionality in the node. The inner and outer networks are

represented as different virtual routers in the node. The virtual router representing

the outer network typically contains interfaces using VLAN/Ethernet as L2 technology

while the virtual router representing the inner network has a tunnel interface. Each

IPsec VPN connection is represented as one tunnel interface. Each virtual router has its

own routing function and both routing and address allocation are completely independent

between the different virtual routers. The normal routing function in the virtual router

decides which traffic is routed out on an interface. This decision is independent

whether the interface is a tunnel interface or an Ethernet/VLAN interface.

Operational Process

Figure 2   Operational Sequence Diagram

The operational steps are the following:

1. The IPsec control function negotiates (based on the MO configuration) IKE- and Child SAs and populate the security policy database and SAD in the data plane.
2. Packets that are routed out on the inner are associated with a matching Child SA and encapsulated in an outer packet using cryptographic algorithms for the Child SA in question.
3. In the incoming direction ESP packets received are mapped towards an established Child SA and decrypted and processed according to the agreed cryptographic algorithms for that Child SA. The node checks that the received inner packet is compliant to the agreed traffic selector prior to forwarding the packet to the tunnel interface on the virtual router representing the inner network.

## 3.3 Functions and Concepts

### 3.3.1 Cryptographic Algorithms

Different cryptographic algorithms, or transforms, can be used for

SA

key generation and protection.

The supported algorithms are in accordance with 3GPP TS 33.210.

The supported ESP algorithms are in compliance with RFC 8221, with the exception of

AUTH\_HMAC\_MD5\_96, which is supported for backward compatibility reasons even though MUST

NOT in RFC 8221.

The supported IKEv2 algorithms are in compliance with RFC 8247, with the exception of

AUTH\_HMAC\_MD5\_96 and PRF\_HMAC\_MD5, which are supported for backward compatibility

reasons even though MUST NOT in RFC 8247.

Table 2   Supported Encryption and Integrity Algorithms for ESP

| Name                   | Type       | Key Length   |   RFC |
|------------------------|------------|--------------|-------|
| ENCR_AES_GCM_16        | Combined   | 128/256      |  4106 |
| ENCR_CHACHA20_POLY1305 | Combined   | 256          |  7634 |
| AUTH_AES_GMAC          | Combined   | 128/256      |  4543 |
| ENCR_AES_CBC           | Encryption | 128/256      |  3602 |
| ENCR_NULL              | Encryption | N/A          |  2410 |
| AUTH_HMAC_SHA2_256_128 | Integrity  | 256          |  4868 |
| AUTH_HMAC_SHA2_512_256 | Integrity  | 512          |  4868 |
| AUTH_HMAC_SHA1_96      | Integrity  | 160          |  2404 |
| AUTH_AES_XCBC_96       | Integrity  | 128          |  3566 |
| AUTH_HMAC_MD5_96       | Integrity  | 128          |  2403 |

Table 3   Supported Encryption and Integrity Algorithms for IKEv2

| Name                   | Type       | Key Length   |   RFC |
|------------------------|------------|--------------|-------|
| ENCR_AES_GCM_16        | Combined   | 128/256      |  5282 |
| ENCR_CHACHA20_POLY1305 | Combined   | 256          |  7634 |
| ENCR_AES_CBC           | Encryption | 128/256      |  3602 |
| ENCR_3DES              | Encryption | 168          |  2451 |
| AUTH_HMAC_SHA2_256_128 | Integrity  | 256          |  4868 |
| AUTH_HMAC_SHA2_512_256 | Integrity  | 512          |  4868 |
| AUTH_HMAC_SHA2_384_192 | Integrity  | 384          |  4868 |
| AUTH_HMAC_SHA1_96      | Integrity  | 160          |  2404 |
| AUTH_AES_XCBC_96       | Integrity  | 128          |  3566 |
| AUTH_HMAC_MD5_96       | Integrity  | 128          |  2403 |

Table 4   Supported Pseudo-Random Functions

| Name              |   RFC |
|-------------------|-------|
| PRF_HMAC_SHA2_256 |  4868 |
| PRF_HMAC_SHA2_512 |  4868 |
| PRF_HMAC_SHA2_384 |  4868 |
| PRF_HMAC_SHA1     |  2104 |
| PRF_AES128_XCBC   |  4434 |
| PRF_HMAC_MD5      |  2104 |

Table 5   Supported Diffie-Hellman Groups

|   Group | Name               |   RFC |
|---------|--------------------|-------|
|      19 | 256-bit random ECP |  5903 |
|      20 | 384-bit random ECP |  5903 |
|      14 | 2048-bit MODP      |  3526 |
|       2 | 1024-bit MODP      |  7296 |

By default, the node proposes all supported algorithms as transforms in the IKE and Child

SA negotiation to the SEG. It is then the SEG that decides which algorithms to use. It

is however possible to configure specific algorithms to be used in the node.

The ENCR\_NULL and AUTH\_AES\_GMAC algorithms are not proposed by default. If these

algorithms are desired, they must be explicitly configured.

The algorithms are listed in priority order in a default configuration. For

ENCR\_AES\_GCM\_16, 128-bit key length has higher priority than 256. For ENCR\_AES\_CBC,

256-bit key length has higher priority.

### 3.3.2 IPsec Overhead

When using IPsec, the packet size increases due to the overhead from the ESP protocol.

With ESP tunnel mode, which is used by Baseband, the packet size also increases with the

outer IP header of 20 or 40 bytes, dependent on the outer IP version. In case of IPv4 in

the outer network, there is an additional 8 bytes overhead for UDP encapsulation if the

Baseband is behind a NAT device. For more information, see NAT Traversal.

The different components of the ESP overhead are listed in Table 6.

Table 6   Maximum ESP Overhead

| Overhead Field                        |   Size (bytes) |
|---------------------------------------|----------------|
| ESP header (SPI 4, sequence number 4) |              8 |
| Initialization Vector (IV)            |             16 |
| Padding                               |             15 |
| ESP tail (PAD length, next header)    |              2 |
| Integrity Check Value (ICV)           |             32 |
| Total                                 |             73 |

The ESP overhead depends on the combination of encryption and integrity algorithms.

The ESP header and

tail are together 10 bytes regardless of algorithms, but the IV

and Padding depend on the encryption algorithm, and the ICV depends on

the integrity algorithm.

Table 7   IV,

Padding

and ICV Depending on

Algorithm

| Algorithm           | IV   | Padding   | ICV   |
|---------------------|------|-----------|-------|
| NULL                | 0    | 0         | N/A   |
| AES_CBC             | 16   | 0–15      | N/A   |
| AES_GCM_16/AES_GMAC | 8    | 0–3       | 16    |
| CHACHA20_POLY1305   | 8    | 0–3       | 16    |
| SHA2_256            | N/A  | N/A       | 16    |
| SHA2_512            | N/A  | N/A       | 32    |
| SHA1/XCBC/MD5       | N/A  | N/A       | 12    |

The minimum and maximum ESP overhead depending on algorithm is listed in Table 8. The difference between minimum and

maximum overhead depends on the needed padding, which depends on the size of each inner

IP packet to be sent.

Table 8   ESP Overhead Depending on Algorithms

| Algorithm                             | ESP Overhead   |
|---------------------------------------|----------------|
| AES_GCM_16/AES_GMAC/CHACHA20-POLY1305 | 34–37          |
| AES_CBC + SHA2_256                    | 42–57          |
| AES_CBC + SHA2_512                    | 58–73          |
| AES_CBC + SHA1*                       | 38–53          |
| NULL + SHA2_256                       | 26             |
| NULL + SHA2_512                       | 42             |
| NULL + SHA1*                          | 22             |

### 3.3.3 Adjustment of Inner MTU and Fragmentation

Protection of outgoing traffic that requires fragmentation is supported.

Pre-fragmentation, that is the fragmentation of the inner IP packet before IPsec

processing, applies in most cases.

To prevent post-fragmentation and double fragmentation, the MTU for the inner interface

is automatically adjusted based on the MTU for the outer interface and the maximum IPsec

overhead for the negotiated algorithms.

Both configured MTU, and PMTU in case of IPv6, are considered.

If multiple Child SA pairs are established for an IPsec VPN connection, different

algorithms can be negotiated for the different Child SA pairs. The MTU for the inner

interface is adjusted based on the algorithm with the largest overhead.

As an example, the inner MTU is adjusted to 1423 bytes, if IPv6 is used in both inner and

outer network, both inner and outer MTU use default configuration of 1500 bytes, and

AES\_GCM\_16 is the negotiated algorithm:

1500B (outer MTU) - 40B (outer IP header) - 37B (maximum ESP overhead)

There is one exception when post-fragmentation or double fragmentation can happen in the

Baseband Radio Node. In case of IPv6 inner interface, the inner MTU cannot be less than

1280 bytes. If the MTU on the outer interface is too small, and inner MTU cannot be

fully adjusted, there is a risk of post-fragmentation.

Both the outer and the inner IP packets can be reassembled.

### 3.3.4 IKEv2 Fragmentation

IKEv2 fragmentation, according to RFC 7383, is supported to avoid IP fragmentation of

large IKEv2 messages. This allows the IKEv2 messages to traverse network devices that do

not allow IP fragments to pass through. This is mainly relevant for the IKE\_AUTH

messages in case large certificates or certificate chains are used.

The use of IKEv2 fragmentation is negotiated in the IKE\_INIT exchange. If IKEv2

fragmentation is enabled on both peers, the Baseband Radio Node fragments the payload of

large IKEv2 messages before encryption and authentication. For IPv4, the resulting IP

packet size is maximum 576 bytes, and for IPv6 maximum 1280 bytes. The Baseband Radio

Node is also prepared to receive fragmented IKEv2 messages.

By default, IKEv2 fragmentation is not enabled in the Baseband Radio Node and large IKEv2

messages can be fragmented on IP level instead.

IKEv2 fragmentation is not used when establishing the first temporary IPsec VPN

connection during autointegration.

### 3.3.5 Dead Peer Detection

The Dead Peer Detection (DPD) is used to check if an IPsec VPN connection is working.

Incoming IKE messages and incoming ESP traffic prove that the peer is alive and

reachable. If there are no incoming IKE messages or ESP traffic for an established IPsec

VPN connection, the Baseband Radio Node sends a DPD request in the form of an empty

IKE INFORMATIONAL request at regular intervals. A received

IKE INFORMATIONAL response means that the peer is alive.

If there is no response from the peer for a sent IKE request, the Baseband Radio Node

retransmits the IKE request several times before it considers the peer dead.

Retransmission of an IKE request in the absence of response applies to any kind of IKE

request.

The time required to detect if the peer is dead is called DPD time. The DPD time is

configurable in the Baseband Radio Node. Internally, the DPD time is translated into a

retransmission scheme and a DPD interval.

The retransmission scheme consists of:

- Tries: The number of retransmissions.
- Timeout: The time until the first retransmission.
- Base: The exponential backoff for following retransmissions.

The DPD interval is the time between DPD requests when there is no incoming IKE

message or ESP traffic.

By default, the DPD time is 60 seconds. In this case, the retransmission scheme has two

tries, a timeout value of 3 seconds and a base value of two. This

means

that there are two retransmissions (tries) of an IKE request if there

is no response from the peer. The first retransmission is sent after timeout, which is 3

seconds. The time after each retransmission is doubled since the base value is two. This

gives a retransmission period of 21 seconds after the first IKE request. To detect if

the peer is dead within 60 seconds, a DPD request is sent by no later than 39 seconds

after the last incoming IKE message or ESP traffic.

Figure 3   Default DPD Time of 60 Seconds

The number of retransmissions increases depending on the DPD time, to a maximum of five

retransmissions. The time between the retransmissions doubles each time, except for a

very short DPD time (5-9 seconds). The maximum retransmission period is 189 seconds. The

DPD interval also increases, depending on the DPD time.

Figure 4   Maximum Number of Retransmissions with DPD Time of 228 Seconds or More

The increased number of retransmissions based on the DPD time applies to any IKE request,

except for the IKE DELETE request. For the IKE

DELETE request, there are no more than two retransmissions.

The shortest DPD time is 5 seconds. With such a short DPD time, the time between the

retransmissions is only 1 second. There are still two retransmissions but the time

between the retransmissions do not increase (base=1). This gives a retransmission period

of 3 seconds and a DPD interval of one second.

Figure 5   Shortest DPD Time of 5 Seconds

The described DPD mechanism applies to IPsec VPN connections to the SEGs. For direct

IPsec VPN connections, there are some

exceptions:

- ESP traffic is not considered, and DPD requests are sent when there are no incoming IKE messages.
- The DPD interval is the double.
- There is no more than one retransmission for IKE DELETE requests.

When the peer has been detected dead and the IKE SA has been taken down, new attempts to

reestablish the IKE SA are done until successful. IKE INIT requests and retransmissions

are repeated in the same way.

With default DPD time, the IPsec VPN connection recovers within 12 seconds after the SEG

recovers.

Figure 6   Recovery with Default DPD Time of 60 Seconds

With very short DPD time, the pressure on the SEG at recovery could be rather high with

INIT requests (or retransmissions) every second. This could be problematic if there are

many RBSes. It is therefore possible to configure a random delay between the

retransmission periods to reduce the load on the SEG. With the random delay, the IPsec

VPN connection recovers within 31 seconds (when DPD time is 5 seconds) after the SEG

recovers.

Figure 7   Recovery Including Random Delay with Shortest DPD Time of 5 Seconds

Instead of configuring the DPD time directly, tuning the DPD mechanism by changing the

retransmission scheme and the DPD interval is an alternative approach to set DPD time.

This provides more flexibility to the setting, such as more retransmissions with less

time in between, or longer time between DPD requests.

### 3.3.6 NAT Traversal

NAT-T is supported for IPsec VPN connections to SEG if IPv4 is used in the outer network.

The Baseband Radio Node can be behind a NAT device.

NAT-T includes detection of a NAT device during the IKE negotiation as described in RFC

7296, and UDP encapsulation of ESP packets using port 4500 as described in RFC 3948 in

case there is a NAT device.

If a NAT device is detected, IKE messages are sent and received using port 4500 instead

of 500. UDP encapsulation of ESP packets using port 4500 also apply. In this case the

IPsec overhead increases with the 8 bytes UDP header.

If there is no NAT device, the Baseband Radio Node can receive IKE messages on both port

500 and 4500 but sends IKE massages using port 500. Both normal ESP packets as well as

UDP encapsulated ESP packets can be received, but UDP encapsulation is not used for sent

ESP packets.

NAT-T is not supported for direct IPsec VPN connections for X2 and Xn.

### 3.3.7 Interface State Tracking

Interface state tracking function allows a loopback interface to inherit the operational

state of a tunnel interface in the same inner router. This way, the operational state of

the loopback interface can reflect the state of the corresponding IPsec VPN

connection.

### 3.3.8 PBR in the Inner Router

When using PBR in the inner router, the next hop for each PBR rule have a reference to a

tunnel interface. Traffic to the same destination can be routed through different IPsec

VPN connections based on the source address.

PBR in the inner router supports both IPv4 and IPv6 originated traffic.

The availability of the next hop for a PBR rule in the inner router depends on the state

of the IPsec VPN connections. Neither BFD, OSPFv2, nor next hop redundancy are supported

for PBR in the inner router.

For more information about PBR, see Policy Based Routing.

### 3.3.9 Direct IPsec VPN Connections for X2 and Xn

In a basic IPsec configuration, all traffic to and from the Baseband Radio Node is sent

through the SEG. Direct IPsec VPN connections are supported for X2 and Xn in Baseband

Radio Nodes to meet the delay constraints for the following types of traffic:

- EN-DC X2 traffic
- Inter-eNodeB carrier aggregation for LTE X2 traffic
- NR-DC Xn traffic

Direct IPsec VPN connection for X2 and Xn can be set up between eNodeBs and gNodeBs

from Ericsson.

Figure 8   Direct IPsec VPN Connection for LTE X2, EN-DC X2 and Xn

Direct IPsec for X2 and Xn is enabled by configuring the local outer IP address, that is,

the local IPsec endpoint.

Different local IPsec endpoints can be configured for different PLMNs and direct IPsec

for different PLMNs can be enabled individually. Between two shared nodes, there is only

one direct IPsec VPN connection, that is for the primary PLMN. If the two neighbor nodes

have different primary PLMNs, the direct IPsec VPN connection is established for one of

these primary PLMNs supported by both nodes. For EN-DC X2, the primary PLMN of the

eNodeB is used.

For the primary PLMN in the eNodeB, it is possible to configure one IPv4 and one IPv6

local IPsec endpoint for LTE X2 traffic. If both are configured, one is selected for

each LTE X2 neighbor, IPv6 is preferred. One of the local IPsec endpoints for LTE X2

traffic can be reused for EN-DC X2 traffic, or a separate local IPsec endpoint can be

configured for EN-DC X2 traffic. Because of this, it is possible to enable direct IPsec

for EN-DC X2 traffic only, or for both EN-DC X2 traffic and LTE X2 traffic. Different IP

versions can be used for LTE X2 traffic and EN-DC X2 traffic.

The direct IPsec VPN connection is established after the X2-C or Xn-C connection is set

up between two neighbor nodes for which direct IPsec is enabled.

To establish a direct IPsec VPN connection for X2 and Xn, the outer and inner IP

addresses of the neighbor must be known. For LTE X2, the needed IP addresses are

exchanged between eNodeBs using the configuration transfer procedure in the S1AP

signaling through the MME. For EN-DC X2, the needed IP addresses are exchanged between

the eNodeB and the gNodeB using the EN-DC configuration transfer procedure in the EN-DC

X2AP signaling. For Xn, the needed IP addresses are exchanged between gNodeBs using the

Xn configuration transfer procedure in the XNAP signaling.

As the delay constraints concern X2-U and Xn-U traffic, the X2-U and Xn-U addresses in

each node are used as the inner IP address in the direct IPsec VPN connections. If

different IP addresses are used for X2-C and X2-U, the direct IPsec VPN connection is

established for X2-U traffic only, and the X2-C traffic is sent through the SEG. The

same applies to Xn traffic.

Different X2-U and Xn-U addresses can be configured for different PLMNs. Between two

shared nodes, direct IPsec VPN connection is established for the selected PLMN. X2 and

Xn traffic for the other PLMNs using different X2-U or Xn-U addresses is sent through

the SEG.

For the primary PLMN in the eNodeB, one IPv4 and one IPv6 inner address can be configured

for LTE X2. If both are configured, one is selected for each LTE X2 neighbor, IPv6 is

preferred. One of the inner addresses can be reused for EN-DC X2, or a separate inner IP

address can be configured for EN-DC X2.

To be able to establish direct IPsec VPN connections, there must be a configured IPsec

VPN connection to a SEG for S1, NG, X2, and Xn. The reasons are the following:

- S1 is needed to exchange neighbor addresses between the eNodeBs.
- X2-C is needed because the direct IPsec VPN connection is established after the X2-C connection is set up.
- Xn-C is needed as the direct IPsec VPN connection for Xn is established after the Xn-C connection is set up.
- X2-U and Xn-U are needed in case a direct IPsec VPN connection cannot be established with a neighbor node.

Direct IPsec VPN connections cannot be established in any of the following cases:

- The neighbor node is not an Ericsson node.
- Either node is behind a NAT device.
- For Xn, the neighbor gNodeB is not upgraded to the software version supporting direct IPsec.
- For LTE X2, if the configuration transfer procedure is not supported in the MME, or the MME is not configured properly.
- The eNodeB is configured with cell-defined primary PLMN ID. For more information, see Shared LTE RAN.
- Different Xn-U IP addresses are set for different slices.

If the direct IPsec VPN connection is established to a neighbor, a specific route leading

traffic through the direct IPsec VPN connection is created in the inner VR for the

neighbor X2-U or Xn-U address. This specific route has higher priority than the more

generic configured route to the SEG.

The maximum number of LTE X2

neighbors and the maximum number of Xn neighbors are both 512. The maximum number of

EN-DC X2 neighbors is 256.

The total number of direct IPsec VPN connections is 512 for a node. When

512 direct IPsec connections are established, X2 and Xn traffic to the remaining

neighbors is sent through the SEG.

If the total number of LTE X2, EN-DC X2, and Xn neighbors is expected to exceed 512 for a

node, the following actions are recommended:

- Do not enable direct IPsec for LTE X2 As a consequence, the risk of running out of direct IPsec VPN connections is less and the EN-DC X2 and Xn traffic can be sent with low latency.
- Do not enable direct IPsec for Xn if NR-DC is not active If direct IPsec is enabled for EN-DC X2 only, all EN-DC X2 traffic can be sent with low latency.

Direct IPsec in Mixed Mode Baseband Nodes with LTE and NR

The following X2 and Xn connections are possible in a mixed mode Baseband node with

LTE and NR:

- Internal EN-DC X2 between LTE and NR
- External EN-DC X2 between LTE in the node and NR in a mixed mode Baseband neighbor node or a neighbor gNodeB
- External EN-DC X2 between NR in the node and LTE in a mixed mode Baseband neighbor node or a neighbor eNodeB
- LTE X2 between LTE in the node and LTE in a mixed mode Baseband neighbor node or a neighbor eNodeB
- Xn between NR in the node and NR in a mixed mode Baseband neighbor node or neighbor gNodeB

Each X2 and Xn connection is established separately.

As a consequence, three separate X2 connections and one Xn connection are possible

between two mixed mode Baseband neighbor nodes. Two separate X2 connections are

possible between a mixed mode Baseband node and an eNodeB. One X2 and one Xn

connection are possible between a mixed mode Baseband node and a neighbor

gNodeB.

If the mixed mode Baseband node is deployed in an untrusted network, all traffic

leaving the node must be protected by IPsec. If direct IPsec is required to reduce

latency, each X2 and Xn connection must have a separate direct IPsec VPN connection

in some cases.

The pair of outer addresses must be unique for each IPsec VPN connection.

LTE and NR in a mixed mode Baseband node can share the inner VR or can use separate

inner VRs. In both cases, internal EN-DC X2 traffic can be routed internally, and

direct IPsec is not relevant for the internal EN-DC X2.

Table 9   Shared VR or Separate VRs for LTE and NR

| Shared VR between LTE and NR                                                                                                        | Separate VRs for LTE and NR                                                                                                                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Internal EN-DC X2 traffic is routed internally in the VR.                                                                           | Inter-VR route must be configured for the internal EN-DC X2                                         traffic.                                                                                                 |
| LTE and NR can share IPsec VPN connection to the security                                         gateway.                          | LTE and NR must have separate IPsec VPN connections to the                                         security gateway.                                                                                         |
| The X2 and Xn connections between two nodes can share a                                         single direct IPsec VPN connection. | Separate direct IPsec VPN connections are needed for each X2                                         and Xn connection.                                                                                      |
| One outer IP address is enough in the mixed mode Baseband                                         node.                             | If direct IPsec is used for X2, there must be at least two                                         outer IP addresses in the mixed mode Baseband node in most                                         cases. |

# 4 Network Impact of IPsec

Capacity and Performance

The IPsec feature makes possible to tunnel traffic over untrusted and third party

networks.

Interfaces

No impact is expected from this feature.

Other Network Elements

No impact is expected from this feature.

# 5 Parameters for IPsec

Table 10   Parameters

| Parameter                                   | Type       | Description          |
|---------------------------------------------|------------|----------------------|
| AdditionalCoreNetwork.ipsecEndcEpAddressRef | Introduced | See MOM description. |
| AdditionalCoreNetwork.ipsecEpAddressRef     | Introduced | See MOM description. |
| ENodeBFunction.ipsecEndcEpAddressRef        | Introduced | See MOM description. |
| ENodeBFunction.ipsecEpAddress2Ref           | Introduced | See MOM description. |
| ENodeBFunction.ipsecEpAddressRef            | Introduced | See MOM description. |
| Ikev2PolicyProfile.credential               | Introduced | See MOM description. |
| Ikev2PolicyProfile.dpdTime                  | Introduced | See MOM description. |
| Ikev2PolicyProfile.ikeDscp                  | Introduced | See MOM description. |
| Ikev2PolicyProfile.ikeSaLifetime            | Introduced | See MOM description. |
| Ikev2PolicyProfile.ikev2Proposal            | Introduced | See MOM description. |
| Ikev2PolicyProfile.trustCategory            | Introduced | See MOM description. |
| Ikev2PolicyProfile.ikev2Fragmentation       | Introduced | See MOM description. |
| IpsecProposalProfile.childSaLifetime        | Introduced | See MOM description. |
| IpsecProposalProfile.ipsecProposal          | Introduced | See MOM description. |
| IpsecProposalProfile.pfs                    | Introduced | See MOM description. |
| IpsecPolicy.antiReplayProtection            | Introduced | See MOM description. |
| IpsecPolicy.ipsecProposalProfile            | Introduced | See MOM description. |
| IpsecPolicy.localTrafficSelector            | Introduced | See MOM description. |
| IpsecPolicy.remoteTrafficSelector           | Introduced | See MOM description. |
| Ikev2Session.ikev2PolicyProfile             | Introduced | See MOM description. |
| Ikev2Session.localIdentityOrigin            | Introduced | See MOM description. |
| IpsecTunnel.localAddress                    | Introduced | See MOM description. |
| IpsecTunnel.remoteAddress                   | Introduced | See MOM description. |
| IpsecTunnel.remoteAddressSecondary          | Introduced | See MOM description. |
| LocalIPsecEndpoint.interfaceList            | Introduced | See MOM description. |
| LocalIPsecEndpoint.outerIpAddressRef        | Introduced | See MOM description. |
| PeerIpsecProfile.antiReplayProtection       | Introduced | See MOM description. |
| PeerIpsecProfile.ikev2PolicyProfile         | Introduced | See MOM description. |
| PeerIpsecProfile.ipsecProposalProfile       | Introduced | See MOM description. |
| InterfaceIPv4.trackedInterface              | Introduced | See MOM description. |
| InterfaceIPv6.trackedInterface              | Introduced | See MOM description. |
| Ikev2PolicyProfile.dpdInterval              | Introduced | See MOM description. |
| Ikev2PolicyProfile.randomDelay              | Introduced | See MOM description. |
| Ikev2PolicyProfile.retransmissionScheme     | Introduced | See MOM description. |

# 6 Performance of IPsec

KPIs

This feature has no associated Key Performance Indicators (KPIs).

Counters

- IpsecTunnel.espTunInInvalidSpi
- IpsecTunnel.ikeTunInInvalidSpi
- IpsecPolicy.espTunInIntegrityFail
- IpsecPolicy.espTunInReplayFail
- IpsecPolicy.espTunOutNoSA
- Ikev2Session.ikeTunChildSaRekey
- Ikev2Session.ikeTunInIntegrityFail
- Ikev2Session.ikeTunInInvalidMsg
- PeerIpsecTunnel.ikeFailures
- PeerIpsecTunnel.ipIfStatsInError
- PeerIpsecTunnel.ipIfStatsOutDiscards
- PeerIpsecTunnel.ipIfStatsOutFragCreates
- PeerIpsecTunnel.ipsecInError
- PeerIpsecTunnel.unavailableSeconds
- PeerIpsecTunnel.unavailableSecondsIPv4
- PeerIpsecTunnel.unavailableSecondsIPv6

Events

The following event is introduced to observe if XN Configuration Transfer message is

sent or received:

- CuCpXnConfigurationTransfer

# 7 Activate IPsec

Prerequisites

The license key is installed in the node.

Steps

1. Set the attribute featureState to ACTIVATED in the applicable MO instance, depending on node type: Node Type License Control MO Baseband Radio Node FeatureState=CXC4040004 For more information, see Manage Licenses and Hardware Activation Codes.

# 8 Deactivate IPsec

Prerequisites

Steps

1. Set the attribute featureState to DEACTIVATED in the applicable MO instance, depending on node type: Node Type License Control MO Baseband-based FeatureState=CXC4040004 For more information, see Manage Licenses and Hardware Activation Codes.

# 9 Engineering Guidelines for IPsec

There are three typical configurations for IPsec. For more information, see Manage IPsec

Configuration A

In Configuration A, one IPsec VPN connection is used for OAM, as well as user and

control planes. Inner and outer networks are separated into different VRs. Three IP

addresses in the outer networks are of interest to the configuration:

- A1 is the local outer address in the Baseband-based node.
- A2 is the address of the default router.
- A3 is the outer address of the security gateway.

A1 and A2 must be on the same network and thus use the same prefix length (denoted

P1).

The following are the two inner addresses of the configuration:

- B1 is the local inner address in the Baseband-based node.
- B2 is the address of the DNS server located in the inner network.

Figure 9   Configuration A

Configuration B

In Configuration B, one IPsec VPN connection is used for OAM and another for user and

control plane. The two inner networks (one for OAM, and one for user and control

plane) and the outer networks are separated into three different VRs. The following

IP addresses in the outer network are of interest to the configuration:

- A1 is the local outer address in the Baseband-based node.
- A2 is the address of the default router.
- A3 is the outer address of the security gateway used for the OAM traffic.
- A4 is the outer address of the security gateway used for the user/control plane traffic.

A1 and A2 must be on the same network and thus use the same prefix length (denoted

P1).

There are three inner addresses of interest to the configuration:

- B1 is the local inner OAM address in the Baseband-based node.
- B2 is the address of the DNS server located in the inner OAM network.
- B3 is the local inner user/control plane address in the Baseband-based node.

Figure 10   Configuration B

Configuration C

In Configuration C, one IPsec VPN connection is used for OAM and another IPsec VPN

connection is used for user and control plane. The two inner networks (one for OAM,

and one for user and control plane) and the outer network are separated into

different VRs. Furthermore, the outer network is separated into one outer network

for OAM and one for user/control plane with different VRs, so, in total, there are

four VRs.

The following IP addresses in the outer networks are of interest to the

configuration:

- A1 is the local OAM outer address in the Baseband-based node.
- A2 is the address of the default router for OAM traffic.
- A3 is the outer address of the security gateway used for the OAM traffic.
- A4 is the outer address of the security gateway used for the user/control plane traffic.
- A5 is the local user/control plane outer address in the Baseband-based node.
- A6 is the address of the default router for user/control plane traffic.

A1 and A2 must be on the same network and thus use the same prefix length (denoted

P1). A5 and A6 must be on the same network and thus use the same prefix length

(denoted P2).

The two outer networks are separated by VLAN in the node. The OAM outer network uses

VLAN ID = V1 and the user/control plane uses VLAN ID = V2.

There are three inner addresses of interest to the configuration:

- B1 is the local inner OAM address in the Baseband-based node.
- B2 is the address of the DNS server located in the inner OAM network.
- B3 is the local inner user/control plane address in the Baseband-based node.

Figure 11   Configuration C

# 10 Feature Change History

This section lists changes that affected this feature and the impact it had on the

network.

## 10.1 IPSec Certificate Revocation for Direct X2

| Access Type:       | LTE                 |
|--------------------|---------------------|
| Hardware Platform: | All                 |
| Licensing:         | IPsec, FAJ 121 0804 |

The IPsec peer certificate revocation check is now extended to apply also to neighbor

eNodeBs.

See Manage IPsec for more information.

Capacity and Performance

No impact.

Operation

No impact.

Interfaces

No impact.

Other Network Elements

No impact.

## 10.2 IPsec Configurable Policies

| Access Type:       | LTE, WCDMA, GSM, MI   |
|--------------------|-----------------------|
| Hardware Platform: | All Baseband products |
| Licensing:         | IPsec, FAJ 121 0804   |

The enhancement is about the possibility to configure multiple policies for an IPsec VPN

connection and to configure the localTrafficSelector. This allows for

separation of traffic to different destinations on different Child SA pairs within one

IKE SA, and using multiple inner addresses separated in different Child SA pairs or IKE

SAs.

For more information, see Manage IPsec.

Capacity and Performance

No impact.

Operation

localTrafficSelector on IpsecPolicy MO: this

attribute provides a possibility to specify the local inner address in the traffic

selector negotiation proposed by the node.

increase of IpsecPolicy MOs per

IpsecTunnelMO (from 1

to 5)

Interfaces

No impact.

Other Network Elements

No impact.

## 10.3 Automatic Direct X2 IPsec Tunnel Setup

| Access Type:       | LTE                 |
|--------------------|---------------------|
| Hardware Platform: | All                 |
| Licensing:         | IPsec, FAJ 121 0804 |

Direct X2 IPsec VPN connections support automatic setup of IPsec VPN connections directly

between X2 neighbor

eNodeBs.

The established VPN connections are used to carry the X2 UP traffic. If X2 AP uses the

same IP address, the AP traffic also traverses the VPN connection. The latency of the X2

UP traffic is reduced because it does not have to pass through a remotely placed SEG.

Depending on network latency, this can enable latency sensitive radio features like

inter-Enb carrier aggregation.

Both DU and Baseband support IPv6 on inner connections but only DU supports IPv6 on outer

connections for Direct X2. The restriction on 60 IPv6 VPN connections is only applicable

for DU.

Capacity and Performance

No impact.

Operation

New MOs:

- PeerIpsecProfile It enables node to automatically set up direct IPsec VPN connections to other RBS based on X2 neighbor information in node. New attributes on the PeerIpsecProfile: Table 11 Attributes for DU Property/type Attribute Name Description ChildSaTransform[0..10] allowedChildSaTransform Possible transforms that can be used for Child SAs. If allowedChildSaTransform is not set, the system generates a proposal based on all algorithms supported by the node. NULL encryption algorithm is not included in this case.Selected transform depends on IKE negotiations with peer node. The first transform in list has highest priority. IkeSaTransform[0..5] allowedIkeSaTransform Set of integrity and encryption algorithms that can be applied to IKE SA towards the peer. If allowedIkeSaTransform is not set, the system generates a proposal based on all algorithms supported by the node. The first transform in the list has the highest priority. boolean antiReplayProtection Enable or disable the anti-replay protection. long childSaLifeTime Lifetime of Child SA. long deadPeerDetectionInterval Time to detect IKE SA is down. If IKE SA is down, an attempt is made to re-establish IKE SA if node is initiator for connection. long ikeSaLifeTime Lifetime of IKE SA. StateVals logging Whether IPsec events are logged. string key mandatory noNotification restricted peerIpsecProfileId The value component of the RDN. boolean useInstalledTrustedCertificate If the node uses installed trusted IPsec certificates for authentication of IKE peer. If useInstalledTrustedCertificate is set to FALSE, node is using root CA certificate of nodes IPsec certificate as trusted (installed trusted certificates for IPsec are not used). string userLabel Label for free use. Table 12 Attributes for Baseband Property/type Attribute name Description boolean antiReplayProtection Enable or disable anti-replay protection. Ikev2PolicyProfile mandatory ikev2PolicyProfile Reference to ikev2PolicyProfile MO. Dependencies: Referenced ikev2PolicyProfile MO must be configured for certificate-based authentication with attributes credential and trustCategory set. IpsecProposalProfile mandatory ipsecProposalProfile Reference to IpsecProposalProfile MO. Dependencies: Referenced IpsecProposalProfile MO must be configured with data limit in childSaLifetime attribute set to nil. string key mandatory noNotification restricted peerIpsecProfileId The value component of the RDN.
- PeerIpsecTunnel It represents a direct IPsec VPN connection to an X2 neighbor. New attributes on the PeerIpsecTunnel: Table 13 Attributes for DU Property/Type Attribute Name Description ChildSa[0..] noNotification nonPersistent readOnly childSecurityAssociation List of Child SAs. If no Child SAs exists, the list is empty. IkeSa[0..2] noNotification nonPersistent readOnly ikeSecurityAssociation List of IKE SAs. If no IKE SAs exists, the list is empty. OperState noNotification nonPersistent readOnly operationalState The operational state. string key mandatory noNotification restricted peerIpsecTunnelId The value component of the RDN. This attribute is the equal to inner IP address of peer node. IP address can be IPv4 or IPv6 address. IPv4 address is in dotted decimal notation. Example: 192.168.0.1. IPv6 address is in compressed format without any leading zeros. Example:2001::1. string noNotification readOnly peerOuterAddress Outer IP address of peer node. IP address can be IPv4 or IPv6 address. IPv4 address is in dotted decimal notation. Example: 192.168.0.1. IPv6 address is in compressed format without any leading zeros Example:2001::1. string userLabel Label for free use. Table 14 Attributes for Baseband Property/type Attribute name Description OperState noNotification readOnly operationalState The operational state. Disabled if not possible to establish IKE SA or Child SA pair. string key mandatory noNotification restricted peerIpsecTunnelId The value component of the RDN. Inner IP address of peer node. string noNotification readOnly peerOuterAddress Outer IP address of peer node. IPv4 address in dotted decimal notation. Example: 192.168.0.1 New pmCounters on the PeerIpsecTunnel: Table 15 pmCounters for DU pmCounter Description pmChildSaRekey Number of completed Child SA re-keyings. Unit: 1 occurrence Condition: Incremented when Child SA re-keying is completed. Counter type: PEG Counter is reset after measurement period: Yes pmIkeFailures Number of times IKE SA went down and necessarily a new IKA SA was established. Unit: 1 occurrence Condition: Incremented when IKE SA has gone down and necessarily a new IKA SA was established. Counter type: PEG Counter is reset after measurement period: Yes pmInErrors Number of received IKE, IP and ESP messages discarded due to error. Possible errors are: IKE message received with invalid type, invalid length, or value that is out of range. Received IP or ESP packet with SPI that does not match existing SA. Incoming packet (after reassembly) discarded due to failed anti-replay check. Incoming packet (after reassembly) discarded due to failure in decryption. Incoming packet (after reassembly) discarded due to failure in integrity check. Incoming packet discarded due to mismatch of traffic selectors for Child SA through which they are received. Unit: 1 occurrence Condition: Incremented when IKE or ESP message is discarded due to error. Counter type: PEG Counter is reset after measurement period: Yes pmOutDiscards Number of discarded outgoing packets. Possible reasons are: the applicable SA is not established or the sequence number overflown. Unit: 1 occurrence Condition: Incremented when outgoing packet is discarded. Counter type: PEG pmUnavailableSeconds Number of seconds elapsed when no IKE SA is established. Unit: 1 second Condition: Incremented when a second elapses and no IKE SA is established. Counter type: PEG Counter is reset after measurement period: Yes Table 16 pmCounters for Baseband New pmCounter Description ipIfStatsInError Number of incoming packets successfully passed IPsec processing, but discarded because of errors detected at inner IP interface. ipIfStatsOutDiscards Number of IP datagrams without encountered problem to prevent transmission to destination, but discarded because of to, for example, lack of buffer space. Specification: RFC 4293, section 5. ipIfStatsOutFragCreates Number of datagram fragments generated as result of IP fragmentation. Specification: RFC 4293, section 5. ipsecInError Number of incoming packets discarded because of validation errors detected by IPsec processing. UnavailableSeconds Number of seconds when no IKE SA is established. Unavailable time does not include retransmission timers for IKE SA. IkeFailures Number of times IKE SA went down. Only transition from established to non-established is counted.

New attributes on the TermPointToENB:

Table 17

| Property/type                    | Attribute name   | Description                           |
|----------------------------------|------------------|---------------------------------------|
| string  readonly  noNotification | ipsecEPAddress   | The outer address of the X2 neighbor. |

New attributes on the ENodeBFunction

Table 18

| Property/type   | Attribute name    | Description                                                                                                                                                                     |
|-----------------|-------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ManagedObject   | ipsecEPAddressRef | The local outer address used for this node. Reference to an AddressIPv4 or an 										IpAccessHostEt 									MO.   Disturbances: Changing this attribute can affect traffic. |

Interfaces

This change affects the following interfaces:

- 3GPP defined interfaces There is impact on the S1 messages eNB Configuration Transfer and MME Configuration transfer defined in 3GPP TS 36.413. In the SON Configuration Transfer IE, there is an X2 TNL Configuration Info field where the eNB local outer IP address is added in one field.

Other Network Elements

No impact.

## 10.4 17.Q4: IPv6 on Outer Network

IPv6 on outer network enables the availability of both IPv4 and IPv6 for the inner

network and the outer network, in any combination.

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 0804 R7     |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 0417 R6     |
| Node Type:              | Baseband Radio Node |
| Access Type:            | LTE, GSM            |

IPv6 on outer network enhances IPsec in Baseband products to support IPv6 on the outer

network. This means that IPv4 and IPv6 are both available for the inner network and the

outer network, in any combination. The inner network and the outer network can have the

same protocol (IPv4 on both networks or IPv6 on both networks), or different protocols

(IPv6 on the inner network and IPv4 on the outer network, or IPv4 on the inner network

and IPv6 on the outer network).

For more information, see IPsec or Manage IPsec.

Capacity and Performance

No impact.

Operation

The following attributes have new valid references:

- MO AddressIPv6 is a valid reference for the localAddress attribute on MO IpsecTunnel
- MO PeerIPv6 is a valid reference for the remoteAddress attribute on MO IpsecTunnel

The address attribute on MO PeerIpv6 can

represent the fully qualified domain name of the peer.

Interfaces

No impact.

Hardware

No impact.

Other Network Elements

No impact.

## 10.5 17.Q4: IKE v2 Configuration Payload

This enhancement enables to automatically assign the inner IP address of the node and the assignment of peer addresses used for communication with DNS servers.

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 0804 R7     |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 0417 R6     |
| Node Type:              | Baseband Radio Node |
| Access Type:            | LTE                 |

IKE v2 Configuration Payload is an enhancement to the IPsec feature that introduces the

possibility of automatically assigning the inner IP address of the node. It also enables

the assignment of peer addresses used for communication with DNS servers. IKEv2

Configuration Payload can only be used if the node is managed by ENM.

For more information, see Manage IPsec.

Capacity and Performance

No impact.

Operation

If an AddressIpv4 or AddressIpv6 MO in an inner

Router MO has the attribute

configurationMode set to IKE, no other

AddressIpvX of the same IP version can be defined for this

Router MO.

This enhancement introduces a new alarm: IKE Configuration Payload

Fault. The alarm is raised when no valid internal IP address is

received or when no valid DNS IP address is received.

Interfaces

No impact.

Hardware

No impact.

Other Network Elements

To fully benefit from the change, ENM version 17.8 must be supported.

## 10.6 17.Q4: NAT Traversal

This enhancement makes it possible to connect a node located behind a NAT device with a security gateway located in public side of NAT.

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 0804 R7     |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 0417 R6     |
| Node Type:              | Baseband Radio Node |
| Access Type:            | LTE, WCDMA, GSM     |

NAT traversal is an enhancement of the IPsec feature. NAT traversal makes it possible to

connect a node located behind a NAT device with a security gateway located in public

side of NAT. NAT traversal is only supported if IPv4 is used in the outer network. No

direct X2 IPsec VPN connections are established if the node is behind a NAT device.

Capacity and Performance

No impact.

Operation

No impact.

Interfaces

No impact.

Hardware

No impact.

Other Network Elements

To fully benefit from the change, the node requires support from the following

network elements:

- Security Gateway Regardless if there is a NAT device or not, the security gateway must be able to handle a NAT detection request in IKE v2 negotiation according to RFC 7296. To place the node behind a NAT device, the security gateway must also support NAT traversal.

The required support is automatically implemented, no operator action is needed.

## 10.7 17.Q4: Enrollment of Two Credentials for IPsec

This feature introduces the two node credential enrollment for IPsec.

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 0804 R7     |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 0417 R6     |
| Node Type:              | Baseband Radio Node |
| Access Type:            | LTE                 |

This IPsec feature is enhanced with the possibility to enroll two node credentials. Different

node credentials can be used for different IPsec VPN connections.

Capacity and Performance

No impact.

Operation

The restriction that two different Ikev2PolicyProfile MOs cannot refer to

different NodeCredential MOs is removed.

Interfaces

No impact.

Hardware

Baseband Radio Node

Other Network Elements

No impact.

## 10.8 IKEv2 Configuration Payload for Iub

This enhancement supports automatic allocation of inner IP addresses for Iub and

O&amp;M interfaces with IPsec connections.

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 3586 R7     |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 0516 R7     |
| Node Type:              | Baseband Radio Node |
| Access Type:            | WCDMA               |

IKEv2 Configuration Payload for Iub is a feature enhancement that introduces flexibility

in node configuration and network planning. The IP addresses are automatically allocated

by the SEG using IKEv2 configuration payload. The DNS server addresses can also be

retrieved automatically using IKEv2 configuration payload with this enhancement.

For more information, see IPsec.

Capacity and Performance

No impact.

Operation

Table 19   New Values

| Value   | Attribute                     | Enhancement Activation                                                                                           |
|---------|-------------------------------|------------------------------------------------------------------------------------------------------------------|
| IKE     | AddressIpv4.configurationMode | For IPv4 addresses, set the attribute to IKE                                         on the Baseband Radio Node. |
| IKE     | AddressIpv6.configurationMode | For IPv6 addresses, set the attribute to IKE                                         on the Baseband Radio Node. |

Table 20   New Alarms

| Alarm                           | Description                                                                                                                                                                                             |
|---------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| IKE Configuration Payload Fault | This                                     alarm                                     is raised when no valid inner IP address or no valid DNS IP                                     address is received. |

For more information about alarm handling, see IKE Configuration Payload Fault.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

To fully benefit from the change, the node requires support from the following

network elements:

- SEG The SEG is configured and support IKEv2 Configuration Payload.
- ENM This enhancement can be used only if the node is managed by the ENM. The required ENM release is 18.11 or later.

## 10.9 18.Q1: Cipher Modernization for IPsec

Cipher Modernisation is an enhancement of the IPsec feature. It enables support for

new, strong cryptographical algorithms in IPsec.

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 0804 R8     |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 0417 R7     |
| Node Type:              | Baseband Radio Node |
| Access Type:            | LTE, WCDMA, GSM     |

Cipher Modernisation is an enhancement of the IPsec feature, for manually configured

IPsec VPN connections. It enables support for new, strong cryptographical algorithms in

IPsec. Support is added for the following algorithms:

- AES-GCM
- SHA2-384
- AES-GMAC

For more information, see Manage IPsec.

Capacity and Performance

No impact.

Operation

By default, the node sends supported algorithms in the IKE and Child SA negotiation.

The selection is done by the security gateway. However, it is possible to configure

the node manually to use specific algorithms. In this case, the algorithms used for

the IKE SA are controlled by MO Ikev2PolicyProfile, and the

algorithms used for the Child SA are controlled by MO

IpsecProposalProfile.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

To fully benefit from the change, the node requires support from the following

network elements:

- Security Gateway Using the new ciphers is only possible if the security gateway supports them.

## 10.10 18.Q3: Support for IPsec Active-Standby Redundancy

This feature enhancement enables security gateway redundancy with only one active

IPsec VPN connection. One security gateway can act as standby for multiple primary security

gateways.

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 0804 R10    |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 0417 R9     |
| Node Type:              | Baseband Radio Node |
| Access Type:            | LTE, WCDMA          |

Capacity and Performance

No impact.

Operation

The IPsec active-standby redundancy is activated by configuring the new optional

attribute, IpsecTunnel.remoteAddressSecondary.

Table 21   New MO Attribute

| Attribute                          | Description                                                                                                                                                    |
|------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| IpsecTunnel.remoteAddressSecondary | Refers to the PeerIPv4 or                                         PeerIPv6 MO representing the secondary                                     security gateway. |

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

No impact.

## 10.11 19.Q1: Increased Number of IPsec Tunnels in Virtual Router

The

existing limitation of the number of IPsec VPN connections in a virtual router is removed,

and other IPsec related limitations are expanded with this feature enhancement.

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 0804        |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 0417        |
| Node Type:              | Baseband Radio Node |
| Access Type:            | LTE, WCDMA, GSM     |

The total number of configured IPsec VPN connections is increased from 15 to 32 and the

specific limitation of IPsec VPN connections per virtual router is removed. This means

that up to 32 IPsec VPN connection can be configured within the same virtual router.

The total number of configured IPsec policies is increased from 32 to 64.

Capacity and Performance

No impact.

Operation

The limitation of 5 IpsecTunnel MOs within on

Router MO is removed.

The maximum number of IpsecTunnel MOs in the node is increased

from 15 to 32.

The maximum number of IpsecPolicy MOs in the node is increased

from 30 to 64.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

No impact.

## 10.12 19.Q4: Support for Direct IPsec VPN Connection for X2 to eNodeB

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 0804 11     |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 4002        |
| Node Type:              | Baseband Radio Node |
| Access Type:            | NR                  |

This enhancement to IPsec feature introduces support for direct IPsec VPN connection for

X2 between eNodeB and gNodeB in the NR NSA (EN-DC) case. Relation to gNodeB must be

manually configuration in eNodeB, but the relation to eNodeB can be automatically

created in gNodeB.

Capacity and Performance

Latency for X2-U can be kept at a minimum when IPsec is used.

Operation

The following change will apply:

- The local inner address for direct X2 IPsec VPN connections is configured by the GNBCUUPFunction.upX2IpAddressRefattribute. If GNBCUUPFunction.upX2IpAddressRef attribute is not set GNBCUUPFunction.upIpAddressRef attribute is used instead.
- The EN-DC X2-U address is configured by the GNBCUUPFunction.rpUpIpAddressRef attribute. If GNBCUUPFunction.rpUpIpAddressRef attribute is not set GNBCUUPFunction.intraRanIpAddressRef attribute is used instead. The attribute that configures the local inner address for direct X2 IPsec VPN connections has to refer to the same AddressIPv4 or AddressIPv6 MO as the attribute configuring the EN-DC X2-U address.
- New attributes GNBCUUPFunction.ipsecEpAddressRef and GNBCUUPFunction.ipsecEndcEpAddressRef are added. In case attribute GNBCUUPFunction.ipsecEndcEpAddressRef is set, it is used as local outer address for direct X2 IPsec VPN connections to eNodeBs. Otherwise attribute GNBCUUPFunction.ipsecEpAddressRef is used.
- New configurable attributes TermPointToENodeB.ipsecEpAddress and TermPointToENodeB.upIpAddress are added. The TermPointToENodeB.upIpAddress attribute is set in case the X2-U address should be different from X2-C.
- Establishment of direct X2 IPsec VPN connection with a specific eNodeB can be turned off by setting TermPointToENodeB.ipsecEpAddress to an invalid address.
- If automatic configuration of neighbor relation to eNodeB, the outer address of the eNodeB is not visible in peerOuterAddress in PeerIpsecTunnel MO, or in ipsecEpAddress on TermPointToENodeB. Only visible in COM CLI command show ikesa for PeerIpsecTunnel MO.
- Both IPv4 and IPv6 should be possible in all new attributes.
- One PeerIpsecProfile MO can be configured in each Router MO.
- New readable attributes PeerIpsecTunnel.localInnerAddress and PeerIpsecTunnel.localOuterAddress, are added.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

No impact.

## 10.13 20.Q1: Enhancement for Direct X2 IPsec VPN Connection to the gNodeB

| Access Type:            | LTE                 |
|-------------------------|---------------------|
| Feature Name:           | IPsec               |
| Feature Identity        | FAJ 121 0804        |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 0417        |
| Node Type:              | Baseband Radio Node |
| Licensing:              | Licensed feature.   |

This IPsec feature enhancement enables a separate IP address for the direct IPsec VPN

connection. The VPN connection is used by the X2 interface connecting the

eNodeB and the

gNodeB in EN-DC.

Different local outer addresses can be used for direct LTE X2 IPsec and for direct EN-DC

IPsec. This means that the enhancement allows for the deployment of the gNodeB on IPv6, even if the eNodeB uses

IPv4.

Additionally, it is possible to enable direct X2 IPsec for EN-DC X2 without enabling it

for LTE X2.

Capacity and Performance

No impact.

Operation

This enhancement introduces the following attribute:

- EnodeBFunction.ipsecEndcEpAddressRef

If the EnodeBFunction.ipsecEndcEpAddressRef attribute is set, it

is used as the local outer address for direct X2 IPsec VPN connections to the

gNodeB.

Otherwise, the EnodeBFunction.ipsecEpAddressRef attribute is used

as before.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

No impact.

## 10.14 20.Q1: Support for Mix of IPv4 and IPv6 Traffic in the Same IPsec VPN

The

feature enhancement supports the mix of IPv4 and IPv6 traffic in the same IPSec

VPN.

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 0804        |
| Value Package Name:     | IPsec               |
| Value Package Identity: | FAJ 801 0417        |
| Node Type:              | Baseband Radio Node |
| Access Type:            | LTE, NR, WCDMA, GSM |

This enhancement supports a mix of IPv4 and IPv6 traffic inner flows in the same outer

IPv4 or IPv6 IPsec VPN connection.

Benefits

The main benefit of this enhancement that it makes possible to use only one outer IP

address for IPsec VPN instead of multiple IPsec addresses and IPsec VPN

connections.

Capacity and Performance

No impact.

Operation

The following applies when mixing IPv4 and IPv6 within the same IPsec VPN

connection:

- One InterfaceIPv4 MO and one InterfaceIPv6 MO refer to the same IpsecTunnel MO.
- There must be at least one AddressIPv4 MO and one AddressIPv6 MO within the inner Router MO. Each inner address MO is either a child to an interface MO referring to the same IPsecTunnel MO, or a separate loopback interface MO. The loopback interface MO can be InterfaceIPv4 or InterfaceIPv6 with the loopback attribute set).
- Within the IPsecTunnel MO, there must be an IPsecPolicy MO for each inner address MO. The inner addresses must be configured in the IpsecPolicy.localTrafficSelector attribute for each IPsecPolicy MO class. If the IpsecPolicy.remoteTrafficSelector attribute is set, it must have the same IP version as the IpsecPolicy.localTrafficSelector attribute.
- IKEv2 configuration payload is not supported. Because of that, the configurationMode attribute of the inner address MOs must be set to MANUAL.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

This enhancement requires ENM version 20.1 or later to be

used.

## 10.15 20.Q2: IPsec DPD Message Optimization

This enhancement improves the IPsec DPD mechanism by sending DPD messages from the

baseband unit to the SEG if incoming ESP traffic stops in the IPsec VPN

connection.

| Feature Name:           | IPsec                                                   | IPsec               | IPsec               | IPsec                  |
|-------------------------|---------------------------------------------------------|---------------------|---------------------|------------------------|
| Feature Identity:       | FAJ 121 0804                                            | FAJ 121 0804        | FAJ 121 3586        | FAJ 121 0804           |
| Value Package Name:     | NR High-Band Base Package  NR Mid/Low-Band Base Package | IPsec               | IPsec               | Baseband IPsec GSM RAN |
| Value Package Identity: | FAJ 801 4002/5H  FAJ 801 4002/5LM                       | FAJ 801 0417        | FAJ 801 0516        | FAJ 801 0747           |
| Node Type:              | Baseband Radio Node                                     | Baseband Radio Node | Baseband Radio Node | Baseband Radio Node    |
| Access Type:            | NR                                                      | LTE                 | WCDMA               | GSM                    |

The enhancement limits the amount of DPD traffic between the baseband unit and the SEG.

The existence of incoming ESP traffic in the IPsec VPN connection proves that the IPsec

VPN connection is working.

Benefits

The enhancement offers the following benefits:

- Less processing load on the SEG
- Enabling the SEG to support more IPsec VPN connections

Capacity and Performance

The enhancement reduces processing load on the SEG by limiting the amount of DPD

traffic in the IPsec VPN connection.

Operation

No impact.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

No impact.

## 10.16 20.Q3: IKEv2 Fragmentation

This

feature enhancement enables the fragmentation of large IKEv2 messages by IKEv2 itself. Thus,

fragmentation of IKEv2 message at IP level is not needed and network issues caused by IP

fragments can be avoided.

| Feature Name:           | IPsec                                                   | IPsec               | IPsec               | IPsec                  |
|-------------------------|---------------------------------------------------------|---------------------|---------------------|------------------------|
| Feature Identity:       | FAJ 121 0804                                            | FAJ 121 0804        | FAJ 121 3586        | FAJ 121 0804           |
| Value Package Name:     | NR High-Band Base Package  NR Mid/Low-Band Base Package | IPsec               | IPsec               | Baseband IPsec GSM RAN |
| Value Package Identity: | FAJ 801 4002/5H  FAJ 801 4002/5LM                       | FAJ 801 0417        | FAJ 801 0516        | FAJ 801 0747           |
| Node Type:              | Baseband Radio Node                                     | Baseband Radio Node | Baseband Radio Node | Baseband Radio Node    |
| Access Type:            | NR                                                      | LTE                 | WCDMA               | GSM                    |

Benefits

The enhancement has the following benefits:

- IKEv2 messages can traverse network devices that do not allow IP fragments to pass through.
- With IKEv2 fragmentation, IKE messages are less likely to be subject for Denial-of-Service attacks than large IKEv2 messages that require IP fragmentation.

Capacity and Performance

No impact.

Operation

To configure the feature enhancement, the

Ikev2PolicyProfile.ikev2Fragmentation attribute is

introduced. The enhancement is disabled by default.

For more information on enabling IKEv2 fragmentation see Manage IPsec.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

ENM version 20.3 or later is required for the enhancement.

## 10.17 20.Q3: Increased Retransmission Period at Longer DPD Time

The

enhancement increases the number of IPsec Dead Peer Detection (DPD) retransmissions up to

five.

| Feature Name:           | IPsec                                                   | IPsec               | IPsec               | IPsec                  |
|-------------------------|---------------------------------------------------------|---------------------|---------------------|------------------------|
| Feature Identity:       | FAJ 121 0804                                            | FAJ 121 0804        | FAJ 121 3586        | FAJ 121 0804           |
| Value Package Name:     | NR High-Band Base Package  NR Mid/Low-Band Base Package | IPsec               | IPsec               | Baseband IPsec GSM RAN |
| Value Package Identity: | FAJ 801 4002/5H                                         | FAJ 801 0417        | FAJ 801 0516        | FAJ 801 0747           |
| Node Type:              | Baseband Radio Node                                     | Baseband Radio Node | Baseband Radio Node | Baseband Radio Node    |
| Access Type:            | NR                                                      | LTE                 | WCDMA               | GSM                    |

The number of possible IPsec DPD retransmissions is increased to fulfill more network

scenarios. Instead of a fixed value, the number of retransmission is flexible and

configurable. The number of retransmissions can be increased up to five, with increased

retransmission period.

For more information, see IPsec and Manage IPsec.

Benefits

The main benefit of this enhancement is that it improves the compatibility between

Ericsson Baseband Radio Nodes and SEG nodes from other vendors.

Capacity and Performance

No impact.

Operation

The configuration of the Ikev2PolicyProfile.dpdTime attribute

(which is a legacy attribute) defines the following:

- The number of retransmissions
- The retransmission period
- The interval of the dpdTime value and the retransmission period

For details about how the configuration defines the number of retransmissions, the

retransmission period and the interval, see Manage IPsec.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

No impact.

## 10.18 20.Q4: Automatic Direct X2 IPsec VPN Connection for EN-DC

This enhancement introduces automatic direct X2 IPsec VPN connection for EN-DC X2 by

exchanging the X2-U and outer IP addresses through the X2 interface.

| Feature Name:           | IPsec                      |
|-------------------------|----------------------------|
| Feature Identity:       | FAJ 121 0804               |
| Value Package Name:     | IPsec  NR Base Package     |
| Value Package Identity: | FAJ 801 0417  FAJ 801 4002 |
| Node Type:              | Baseband Radio Node        |
| Access Type:            | LTE, NR                    |

Benefits

This enhancement introduces automatic direct X2 IPsec VPN connection for EN-DC X2

between Ericsson nodes. This is done by exchanging the X2-U and outer IP addresses

through the X2 interface after a manual or automatic EN-DC X2 connection is set up.

This means that no manual configuration of the outer IP address (IPsec endpoint) of

the gNodeB is needed in the eNodeB. Different IP addresses for X2-U and X2-C can

also be handled without any manual configuration of the neighbor X2-U address.

With this enhancement, the change of IP addresses in the eNodeB for IPsec VPN

connections for EN-DC X2 is also propagated to the gNodeB. The existing direct X2

IPsec VPN connection is taken down and a new one is established with the new IP

address.

Capacity and Performance

No impact.

Operation

It is not needed to manually configure the

TermPointToGNB.ipsecEpAddress or

TermPointToGNB.upIpAddress attribute on the eNodeB, or the

TermPointToENodeB.ipsecEpAddress or

TermPointToENodeB.upIpAddress attribute on the gNodeB. Any

configuration of these attributes by the operator is ignored. These attributes are

updated based on information received from the neighbor node. The

TermPointToGNB.upIpAddress and

TermPointToENodeB.upIpAddress attributes are only updated if

the X2-U address is different from the X2-C address.

Any change of the X2-U address or outer IP address in the eNodeB is propagated to the

gNodeB through X2-AP. The following changes can be made:

- The IP address on the AddressIpv4 or AddressIpv6 MO that is used as the X2-U address for EN-DC X2 can be changed.
- The IP address on the AddressIpv4 or AddressIpv6 MO that is used as the IPsec endpoint for EN-DC X2 can be changed.
- The ENodeBFunction.ipsecEpAddressRef attribute can be changed. The change is propagated to the gNodeB if this reference is used for EN-DC X2.

This enhancement introduces the following PM event:

- INTERNAL\_PROC\_ENDC\_X2\_TGNB\_CONF\_LOOKUP This PM event is used for observing whether the EN-DC X2 Configuration Transfer procedure is successfully performed.

Interfaces

This change affects the following interface:

- X2AP Extended transport layer addresses are introduced on the eNodeB in order to exchange IPsec information between the Master Node (eNodeB) and the Secondary Node (gNodeB). A function list is added with the new automatic direct IPsec function.

Hardware

No specific hardware requirements.

Other Network Elements

ENM version 20.4 or later is required for this feature

enhancement.

## 10.19 21.Q1: Single Direct IPsec between Basebands

| Feature Name:           | IPsec               | IPsec               |
|-------------------------|---------------------|---------------------|
| Feature Identity:       | FAJ 121 0804        | FAJ 121 0804        |
| Value Package Name:     | IPsec               | NR Base Package     |
| Value Package Identity: | FAJ 801 0417        | FAJ 801 4002        |
| Node Type:              | Baseband Radio Node | Baseband Radio Node |
| Access Type:            | LTE                 | NR                  |

With this enhancement, the possible three X2 connections between two mixed mode Baseband

nodes with LTE and NR can share a single direct IPsec VPN connection. The possible two

X2 connections between a mixed mode Baseband node and an eNodeB can also share a single

direct IPsec VPN connection.

Benefits

This feature enhancement has the following benefits:

- Allows easier deployment of a mixed mode Baseband node in an untrusted network.
- Allows the use of direct IPsec with one local outer address in the mixed mode Baseband node if LTE and NR share inner Virtual Router and use the same IP version.
- Allows neighboring LTE nodes to use one X2 address. Even if direct IPsec is used, no separate EN-DC X2 address is needed.
- Allows the enabling of direct IPsec for both LTE X2 and EN-DC X2 without any additional need for inner or outer addresses if LTE and NR share inner Virtual Router in a mixed mode Baseband node.

Capacity and Performance

No impact.

Operation

The X2 connections can share a direct IPsec VPN connection when all the following

conditions are fulfilled:

- The inner Virtual Router is shared by LTE and NR.
- The same IP version is used for the X2 addresses.
- The same outer IP address, IPsec endpoint, is used in each node.
- The nodes are upgraded to support this enhancement.

If any of these preconditions are not met, each X2 connection requires a separate

direct IPsec VPN connection. In this case, different outer IP addresses must be used

by LTE and NR in the mixed mode Baseband node.

The localInnerAddresses and peerInnerAddresses

attributes are added to the PeerIpsecTunnel MO to observe all X2

addresses sharing the same direct IPsec VPN connection.

Interfaces

This change affects the following interfaces:

- X2-AP for both LTE X2 and EN-DC X2 The single direct IPsec feature is added to the Ericsson private feature list in the X2-AP setup messages.

Hardware

No special hardware requirements.

Other Network Elements

- This enhancement requires the support of both neighboring X2 nodes.
- This enhancement requires ENM version 21.01 or later to observe the introduced attribute in the PeerIpsecTunnel MO.

## 10.20 21.Q4: Interface State Tracking and PBR in the Inner Router

This enhancement introduces interface state tracking for a loopback interface and PBR

in the inner router.

| Feature Name:           | IPsec               | IPsec               |
|-------------------------|---------------------|---------------------|
| Feature Identity:       | FAJ 121 0804        | FAJ 121 0804        |
| Value Package Name:     | NR Base Package     | IPsec               |
| Value Package Identity: | FAJ 801 4002        | FAJ 801 0417        |
| Node Type:              | Baseband Radio Node | Baseband Radio Node |
| Access Type:            | NR                  | LTE                 |

Summary and Benefits

Interface state tracking allows a loopback interface in the inner router to inherit

the operational state of an IPsec tunnel interface. Then, the loopback interface

operation state can reflect the state of the IPsec VPN connection.

PBR in the inner router with a next hop reference to an IPsec tunnel interface allows

two local inner IP addresses in the inner router to be tied to separate IPsec VPN

connections. Traffic to the same destination can be routed through different IPsec

VPN connections based on the source addresses.

Both PBR in the inner router and interface state tracking are necessary to support

the Multiple IP Addresses for Security Gateway Resilience feature.

Capacity and Performance

No impact.

Operation

The enhancement introduces the InterfaceIPv4.trackedInterface and

the InterfaceIPv6.trackedInterface attributes.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

It is recommended to use ENM version 21.4 or later to support the

MOM changes introduced by this feature enhancement. If the Release Independence

Manager application is used, the MOM changes are supported on earlier ENM versions

also.

## 10.21 22.Q2: Single Direct IPsec Between Basebands for IPv4 and IPv6

This enhancement enables the possible three X2 connections between two Mixed Mode

Baseband Radio Nodes with LTE and NR to share a single direct IPsec VPN

connection

| Feature Name:           | Single Direct IPsec Between Basebands for IPv4 and IPv6   | Single Direct IPsec Between Basebands for IPv4 and IPv6   |
|-------------------------|-----------------------------------------------------------|-----------------------------------------------------------|
| Feature Identity:       | FAJ 121 0804                                              | FAJ 121 0804                                              |
| Value Package Name:     | IPsec                                                     | IPsec                                                     |
| Value Package Identity: | FAJ 801 0417                                              | FAJ 801 0417                                              |
| Node Type:              | Baseband Radio Node                                       | Baseband Radio Node                                       |
| Access Type:            | NR                                                        | LTE                                                       |

Summary and Benefits

This enhancement enables the possible three X2 connections between two Mixed Mode

Baseband Radio Nodes with LTE and NR to share a single direct IPsec VPN connection,

even if LTE and NR use different IP versions. The possible two X2 connections

between a Mixed Mode Baseband Radio Node with LTE and NR and an eNodeB can also

share a single direct IPsec VPN connection.

This enhancement has the following benefits:

- Allows easier deployment of a Mixed Mode Baseband Radio Node in and untrusted network when LTE and NR use different IP versions.
- Allows the use of direct IPsec with one local outer address in the Mixed Mode Baseband Radio Node if LTE and NR share inner Virtual Router. LTE and NR can use different IP versions.
- Allows the enabling of direct IPsec for both LTE X2 and EN-DC X2, when LTE X2 and EN-DC X2 use different IP versions, without any need for additional outer addresses.

Capacity and Performance

No impact.

Operation

The X2 connections can share a direct IPsec VPN connection when the following

preconditions are met:

- LTE and NR share an inner VR.
- The same outer IP address and IPsec endpoint is used in each node.
- Both nodes are upgraded to support this enhancement.

If any of these preconditions are not met, each X2 connection require a separate

direct IPsec VPN connection. In this case, different outer IP addresses must be used

by LTE and NR in theMixed Mode Baseband Radio Node.

The attributes PeerIpsecTunnel.localInnerAddresses and

PeerIpsecTunnel.peerInnerAddresses can include both IPv4 and

IPv6 address.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

To fully benefit from the change, the node requires support from the following

network elements:

- This enhancement requires the support of both X2 neighbor nodes.
- It is recommended to use ENM version 21.1 or later to support the MOM changes introduced by this feature enhancement. If the Release Independence Manager application is used, the MOM changes are supported on earlier ENM versions also.

## 10.22 22.Q4: Support for Direct IPSec VPN Connection for Xn to gNodeB

This feature enhancement introduces support for the direct IPsec VPN connection for

Xn interface in the NR SA deployment.

| Feature Name:           | IPsec               |
|-------------------------|---------------------|
| Feature Identity:       | FAJ 121 0804        |
| Value Package Name:     | NR Base Package     |
| Value Package Identity: | FAJ 801 4002        |
| Node Type:              | Baseband Radio Node |
| Access Type:            | NR                  |
| Impact at Upgrade:      | Optional            |

Summary and Benefits

When the gNodeB is in SA or NSA + SA mode, the direct IPsec VPN connection for Xn

interface can be established after establishing the Xn-C link. This improves the

end-user performance compared with broadcasting in the network to a Security

Gateway.

Capacity and Performance

Direct IPsec VPN connection latency over Xn interface can be lower comparing to

connection over Security Gateway.

Operation

To establish direct IPsec VPN connections for Xn, the local outer address must be

configured in each gNodeB. The

LocalIPsecEndpoint.outerIpAddressRef attribute is configured

as local outer address for the direct IPsec VPN connections for Xn. It is configured

under the same EndPointResource MO where the

LocalIpEndpoint.addressRef attribute is configured as local

inner address. Both addresses must be set to the XN value in the

LocalIPsecEndpoint.interfaceList attribute and

LocalIpEndpoint.interfaceList attribute.

The EndPointResource MO containing preceding configured addresses

can be referred by the

ResourcePartitionMember.endPointResourceRef attribute or

GNBCuupFunction.endPointResourceRef attribute.

Interfaces

This feature enhancement affects the following interfaces:

| Interface   | Message                   | Description                                                                                                                                                                                                                 |
|-------------|---------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| XNAP        | Xn Configuration Transfer | This message is introduced to send IP addresses defined                                     for Xn interface and selected PLMN for Direct IPsec VPN                                     connection over Xn between gNodeBs. |
| XNAP        | Xn Setup Request          | New IE EabNgRanFeatureList is added to these                                     messages to inform the support for Xn Direct IPsec                                     Connection.                                         |
| XNAP        | Xn Setup Response         | New IE EabNgRanFeatureList is added to these                                     messages to inform the support for Xn Direct IPsec                                     Connection.                                         |

Hardware

No special hardware requirements.

Other Network Elements

ENM version 22.11 or later is required for this feature

enhancement.

Related Information

IPsec

## 10.23 24.Q1.0: Increased Number of System Limits and License Removal for Virtual Routers

The feature enhancement increases the limits related to IPsec, TWAMP, and BFD, as

well as removes the license for Virtual Routers.

| Feature Name           | IPsec                      | Two-Way Active Measurement Protocol Responder   | Bidirectional Forwarding Detection   | Virtual Routers                   |
|------------------------|----------------------------|-------------------------------------------------|--------------------------------------|-----------------------------------|
| Feature Identity       | FAJ 121 0804               | FAJ 121 1791                                    | FAJ 121 4255                         | FAJ 121 4257                      |
| Value Package Name     | NR Base Package  IPsec     | NR Base Package  TN Performance Monitoring      | NR Base Package  LTE Base Package    | NR Base Package  LTE Base Package |
| Value Package Identity | FAJ 801 4002  FAJ 801 0417 | FAJ 801 4002  FAJ 801 0441                      | FAJ 801 4002  FAJ 801 0400           | FAJ 801 4002  FAJ 801 0400        |
| Node Type              | Baseband Radio Node        | Baseband Radio Node                             | Baseband Radio Node                  | Baseband Radio Node               |
| Access Type            | NR  LTE                    | NR  LTE                                         | NR  LTE                              | NR  LTE                           |
| Impact at upgrade      | Optional                   | Optional                                        | Optional                             | Optional                          |

Summary and Benefits

This feature enhancement increases the limits related to IPsec, TWAMP, and BFD. The

following are the new limits:

- IPsec Tunnels: 60
- IPsec Policies: 120
- IPsec Proposal Profiles: 60
- IKEv2 Policy Profiles: 60
- TWAMP Responders: 60
- BFD Sessions IPv4: 120
- BFD Sessions IPv6: 120
- BFD Profiles: 120

The feature also removes the license for the Virtual Routers feature.

The benefits of the enhancement are the following:

- The extended router configuration supports implementation of network designs based on traffic separation principle.
- The increase of system limits makes configuration more flexible.

Capacity and Performance

No impact.

Operation

No impact.

Interfaces

No impact.

Hardware

The enhancement is supported on the Baseband units in RAN Compute group 4 and

higher.

Other Network Elements

It is recommended to use ENM version 24.1 or later to support the MOM changes

introduced by this feature enhancement. If the Release Independence Manager

application is used, the MOM changes are supported on earlier ENM versions also.

Related Information

IPsec

Two-Way Active Measurement Protocol Responder

Bidirectional Forwarding Detection

Virtual Routers

## 10.24 24.Q2.0: TN IPsec Support for New Algorithms

This feature enhancement introduces

the

CHACHA20\_POLY1305,

HMAC\_SHA2\_512\_256, and HMAC\_SHA2\_512 algorithms and a dynamic update for

inner link MTU.

| Feature Name           | IPsec               | IPsec               |
|------------------------|---------------------|---------------------|
| Feature Identity       | FAJ 121 0804        | FAJ 121 0804        |
| Value Package Name     | NR Base Package     | IPsec               |
| Value Package Identity | FAJ 801 4002        | FAJ 801 0417        |
| Node Type              | Baseband Radio Node | Baseband Radio Node |
| Access Type            | NR                  | LTE                 |
| Impact at Upgrade      | Mandatory           | Mandatory           |

Summary and Benefits

This feature enhancement adds the following

new

algorithms:

- CHACHA20\_POLY1305: Authenticated encryption
- HMAC\_SHA2\_512\_256: Integrity
- HMAC\_SHA2\_512: Pseudo Random Function

The

inner link MTU is dynamically adjusted in runtime according to the maximum ESP

overhead for the selected algorithms, rather than according a fixed maximum ESP overhead.

Capacity and Performance

The new algorithm

HMAC\_SHA2\_512\_256

adds more overhead due to ICV at the cost of security.

The dynamic adjustment of the inner MTU provides more room for data in the inner IP

packet and therefore more throughput.

Operation

The new algorithms are included in the default IKE and IPsec proposals, but top

priority algorithms remain.

The new algorithms can also be explicitly configured using

Ikev2PolicyProfile and

IpsecProposalProfile MOs.

Interfaces

No impact.

Hardware

The

dynamic adjustment of the MTU apply on all RAN compute groups. The new algorithms

are supported on RAN compute group 4 and onwards.

Other Network Elements

No specific network

requirements.

Related Information

IPsec

## 10.25 25.Q1.0: Short DPD Timer Setting

This feature enhancement introduces more flexible Dead Peer Detection (DPD)

settings.

| Feature Name           | IPsec               | IPsec               | IPsec               | IPsec                  |
|------------------------|---------------------|---------------------|---------------------|------------------------|
| Feature Identity       | FAJ 121 0804        | FAJ 121 0804        | FAJ 121 3586        | FAJ 121 3586           |
| Value Package Name     | NR Base Package     | IPsec               | IPsec               | Baseband IPsec GSM RAN |
| Value Package Identity | FAJ 801 4002        | FAJ 801 0417        | FAJ 801 0516        | FAJ 801 0747           |
| Node Type              | Baseband Radio Node | Baseband Radio Node | Baseband Radio Node | Baseband Radio Node    |
| Access Type            | NR                  | LTE                 | WCDMA               | GSM                    |
| Impact at Upgrade      | Optional            | Optional            | Optional            | Optional               |

Summary and Benefits

This feature enhancement has the following benefits:

- The shortest possible time to bring down the IPsec VPN connection based on DPD is shortened from 30 seconds to five seconds.
- An alternative option to configure DPD time by configuring the retransmission scheme and the DPD interval is introduced.
- The restriction of using the same DPD settings for different IPsec VPN connections under the same outer Router is removed. Also, the direct IPsec VPN connections can have separate settings.

Capacity and Performance

No impact.

Operation

The following changes are introduced to the Ikev2PolicyProfile

MO:

- The minimum value of Ikev2PolicyProfile.dpdTime is shortened from 30 seconds to five seconds.
- A new attribute Ikev2PolicyProfile.randomDelay is introduced to allow a delay before the new IKE negotiation after DPD. This can reduce load on Security Gateway at recovery if there is a short DPD time.
- Two new attributes Ikev2PolicyProfile.retransmissionScheme and Ikev2PolicyProfile.dpdInterval are introduced. These two attributes can be used to configure DPD time instead of using Ikev2PolicyProfile.dpdTime. Ikev2PolicyProfile.retransmissionScheme have three members: tries, timeout, and base.

Different Ikev2PolicyProfile MOs with different DPD settings are

allowed without restriction.

Interfaces

No impact.

Hardware

The feature is supported on RAN compute group 4 or higher.

Other Network Elements

It is recommended to use ENM version

25.1 or later to support the attributes introduced by this

feature enhancement. If the Release Independence Manager application is used, the

MOM changes are supported on earlier ENM versions.

Related Information

IPsec