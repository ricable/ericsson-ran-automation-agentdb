---
complexity_score: 15.5
converted_at: '2025-08-13T06:59:16.529283Z'
file_type: html
format: html
image_processing_enhanced: true
images_extracted: 2
images_saved: 3
original_path: 151_22104-LZA7016014_1Uen.BC.html
pictures_extracted: 2
processing_method: docling_multimodal
quality_score: 9.0
source_file: 151_22104-LZA7016014_1Uen.BC.html
source_zip: en_lzn7931071_r38f.zip
tables_extracted: 17
zip_image_types:
- .svg
- .png
- .gif
- .jpg
- .bmp
zip_images_total: 2796
---

# 

Egress IP Traffic Shaping

Baseband Radio Node

Contents

![Image](../images/151_22104-LZA7016014_1Uen.BC/additional_3_CP.png)

![Image](../images/151_22104-LZA7016014_1Uen.BC/additional_3_CP.png)

- Overview
- Dependencies
- Feature Operation
    - Shaper
    - Scheduler
    - Queues
    - Hierarchies
    - PCP to Queue Maps
    - DSCP to PCP Maps
    - Ingress Remarking
- Parameters
- Network Impact
- Performance
- Activate
- Deactivate
- Appendix: Feature Change History
    - Appendix: 20.Q2: Egress IP Traffic Shaping Updates and Enhancements

# 1 Egress IP Traffic Shaping Overview

This optional feature protects the RAN from overloading its transmission network

according to an SLA.

| Feature Name           | Egress IP Traffic Shaping                                                  | Egress IP Traffic Shaping                                                  | Egress IP Traffic Shaping                                                  | Egress IP Traffic Shaping                                                  |
|------------------------|----------------------------------------------------------------------------|----------------------------------------------------------------------------|----------------------------------------------------------------------------|----------------------------------------------------------------------------|
| Feature Identity       | FAJ 121 1823                                                               | FAJ 121 1823                                                               | FAJ 121 2117                                                               | FAJ 121 1823                                                               |
| Value Package Name     | NR Base Package                                                            | LTE Base Package                                                           | WCDMA Base Package                                                         | GSM RAN Base Package                                                       |
| Value Package Identity | FAJ 801 4002                                                               | FAJ 801 0400                                                               | FAJ 801 0359                                                               | FAJ 801 0386                                                               |
| Node Type              | Baseband Radio Node                                                        | Baseband Radio Node                                                        | Baseband Radio Node                                                        | Baseband Radio Node                                                        |
| Access Type            | NR                                                                         | LTE                                                                        | WCDMA                                                                      | GSM                                                                        |
| Licensing              | License-controlled feature. One license is required for each 								node. | License-controlled feature. One license is required for each 								node. | License-controlled feature. One license is required for each 								node. | License-controlled feature. One license is required for each 								node. |

Summary

The Egress IP Traffic Shaping feature is necessary in networks where resources in the

transmission network are limited. It enables controlling packet drops in networks

with low bandwidth, while still allowing for a high-quality RAN.

The Ingress Remarking function can be used to change QoS marking for incoming frames

and packets. If the incoming traffic does not follow the network QoS policy, this

function can be used to mitigate such scenarios.

Additional Information

For more information about this feature and related topics, see Manage Quality of Service.

# 2 Dependencies of Egress IP Traffic Shaping

An attribute of this feature is dependent on an attribute of the Basic Admission

Control feature.

Table 1   Feature Dependencies

| Feature                                                                | Relationship   | Description                                                                                                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------------------|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Basic Admission Control (FAJ 121                                 1857) | Related        | The Shaper.committedInformationRate attribute used                                 by the Egress IP Traffic Shaping feature and the                                     AdmissionControl.ulTransNwBandwidth attribute                                 used by the Basic Admission Control feature must indicate the same                                 transport network bandwidth. |

Hardware

No specific hardware requirements.

Limitations

No known limitations.

Network Requirements

No specific network requirements.

# 3 Feature Operation of Egress IP Traffic Shaping

This feature enables scheduling and queuing configuration.

Configurable scheduling is used to give priority between QoS classes. For example,

strict-priority scheduling can be used to give traffic with hard latency requirements high

priority. Also, DWRR scheduling can be used to share bandwidth between QoS classes.

Configurable queues are used to even out bursts to a selected level if latency is too high and

dropping packets is preferred.

The Egress IP Traffic Shaping feature consists of the following mandatory parts:

- Shaper
- Scheduler
- Queue hierarchy
- PCP to queue mapping

The feature can include the following parts as well:

- DSCP to PCP mapping
- PCP to PCP ingress remarking
- DSCP to DSCP ingress remarking

Ingress remarking of PCP is only valid for a bridged case. It is configurable for each

Ethernet and VLAN interface. DSCP to DSCP remarking can be used for both routed and switched

traffic. It is configurable through Ethernet, VLAN, and IP interface.

For more information, see Manage Quality of Service.

## 3.1 Shaper

Shaper behavior defines the egress bandwidth as defined in MEF 10.2 (27 October 2009).

The CIR is the Bandwidth Profile parameter. It defines the average rate of Service Frames in

bps up to which the network delivers Service Frames and meets the performance objectives.

These objectives are defined by the CoS attribute. This is the average flow described in bps.

CoS is defined by the PCP for Ethernet frames.

The CBS is a bandwidth profile parameter. It limits the maximum number of bytes available for

a burst of service frames sent at the UNI. The limit determines the number of bytes that can

be used for bursts in a time period. The burst of Service Frames is sent at the UNI speed to

remain conformant to CIR.

## 3.2 Scheduler

A scheduler manages its child nodes, which are either queues or schedulers. The scheduler

selects the child nodes to serve at the next transmission. When a node has a backlog of

packets, it has the next transmission opportunity.

A scheduler always tries to use all available bandwidth. If a queue is empty, other queues

that are not empty share the unused bandwidth.

There are two major scheduler types, the SP scheduler and the DWRR

scheduler.

In case of an SP scheduler, its child node n always has priority

over child node n+1.

The DWRR scheduler follows a deficit round robin schedule, where each child queue has its own

weight. It is possible that none of the child queues are empty. In such cases, the

scheduler assures the servicing of queues at the rate specified by their weights.

## 3.3 Queues

A queue is a buffer used by the system to temporarily store packets that are to be forwarded.

A queue is characterized by the following entities:

- Size of the queue.
- An enqueuing behavior, which defines how data is inserted in the queue.
- A dequeuing behavior, which defines how data is extracted from the queue.

The traffic selector selects the Ethernet frames to enqueue. Traffic can be selected by the

tuple {PCP, egress port (VLAN or Ethernet)}.

The enqueuing behavior is defined by the queue type, which is either Tail Drop or RED.

A Tail Drop queue drops frames when it is full. A RED queue begins to drop frames with a

probability &lt;P&gt; value, when it reaches the &lt;min&gt; threshold.

When a RED queue is full it reaches its &lt;max&gt; threshold. It means that

&lt;P=100%&gt;. In such cases, the RED queue drops all frames.

The dequeuing behavior is defined by the hierarchy of the following elements:

- Shaper
- Scheduler
- Queue

The dequeuing behavior occurs as a program that is executed every time a frame is to be

forwarded.

By default, there are eight queues for each Ethernet interface in the system. The queues are

denoted as Q1 to Q8. All queues are of the QueueTailDrop MO. The default

queue system is not visible in the MOM configuration.

When new Baseband units are introduced, the size of each queue in the default queue system

depends on the port capacity of the Baseband units and queue levels. For older Baseband units,

each queue has a default size of 1 MB. Table 2

shows the relationship between queue sizes and the port capacity for new Baseband units.

Table 2   Queue Size in the Default System

|   Port Capacity  (Gbps) |   Queue Level 1  (MB) |   Queue Level 2-5  (MB) | Queue Level 6-8  (MB)   | Total  (MB)   |
|-------------------------|-----------------------|-------------------------|-------------------------|---------------|
|                       1 |                   0.5 |                       1 | 1                       | 7.5           |
|                      10 |                   0.5 |                       1 | 1.5  5.5(1)             | 9  21(1)      |
|                      25 |                   0.5 |                       1 | 3.5  5.5(1)             | 15  21(1)     |
|                      50 |                   0.5 |                       1 | 7                       | 22.5          |
|                     100 |                   0.5 |                       1 | 14                      | 43.5          |

(1)

Only for RAN Compute Group 6.

The memory budget for egress queue system accounts for all queue systems, which include

default queue systems and custom-created queue system, within the Baseband. Table 3 shows the total memory budgets for the Baseband

units.

Table 3   Memory Budgets for Egress Queue System

| RAN Compute Group   |   Maximum Link Speed  (Gbps) |   Total Memory Budget  (MB) |
|---------------------|------------------------------|-----------------------------|
| RAN Compute Group 4 |                           10 |                          36 |
| RAN Compute Group 5 |                           25 |                          60 |
| RAN Compute Group 6 |                          100 |                         180 |

Configuration of large queues can cause latency issues, which are difficult to detect.

Therefore, custom egress queue systems must be created with caution. For a new Baseband unit,

besides the queue size, a lower link capacity can increase latency.

The following counters provide feedback on whether the queue size setting is adequate:

- QueueRed.filledLowerThreshold
- QueueTailDrop.filledLowerThreshold
- QueueRed.filledUpperThreshold
- QueueTailDrop.filledUpperThreshold

QoS features represented by the following MOs under QueueSystem MO are not

available for hardware-switched flows egressing through applicable VlanPort

MO, EthernetPort MO, or both:

- QueueRed
- QueueTailDrop
- QoSClassifier
- SchedulerDwrr
- SchedulerSp
- Shaper

## 3.4 Hierarchies

A hierarchy of five levels is supported. The hierarchy may contain the following nodes:

- A Shaper with an SP Scheduler, a DWRR Scheduler or a Queue as child.
- A DWRR Scheduler with an SP Scheduler, a DWRR Scheduler, a Shaper and/or Queues as children.
- An SP Scheduler with an SP Scheduler, a DWRR Scheduler, a Shaper and/or Queues as children. (An SP Scheduler can have up to four children.)
- A Queue.

A Scheduler or a Shaper cannot have more than two Scheduler ancestors in the hierarchy.

## 3.5 PCP to Queue Maps

PCP to Queue Maps are used to specify the queue in which an Ethernet frame is to be

temporarily stored. The mapping can be configured by the operator. In the default queue

system, the PCP number describes priority. PCP 7 is the highest value. Priority descends from

PCP 7 downwards. The only deviation from this rule is that PCP 1 has a lower priority than PCP

0.

VLAN can have their own PCP to Queue Maps, which result in the following functionalities:

- More than eight queues for each EthernetPort.
- Traffic with the same PCP can be prioritized differently, if they are on different VLANs.
- Queues can be shared between PCP to Queue Maps.
- Separate PCP to Queue Maps can be used. This means that each PCP to queue map has its own queue.

It is possible that the VlanPort.egressQosQueueMap attribute on a VLAN is

not set. In such cases, the PCP to Queue Map for the underlying Ethernet interface is

used.

An Ethernet interface can have more than one PCP to Queue Maps. In this case, the

EthernetPort.egressQosQueueMap attribute is to be set on the Ethernet

interface to determine which map to use. If only one map is available, the Ethernet interface

uses that.

## 3.6 DSCP to PCP Maps

The DSCP can be mapped to the PCP in the two following ways:

- By DSCP to PCP Maps with IP interfaces (IPv4 and IPv6) not under license control
- By Ethernet-port DSCP to PCP Maps, under license control

DSCP to PCP Maps associated with the IP interfaces mark each Ethernet frame with a PCP value.

This PCP value corresponds to the DSCP value. The functionality does not require

licensing.

DSCP to PCP Maps can be associated with both the IP interface and the Ethernet port. In such

cases, the map associated with the Ethernet Port overrides the map associated with the IP

Interface.

It is possible that the DSCP to PCP Map is not defined for an IP interface. In this case, the

IP interface uses the default DSCP to PCP Map.

Table 4   The DSCP to PCP Map of the Default Queue System

| DSCP           |   PCP | Queue Level   |
|----------------|-------|---------------|
| 51, 54         |     7 | Q1            |
| 32, 40, 48     |     6 | Q2            |
| 34, 36, 38, 46 |     5 | Q3            |
| 8, 16, 26, 28  |     4 | Q4            |
| 18, 20, 22     |     3 | Q5            |
| 10, 12, 14     |     2 | Q6            |
| none           |     1 | Q8            |
| 0, other       |     0 | Q7            |

## 3.7 Ingress Remarking

Ingress remarking makes it possible to handle incoming traffic that does not follow the

Network QoS Policy. Such incoming traffic can be the following, for example:

- Traffic coming from another QoS domain
- Traffic coming from nodes with poor QoS configuration possibilities

Ingress remarking can be configured to remark the following fields:

- Ingress PCP to PCP remarking (for bridging)
- Ingress DSCP to DSCP remarking (for routing and bridging)

# 4 Parameters of Egress IP Traffic Shaping

This feature introduces parameters to map PCP values to a queue and to control

hierarchical schedulers.

Table 5   Parameters

| Parameter                                                               | Type       | Description          |
|-------------------------------------------------------------------------|------------|----------------------|
| DscpDscpMap.defaultDscp                                                 | Introduced | See MOM description. |
| DscpDscpMap.dscp0 to                                 DscpDscpMap.dscp63 | Introduced | See MOM description. |
| DscpSetToPCP.dscpSet                                                    | Introduced | See MOM description. |
| DscpSetToPCP.pcp                                                        | Introduced | See MOM description. |
| DscpToPCPMap.defaultPCP                                                 | Introduced | See MOM description. |
| PcpPcpMap.defaultPcp                                                    | Introduced | See MOM description. |
| PcpPcpMap.pcp0                                                          | Introduced | See MOM description. |
| PcpPcpMap.pcp1                                                          | Introduced | See MOM description. |
| PcpPcpMap.pcp2                                                          | Introduced | See MOM description. |
| PcpPcpMap.pcp3                                                          | Introduced | See MOM description. |
| PcpPcpMap.pcp4                                                          | Introduced | See MOM description. |
| PcpPcpMap.pcp5                                                          | Introduced | See MOM description. |
| PcpPcpMap.pcp6                                                          | Introduced | See MOM description. |
| PcpPcpMap.pcp7                                                          | Introduced | See MOM description. |
| PcpSetToQueue.pcpSet                                                    | Introduced | See MOM description. |
| PcpSetToQueue.queue                                                     | Introduced | See MOM description. |
| PcpToQueueMap.defaultQueue                                              | Introduced | See MOM description. |
| QueueRed.exponentWeight                                                 | Introduced | See MOM description. |
| QueueRed.maxThreshold                                                   | Introduced | See MOM description. |
| QueueRed.minThreshold                                                   | Introduced | See MOM description. |
| QueueRed.order                                                          | Introduced | See MOM description. |
| QueueRed.queueSize                                                      | Introduced | See MOM description. |
| QueueTailDrop.order                                                     | Introduced | See MOM description. |
| QueueTailDrop.queueSize                                                 | Introduced | See MOM description. |
| SchedulerDwrr.order                                                     | Introduced | See MOM description. |
| SchedulerDwrr.schedulingWeight                                          | Introduced | See MOM description. |
| SchedulerSp.order                                                       | Introduced | See MOM description. |
| Shaper.committedBurstSize                                               | Introduced | See MOM description. |
| Shaper.committedInformationRate                                         | Introduced | See MOM description. |
| Shaper.order                                                            | Introduced | See MOM description. |

# 5 Network Impact of Egress IP Traffic Shaping

This feature is used to control network resources and make the network more robust.

However, if this feature is configured incorrectly, it can have a negative impact on the

network.

Capacity and Performance

The Egress IP Traffic Shaping feature indirectly affects all functions that

communicate over Ethernet. This feature controls which Ethernet frames are dropped

because of resource constraints, and which ones are forwarded. When introducing the

feature in a network, the network must be monitored, and it must be reconfigured if

other functions start to perform inadequately.

Interfaces

No impact.

Other Network Elements

No impact.

# 6 Performance of Egress IP Traffic Shaping

The feature is associated with performance management entities measuring queue

utilization and queue drop rate.

KPIs

Table 6   Key Performance Indicators

| KPI                                      | Description                                                                                                                                                                                                      |
|------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Queue Utilization on Physical interfaces | This performance indicator monitors the queue bandwidth ratio to                                     physical link interface.                                                                                    |
| Queue Utilization on Shaped Interfaces   | This performance indicator monitors the queue bandwidth ratio to                                     SLA, that is the configured shaping value per uplink.                                                       |
| Queue Utilization on Queue Reservation   | This performance indicator monitors the queue bandwidth to                                     reserved queue bandwidth ratio of a DWRR scheduler of an egress                                     Queue System. |
| Queue Drop rate/queue                    | This performance indicator monitors the drop ratio caused by                                     traffic shaping for a specific queue.                                                                           |

For more information, see Transport Network Performance

Indicators.

Counters

There are counters associated with this feature. More information can be found in

Managed Object Model (MOM).

Events

This feature has no associated events.

# 7 Activate Egress IP Traffic Shaping

To use the feature, it must be activated following the usual feature activation

procedure.

Prerequisites

- The license key is installed in the node.
- CCTR is active for at least one week before this procedure to collect enough troubleshooting data.

Steps

1. Set the FeatureState.featureState attribute to ACTIVATED in the FeatureState=CXC4040005 MO instance.

After This Task

Keep CCTR active for at least one week after this procedure for continued collection of troubleshooting data.

# 8 Deactivate Egress IP Traffic Shaping

If the feature is no longer needed, it can be deactivated following the usual

feature deactivation procedure. It must also be deactivated before the activation of any

conflicting feature.

Prerequisites

CCTR is active for at least one week before this procedure to collect enough troubleshooting data.

Steps

1. Set the FeatureState.featureState attribute to DEACTIVATED in the FeatureState=CXC4040005 MO instance.

After This Task

Keep CCTR active for at least one week after this procedure for continued collection of troubleshooting data.

# Appendix A: Feature Change History

This section lists changes that affected this feature and the impact it had on the

network.

## Appendix A.a: 20.Q2: Egress IP Traffic Shaping Updates and Enhancements

The

updates and enhancements provide egress IP traffic shaping for Baseband units with a port

capacity of 25 gigabits per second (Gbps) and for legacy Baseband units.

| Feature Name:           | Egress IP Traffic Shaping                                                 |
|-------------------------|---------------------------------------------------------------------------|
| Feature Identity:       | FAJ 121 1823                                                              |
| Value Package Name:     | LTE Base Package  NR Low/Mid-Band Base Package  NR High-Band Base Package |
| Value Package Identity: | FAJ 801 0400  FAJ 801 4002/5LM  FAJ 801 4002/5H                           |
| Node Type:              | Baseband Radio Node                                                       |
| Access Type:            | LTE, NR                                                                   |

The egress IP traffic shaping update introduces the following enhancements:

- The maximum supported rate for the Shaper MO is increased to 25 Gbps
- If the configured value for CIR in the Shaper MO is between 1 byte to 1 MB, the value is still realized internally as 1 MB
- The maximum number of child MOs for the SchedulerDwrr MO is limited to eight Note: The child MO limitation also applies for legacy Baseband versions.

Benefits

The benefit of the egress IP traffic shaping optimization is that it provides

Transport Network egress QoS functionality for Baseband units with a port capacity

of 25 Gbps.

Capacity and Performance

No impact.

Operation

The SchedulerDwrr.schedulingWeight attribute can accept values

from 1 up to 1000. For precise scheduling

behavior, it is recommended to use weight values up to a maximum of

200. This recommendation is only applicable for Baseband units

with a port capacity of 25 Gbps.

The shaper allows bursting a maximum of 64,000 bytes even if the

Shaper.committedBurstSize attribute is set to more than

64,000 bytes.

Interfaces

No impact.

Hardware

No special hardware requirements.

Other Network Elements

No impact.